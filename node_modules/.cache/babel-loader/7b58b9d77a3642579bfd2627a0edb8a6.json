{"ast":null,"code":"import { getDocument } from 'ssr-window';\nimport $ from '../../shared/dom7';\nimport { bindMethods } from '../../shared/utils';\nimport { getSupport } from '../../shared/get-support';\nvar Sortable = {\n  init: function init() {\n    var app = this;\n    var document = getDocument();\n    var isTouched;\n    var isMoved;\n    var touchStartY;\n    var touchesDiff;\n    var $sortingEl;\n    var $sortingItems;\n    var $sortableContainer;\n    var sortingElHeight;\n    var minTop;\n    var maxTop;\n    var $insertAfterEl;\n    var $insertBeforeEl;\n    var indexFrom;\n    var $pageEl;\n    var $pageContentEl;\n    var pageHeight;\n    var pageOffset;\n    var sortingElOffsetLocal;\n    var sortingElOffsetTop;\n    var initialScrollTop;\n    var wasTapHold;\n\n    function handleTouchStart(e, isTapHold) {\n      isMoved = false;\n      isTouched = true;\n      wasTapHold = false;\n      touchStartY = e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY;\n      $sortingEl = $(e.target).closest('li').eq(0);\n      indexFrom = $sortingEl.index();\n      $sortableContainer = $sortingEl.parents('.sortable');\n      var $listGroup = $sortingEl.parents('.list-group');\n\n      if ($listGroup.length && $listGroup.parents($sortableContainer).length) {\n        $sortableContainer = $listGroup;\n      }\n\n      $sortingItems = $sortableContainer.children('ul').children('li:not(.disallow-sorting):not(.no-sorting)');\n      if (app.panel) app.panel.allowOpen = false;\n      if (app.swipeout) app.swipeout.allow = false;\n\n      if (isTapHold) {\n        $sortingEl.addClass('sorting');\n        $sortableContainer.addClass('sortable-sorting');\n        wasTapHold = true;\n      }\n    }\n\n    function handleTouchMove(e) {\n      if (!isTouched || !$sortingEl) return;\n      var pageY = e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY;\n\n      if (!isMoved) {\n        $pageEl = $sortingEl.parents('.page');\n        $pageContentEl = $sortingEl.parents('.page-content');\n        var paddingTop = parseInt($pageContentEl.css('padding-top'), 10);\n        var paddingBottom = parseInt($pageContentEl.css('padding-bottom'), 10);\n        initialScrollTop = $pageContentEl[0].scrollTop;\n        pageOffset = $pageEl.offset().top + paddingTop;\n        pageHeight = $pageEl.height() - paddingTop - paddingBottom;\n        $sortingEl.addClass('sorting');\n        $sortableContainer.addClass('sortable-sorting');\n        sortingElOffsetLocal = $sortingEl[0].offsetTop;\n        minTop = $sortingEl[0].offsetTop;\n        maxTop = $sortingEl.parent().height() - sortingElOffsetLocal - $sortingEl.height();\n        sortingElHeight = $sortingEl[0].offsetHeight;\n        sortingElOffsetTop = $sortingEl.offset().top;\n      }\n\n      isMoved = true;\n      e.preventDefault();\n      e.f7PreventSwipePanel = true;\n      touchesDiff = pageY - touchStartY;\n      var translateScrollOffset = $pageContentEl[0].scrollTop - initialScrollTop;\n      var translate = Math.min(Math.max(touchesDiff + translateScrollOffset, -minTop), maxTop);\n      $sortingEl.transform(\"translate3d(0,\" + translate + \"px,0)\");\n      var scrollAddition = 44;\n      var allowScroll = true;\n\n      if (touchesDiff + translateScrollOffset + scrollAddition < -minTop) {\n        allowScroll = false;\n      }\n\n      if (touchesDiff + translateScrollOffset - scrollAddition > maxTop) {\n        allowScroll = false;\n      }\n\n      $insertBeforeEl = undefined;\n      $insertAfterEl = undefined;\n      var scrollDiff;\n\n      if (allowScroll) {\n        if (sortingElOffsetTop + touchesDiff + sortingElHeight + scrollAddition > pageOffset + pageHeight) {\n          // To Bottom\n          scrollDiff = sortingElOffsetTop + touchesDiff + sortingElHeight + scrollAddition - (pageOffset + pageHeight);\n        }\n\n        if (sortingElOffsetTop + touchesDiff < pageOffset + scrollAddition) {\n          // To Top\n          scrollDiff = sortingElOffsetTop + touchesDiff - pageOffset - scrollAddition;\n        }\n\n        if (scrollDiff) {\n          $pageContentEl[0].scrollTop += scrollDiff;\n        }\n      }\n\n      $sortingItems.each(function (el) {\n        var $currentEl = $(el);\n        if ($currentEl[0] === $sortingEl[0]) return;\n        var currentElOffset = $currentEl[0].offsetTop;\n        var currentElHeight = $currentEl.height();\n        var sortingElOffset = sortingElOffsetLocal + translate;\n\n        if (sortingElOffset >= currentElOffset - currentElHeight / 2 && $sortingEl.index() < $currentEl.index()) {\n          $currentEl.transform(\"translate3d(0, \" + -sortingElHeight + \"px,0)\");\n          $insertAfterEl = $currentEl;\n          $insertBeforeEl = undefined;\n        } else if (sortingElOffset <= currentElOffset + currentElHeight / 2 && $sortingEl.index() > $currentEl.index()) {\n          $currentEl.transform(\"translate3d(0, \" + sortingElHeight + \"px,0)\");\n          $insertAfterEl = undefined;\n          if (!$insertBeforeEl) $insertBeforeEl = $currentEl;\n        } else {\n          $currentEl.transform('translate3d(0, 0%,0)');\n        }\n      });\n    }\n\n    function handleTouchEnd() {\n      if (!isTouched || !isMoved) {\n        if (isTouched && !isMoved) {\n          if (app.panel) app.panel.allowOpen = true;\n          if (app.swipeout) app.swipeout.allow = true;\n\n          if (wasTapHold) {\n            $sortingEl.removeClass('sorting');\n            $sortableContainer.removeClass('sortable-sorting');\n          }\n        }\n\n        isTouched = false;\n        isMoved = false;\n        return;\n      }\n\n      if (app.panel) app.panel.allowOpen = true;\n      if (app.swipeout) app.swipeout.allow = true;\n      $sortingItems.transform('');\n      $sortingEl.removeClass('sorting');\n      $sortableContainer.removeClass('sortable-sorting');\n      var indexTo;\n      if ($insertAfterEl) indexTo = $insertAfterEl.index();else if ($insertBeforeEl) indexTo = $insertBeforeEl.index();\n      var moveElements = $sortableContainer.dataset().sortableMoveElements;\n\n      if (typeof moveElements === 'undefined') {\n        moveElements = app.params.sortable.moveElements;\n      }\n\n      if (moveElements) {\n        if ($insertAfterEl) {\n          $sortingEl.insertAfter($insertAfterEl);\n        }\n\n        if ($insertBeforeEl) {\n          $sortingEl.insertBefore($insertBeforeEl);\n        }\n      }\n\n      if (($insertAfterEl || $insertBeforeEl) && $sortableContainer.hasClass('virtual-list')) {\n        indexFrom = $sortingEl[0].f7VirtualListIndex;\n        if (typeof indexFrom === 'undefined') indexFrom = $sortingEl.attr('data-virtual-list-index');\n\n        if ($insertBeforeEl) {\n          indexTo = $insertBeforeEl[0].f7VirtualListIndex;\n          if (typeof indexTo === 'undefined') indexTo = $insertBeforeEl.attr('data-virtual-list-index');\n        } else {\n          indexTo = $insertAfterEl[0].f7VirtualListIndex;\n          if (typeof indexTo === 'undefined') indexTo = $insertAfterEl.attr('data-virtual-list-index');\n        }\n\n        if (indexTo !== null) indexTo = parseInt(indexTo, 10);else indexTo = undefined;\n        var virtualList = $sortableContainer[0].f7VirtualList;\n        if (indexFrom) indexFrom = parseInt(indexFrom, 10);\n        if (indexTo) indexTo = parseInt(indexTo, 10);\n        if (virtualList) virtualList.moveItem(indexFrom, indexTo);\n      }\n\n      if (typeof indexTo !== 'undefined' && !Number.isNaN(indexTo) && indexTo !== indexFrom) {\n        $sortingEl.trigger('sortable:sort', {\n          from: indexFrom,\n          to: indexTo\n        });\n        app.emit('sortableSort', $sortingEl[0], {\n          from: indexFrom,\n          to: indexTo,\n          el: $sortingEl[0]\n        }, $sortableContainer[0]);\n      }\n\n      $insertBeforeEl = undefined;\n      $insertAfterEl = undefined;\n      isTouched = false;\n      isMoved = false;\n    }\n\n    var activeListener = getSupport().passiveListener ? {\n      passive: false,\n      capture: false\n    } : false;\n    $(document).on(app.touchEvents.start, '.list.sortable .sortable-handler', handleTouchStart, activeListener);\n    app.on('touchmove:active', handleTouchMove);\n    app.on('touchend:passive', handleTouchEnd);\n    $(document).on('taphold', '.sortable-tap-hold', function (e, pointerEvent) {\n      handleTouchStart(pointerEvent, true);\n    });\n  },\n  enable: function enable(el) {\n    if (el === void 0) {\n      el = '.list.sortable';\n    }\n\n    var app = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n    $el.addClass('sortable-enabled');\n    $el.trigger('sortable:enable');\n    app.emit('sortableEnable', $el[0]);\n  },\n  disable: function disable(el) {\n    if (el === void 0) {\n      el = '.list.sortable';\n    }\n\n    var app = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n    $el.removeClass('sortable-enabled');\n    $el.trigger('sortable:disable');\n    app.emit('sortableDisable', $el[0]);\n  },\n  toggle: function toggle(el) {\n    if (el === void 0) {\n      el = '.list.sortable';\n    }\n\n    var app = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n\n    if ($el.hasClass('sortable-enabled')) {\n      app.sortable.disable($el);\n    } else {\n      app.sortable.enable($el);\n    }\n  }\n};\nexport default {\n  name: 'sortable',\n  params: {\n    sortable: {\n      moveElements: true\n    }\n  },\n  create: function create() {\n    var app = this;\n    bindMethods(app, {\n      sortable: Sortable\n    });\n  },\n  on: {\n    init: function init() {\n      var app = this;\n      if (!app.params.sortable) return;\n      app.sortable.init();\n    }\n  },\n  clicks: {\n    '.sortable-enable': function enable($clickedEl, data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      var app = this;\n      app.sortable.enable(data.sortable);\n    },\n    '.sortable-disable': function disable($clickedEl, data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      var app = this;\n      app.sortable.disable(data.sortable);\n    },\n    '.sortable-toggle': function toggle($clickedEl, data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      var app = this;\n      app.sortable.toggle(data.sortable);\n    }\n  }\n};","map":{"version":3,"sources":["E:/Programming/React/rashi-app/node_modules/framework7/esm/components/sortable/sortable.js"],"names":["getDocument","$","bindMethods","getSupport","Sortable","init","app","document","isTouched","isMoved","touchStartY","touchesDiff","$sortingEl","$sortingItems","$sortableContainer","sortingElHeight","minTop","maxTop","$insertAfterEl","$insertBeforeEl","indexFrom","$pageEl","$pageContentEl","pageHeight","pageOffset","sortingElOffsetLocal","sortingElOffsetTop","initialScrollTop","wasTapHold","handleTouchStart","e","isTapHold","type","targetTouches","pageY","target","closest","eq","index","parents","$listGroup","length","children","panel","allowOpen","swipeout","allow","addClass","handleTouchMove","paddingTop","parseInt","css","paddingBottom","scrollTop","offset","top","height","offsetTop","parent","offsetHeight","preventDefault","f7PreventSwipePanel","translateScrollOffset","translate","Math","min","max","transform","scrollAddition","allowScroll","undefined","scrollDiff","each","el","$currentEl","currentElOffset","currentElHeight","sortingElOffset","handleTouchEnd","removeClass","indexTo","moveElements","dataset","sortableMoveElements","params","sortable","insertAfter","insertBefore","hasClass","f7VirtualListIndex","attr","virtualList","f7VirtualList","moveItem","Number","isNaN","trigger","from","to","emit","activeListener","passiveListener","passive","capture","on","touchEvents","start","pointerEvent","enable","$el","disable","toggle","name","create","clicks","$clickedEl","data"],"mappings":"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","sourcesContent":["import { getDocument } from 'ssr-window';\nimport $ from '../../shared/dom7';\nimport { bindMethods } from '../../shared/utils';\nimport { getSupport } from '../../shared/get-support';\nvar Sortable = {\n  init: function init() {\n    var app = this;\n    var document = getDocument();\n    var isTouched;\n    var isMoved;\n    var touchStartY;\n    var touchesDiff;\n    var $sortingEl;\n    var $sortingItems;\n    var $sortableContainer;\n    var sortingElHeight;\n    var minTop;\n    var maxTop;\n    var $insertAfterEl;\n    var $insertBeforeEl;\n    var indexFrom;\n    var $pageEl;\n    var $pageContentEl;\n    var pageHeight;\n    var pageOffset;\n    var sortingElOffsetLocal;\n    var sortingElOffsetTop;\n    var initialScrollTop;\n    var wasTapHold;\n\n    function handleTouchStart(e, isTapHold) {\n      isMoved = false;\n      isTouched = true;\n      wasTapHold = false;\n      touchStartY = e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY;\n      $sortingEl = $(e.target).closest('li').eq(0);\n      indexFrom = $sortingEl.index();\n      $sortableContainer = $sortingEl.parents('.sortable');\n      var $listGroup = $sortingEl.parents('.list-group');\n\n      if ($listGroup.length && $listGroup.parents($sortableContainer).length) {\n        $sortableContainer = $listGroup;\n      }\n\n      $sortingItems = $sortableContainer.children('ul').children('li:not(.disallow-sorting):not(.no-sorting)');\n      if (app.panel) app.panel.allowOpen = false;\n      if (app.swipeout) app.swipeout.allow = false;\n\n      if (isTapHold) {\n        $sortingEl.addClass('sorting');\n        $sortableContainer.addClass('sortable-sorting');\n        wasTapHold = true;\n      }\n    }\n\n    function handleTouchMove(e) {\n      if (!isTouched || !$sortingEl) return;\n      var pageY = e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY;\n\n      if (!isMoved) {\n        $pageEl = $sortingEl.parents('.page');\n        $pageContentEl = $sortingEl.parents('.page-content');\n        var paddingTop = parseInt($pageContentEl.css('padding-top'), 10);\n        var paddingBottom = parseInt($pageContentEl.css('padding-bottom'), 10);\n        initialScrollTop = $pageContentEl[0].scrollTop;\n        pageOffset = $pageEl.offset().top + paddingTop;\n        pageHeight = $pageEl.height() - paddingTop - paddingBottom;\n        $sortingEl.addClass('sorting');\n        $sortableContainer.addClass('sortable-sorting');\n        sortingElOffsetLocal = $sortingEl[0].offsetTop;\n        minTop = $sortingEl[0].offsetTop;\n        maxTop = $sortingEl.parent().height() - sortingElOffsetLocal - $sortingEl.height();\n        sortingElHeight = $sortingEl[0].offsetHeight;\n        sortingElOffsetTop = $sortingEl.offset().top;\n      }\n\n      isMoved = true;\n      e.preventDefault();\n      e.f7PreventSwipePanel = true;\n      touchesDiff = pageY - touchStartY;\n      var translateScrollOffset = $pageContentEl[0].scrollTop - initialScrollTop;\n      var translate = Math.min(Math.max(touchesDiff + translateScrollOffset, -minTop), maxTop);\n      $sortingEl.transform(\"translate3d(0,\" + translate + \"px,0)\");\n      var scrollAddition = 44;\n      var allowScroll = true;\n\n      if (touchesDiff + translateScrollOffset + scrollAddition < -minTop) {\n        allowScroll = false;\n      }\n\n      if (touchesDiff + translateScrollOffset - scrollAddition > maxTop) {\n        allowScroll = false;\n      }\n\n      $insertBeforeEl = undefined;\n      $insertAfterEl = undefined;\n      var scrollDiff;\n\n      if (allowScroll) {\n        if (sortingElOffsetTop + touchesDiff + sortingElHeight + scrollAddition > pageOffset + pageHeight) {\n          // To Bottom\n          scrollDiff = sortingElOffsetTop + touchesDiff + sortingElHeight + scrollAddition - (pageOffset + pageHeight);\n        }\n\n        if (sortingElOffsetTop + touchesDiff < pageOffset + scrollAddition) {\n          // To Top\n          scrollDiff = sortingElOffsetTop + touchesDiff - pageOffset - scrollAddition;\n        }\n\n        if (scrollDiff) {\n          $pageContentEl[0].scrollTop += scrollDiff;\n        }\n      }\n\n      $sortingItems.each(function (el) {\n        var $currentEl = $(el);\n        if ($currentEl[0] === $sortingEl[0]) return;\n        var currentElOffset = $currentEl[0].offsetTop;\n        var currentElHeight = $currentEl.height();\n        var sortingElOffset = sortingElOffsetLocal + translate;\n\n        if (sortingElOffset >= currentElOffset - currentElHeight / 2 && $sortingEl.index() < $currentEl.index()) {\n          $currentEl.transform(\"translate3d(0, \" + -sortingElHeight + \"px,0)\");\n          $insertAfterEl = $currentEl;\n          $insertBeforeEl = undefined;\n        } else if (sortingElOffset <= currentElOffset + currentElHeight / 2 && $sortingEl.index() > $currentEl.index()) {\n          $currentEl.transform(\"translate3d(0, \" + sortingElHeight + \"px,0)\");\n          $insertAfterEl = undefined;\n          if (!$insertBeforeEl) $insertBeforeEl = $currentEl;\n        } else {\n          $currentEl.transform('translate3d(0, 0%,0)');\n        }\n      });\n    }\n\n    function handleTouchEnd() {\n      if (!isTouched || !isMoved) {\n        if (isTouched && !isMoved) {\n          if (app.panel) app.panel.allowOpen = true;\n          if (app.swipeout) app.swipeout.allow = true;\n\n          if (wasTapHold) {\n            $sortingEl.removeClass('sorting');\n            $sortableContainer.removeClass('sortable-sorting');\n          }\n        }\n\n        isTouched = false;\n        isMoved = false;\n        return;\n      }\n\n      if (app.panel) app.panel.allowOpen = true;\n      if (app.swipeout) app.swipeout.allow = true;\n      $sortingItems.transform('');\n      $sortingEl.removeClass('sorting');\n      $sortableContainer.removeClass('sortable-sorting');\n      var indexTo;\n      if ($insertAfterEl) indexTo = $insertAfterEl.index();else if ($insertBeforeEl) indexTo = $insertBeforeEl.index();\n      var moveElements = $sortableContainer.dataset().sortableMoveElements;\n\n      if (typeof moveElements === 'undefined') {\n        moveElements = app.params.sortable.moveElements;\n      }\n\n      if (moveElements) {\n        if ($insertAfterEl) {\n          $sortingEl.insertAfter($insertAfterEl);\n        }\n\n        if ($insertBeforeEl) {\n          $sortingEl.insertBefore($insertBeforeEl);\n        }\n      }\n\n      if (($insertAfterEl || $insertBeforeEl) && $sortableContainer.hasClass('virtual-list')) {\n        indexFrom = $sortingEl[0].f7VirtualListIndex;\n        if (typeof indexFrom === 'undefined') indexFrom = $sortingEl.attr('data-virtual-list-index');\n\n        if ($insertBeforeEl) {\n          indexTo = $insertBeforeEl[0].f7VirtualListIndex;\n          if (typeof indexTo === 'undefined') indexTo = $insertBeforeEl.attr('data-virtual-list-index');\n        } else {\n          indexTo = $insertAfterEl[0].f7VirtualListIndex;\n          if (typeof indexTo === 'undefined') indexTo = $insertAfterEl.attr('data-virtual-list-index');\n        }\n\n        if (indexTo !== null) indexTo = parseInt(indexTo, 10);else indexTo = undefined;\n        var virtualList = $sortableContainer[0].f7VirtualList;\n        if (indexFrom) indexFrom = parseInt(indexFrom, 10);\n        if (indexTo) indexTo = parseInt(indexTo, 10);\n        if (virtualList) virtualList.moveItem(indexFrom, indexTo);\n      }\n\n      if (typeof indexTo !== 'undefined' && !Number.isNaN(indexTo) && indexTo !== indexFrom) {\n        $sortingEl.trigger('sortable:sort', {\n          from: indexFrom,\n          to: indexTo\n        });\n        app.emit('sortableSort', $sortingEl[0], {\n          from: indexFrom,\n          to: indexTo,\n          el: $sortingEl[0]\n        }, $sortableContainer[0]);\n      }\n\n      $insertBeforeEl = undefined;\n      $insertAfterEl = undefined;\n      isTouched = false;\n      isMoved = false;\n    }\n\n    var activeListener = getSupport().passiveListener ? {\n      passive: false,\n      capture: false\n    } : false;\n    $(document).on(app.touchEvents.start, '.list.sortable .sortable-handler', handleTouchStart, activeListener);\n    app.on('touchmove:active', handleTouchMove);\n    app.on('touchend:passive', handleTouchEnd);\n    $(document).on('taphold', '.sortable-tap-hold', function (e, pointerEvent) {\n      handleTouchStart(pointerEvent, true);\n    });\n  },\n  enable: function enable(el) {\n    if (el === void 0) {\n      el = '.list.sortable';\n    }\n\n    var app = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n    $el.addClass('sortable-enabled');\n    $el.trigger('sortable:enable');\n    app.emit('sortableEnable', $el[0]);\n  },\n  disable: function disable(el) {\n    if (el === void 0) {\n      el = '.list.sortable';\n    }\n\n    var app = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n    $el.removeClass('sortable-enabled');\n    $el.trigger('sortable:disable');\n    app.emit('sortableDisable', $el[0]);\n  },\n  toggle: function toggle(el) {\n    if (el === void 0) {\n      el = '.list.sortable';\n    }\n\n    var app = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n\n    if ($el.hasClass('sortable-enabled')) {\n      app.sortable.disable($el);\n    } else {\n      app.sortable.enable($el);\n    }\n  }\n};\nexport default {\n  name: 'sortable',\n  params: {\n    sortable: {\n      moveElements: true\n    }\n  },\n  create: function create() {\n    var app = this;\n    bindMethods(app, {\n      sortable: Sortable\n    });\n  },\n  on: {\n    init: function init() {\n      var app = this;\n      if (!app.params.sortable) return;\n      app.sortable.init();\n    }\n  },\n  clicks: {\n    '.sortable-enable': function enable($clickedEl, data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      var app = this;\n      app.sortable.enable(data.sortable);\n    },\n    '.sortable-disable': function disable($clickedEl, data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      var app = this;\n      app.sortable.disable(data.sortable);\n    },\n    '.sortable-toggle': function toggle($clickedEl, data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      var app = this;\n      app.sortable.toggle(data.sortable);\n    }\n  }\n};"]},"metadata":{},"sourceType":"module"}