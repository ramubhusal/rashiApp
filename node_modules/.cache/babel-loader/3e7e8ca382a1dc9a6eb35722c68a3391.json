{"ast":null,"code":"function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nimport { getWindow, getDocument } from 'ssr-window';\nimport $ from '../../shared/dom7';\nimport { extend, now, getTranslate } from '../../shared/utils';\nimport { getSupport } from '../../shared/get-support';\nimport { getDevice } from '../../shared/get-device';\nimport Modal from '../modal/modal-class';\n\nvar Sheet = /*#__PURE__*/function (_Modal) {\n  _inheritsLoose(Sheet, _Modal);\n\n  function Sheet(app, params) {\n    var _this;\n\n    var extendedParams = extend({\n      on: {}\n    }, app.params.sheet, params); // Extends with open/close Modal methods;\n\n    _this = _Modal.call(this, app, extendedParams) || this;\n\n    var sheet = _assertThisInitialized(_this);\n\n    var window = getWindow();\n    var document = getDocument();\n    var support = getSupport();\n    var device = getDevice();\n    sheet.params = extendedParams;\n\n    if (typeof sheet.params.backdrop === 'undefined') {\n      sheet.params.backdrop = app.theme !== 'ios';\n    } // Find Element\n\n\n    var $el;\n\n    if (!sheet.params.el) {\n      $el = $(sheet.params.content).filter(function (node) {\n        return node.nodeType === 1;\n      }).eq(0);\n    } else {\n      $el = $(sheet.params.el).eq(0);\n    }\n\n    if ($el && $el.length > 0 && $el[0].f7Modal) {\n      return $el[0].f7Modal || _assertThisInitialized(_this);\n    }\n\n    if ($el.length === 0) {\n      return sheet.destroy() || _assertThisInitialized(_this);\n    }\n\n    var $backdropEl;\n\n    if (sheet.params.backdrop && sheet.params.backdropEl) {\n      $backdropEl = $(sheet.params.backdropEl);\n    } else if (sheet.params.backdrop) {\n      $backdropEl = sheet.$containerEl.children('.sheet-backdrop');\n\n      if ($backdropEl.length === 0) {\n        $backdropEl = $('<div class=\"sheet-backdrop\"></div>');\n        sheet.$containerEl.append($backdropEl);\n      }\n    }\n\n    extend(sheet, {\n      app: app,\n      push: $el.hasClass('sheet-modal-push') || sheet.params.push,\n      $el: $el,\n      el: $el[0],\n      $backdropEl: $backdropEl,\n      backdropEl: $backdropEl && $backdropEl[0],\n      type: 'sheet',\n      $htmlEl: $('html')\n    });\n\n    if (sheet.params.push) {\n      $el.addClass('sheet-modal-push');\n    }\n\n    var $pageContentEl;\n\n    function scrollToElementOnOpen() {\n      var $scrollEl = $(sheet.params.scrollToEl).eq(0);\n      if ($scrollEl.length === 0) return;\n      $pageContentEl = $scrollEl.parents('.page-content');\n      if ($pageContentEl.length === 0) return;\n      var paddingTop = parseInt($pageContentEl.css('padding-top'), 10);\n      var paddingBottom = parseInt($pageContentEl.css('padding-bottom'), 10);\n      var pageHeight = $pageContentEl[0].offsetHeight - paddingTop - $el.height();\n      var pageScrollHeight = $pageContentEl[0].scrollHeight - paddingTop - $el.height();\n      var pageScroll = $pageContentEl.scrollTop();\n      var newPaddingBottom;\n      var scrollElTop = $scrollEl.offset().top - paddingTop + $scrollEl[0].offsetHeight;\n\n      if (scrollElTop > pageHeight) {\n        var scrollTop = pageScroll + scrollElTop - pageHeight;\n\n        if (scrollTop + pageHeight > pageScrollHeight) {\n          newPaddingBottom = scrollTop + pageHeight - pageScrollHeight + paddingBottom;\n\n          if (pageHeight === pageScrollHeight) {\n            newPaddingBottom = $el.height();\n          }\n\n          $pageContentEl.css({\n            'padding-bottom': newPaddingBottom + \"px\"\n          });\n        }\n\n        $pageContentEl.scrollTop(scrollTop, 300);\n      }\n    }\n\n    function scrollToElementOnClose() {\n      if ($pageContentEl && $pageContentEl.length > 0) {\n        $pageContentEl.css({\n          'padding-bottom': ''\n        });\n      }\n    }\n\n    function handleClick(e) {\n      var target = e.target;\n      var $target = $(target);\n      var keyboardOpened = !device.desktop && device.cordova && (window.Keyboard && window.Keyboard.isVisible || window.cordova.plugins && window.cordova.plugins.Keyboard && window.cordova.plugins.Keyboard.isVisible);\n      if (keyboardOpened) return;\n\n      if ($target.closest(sheet.el).length === 0) {\n        if (sheet.params.closeByBackdropClick && sheet.params.backdrop && sheet.backdropEl && sheet.backdropEl === target) {\n          sheet.close();\n        } else if (sheet.params.closeByOutsideClick) {\n          sheet.close();\n        }\n      }\n    }\n\n    function onKeyDown(e) {\n      var keyCode = e.keyCode;\n\n      if (keyCode === 27 && sheet.params.closeOnEscape) {\n        sheet.close();\n      }\n    }\n\n    var pushOffset;\n\n    function pushViewScale(offset) {\n      return (app.height - offset * 2) / app.height;\n    }\n\n    var isTouched = false;\n    var startTouch;\n    var currentTouch;\n    var isScrolling;\n    var touchStartTime;\n    var touchesDiff;\n    var isMoved = false;\n    var isTopSheetModal;\n    var swipeStepTranslate;\n    var startTranslate;\n    var currentTranslate;\n    var sheetElOffsetHeight;\n    var minTranslate;\n    var maxTranslate;\n    var $pushViewEl;\n    var pushBorderRadius;\n    var sheetPageContentEl;\n    var sheetPageContentScrollTop;\n    var sheetPageContentScrollHeight;\n    var sheetPageContentOffsetHeight;\n\n    function handleTouchStart(e) {\n      if (isTouched || !(sheet.params.swipeToClose || sheet.params.swipeToStep)) return;\n\n      if (sheet.params.swipeHandler && $(e.target).closest(sheet.params.swipeHandler).length === 0) {\n        return;\n      }\n\n      isTouched = true;\n      isMoved = false;\n      startTouch = {\n        x: e.type === 'touchstart' ? e.targetTouches[0].pageX : e.pageX,\n        y: e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY\n      };\n      touchStartTime = now();\n      isScrolling = undefined;\n      isTopSheetModal = $el.hasClass('sheet-modal-top');\n\n      if (!sheet.params.swipeHandler && e.type === 'touchstart') {\n        sheetPageContentEl = $(e.target).closest('.page-content')[0];\n      }\n    }\n\n    function handleTouchMove(e) {\n      if (!isTouched) return;\n      currentTouch = {\n        x: e.type === 'touchmove' ? e.targetTouches[0].pageX : e.pageX,\n        y: e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY\n      };\n\n      if (typeof isScrolling === 'undefined') {\n        isScrolling = !!(isScrolling || Math.abs(currentTouch.x - startTouch.x) > Math.abs(currentTouch.y - startTouch.y));\n      }\n\n      if (isScrolling) {\n        isTouched = false;\n        isMoved = false;\n        return;\n      }\n\n      touchesDiff = startTouch.y - currentTouch.y;\n      var direction = touchesDiff < 0 ? 'to-bottom' : 'to-top';\n\n      if (!isMoved) {\n        if (sheetPageContentEl && !$el.hasClass('modal-in-swipe-step')) {\n          sheetPageContentScrollTop = sheetPageContentEl.scrollTop;\n          sheetPageContentScrollHeight = sheetPageContentEl.scrollHeight;\n          sheetPageContentOffsetHeight = sheetPageContentEl.offsetHeight;\n\n          if (!(sheetPageContentScrollHeight === sheetPageContentOffsetHeight) && !(direction === 'to-bottom' && sheetPageContentScrollTop === 0) && !(direction === 'to-top' && sheetPageContentScrollTop === sheetPageContentScrollHeight - sheetPageContentOffsetHeight)) {\n            $el.transform('');\n            isTouched = false;\n            isMoved = false;\n            return;\n          }\n        }\n\n        if (sheet.push && pushOffset) {\n          $pushViewEl = app.$el.children('.view, .views');\n        }\n\n        sheetElOffsetHeight = $el[0].offsetHeight;\n        startTranslate = getTranslate($el[0], 'y');\n\n        if (isTopSheetModal) {\n          minTranslate = sheet.params.swipeToClose ? -sheetElOffsetHeight : -swipeStepTranslate;\n          maxTranslate = 0;\n        } else {\n          minTranslate = 0;\n          maxTranslate = sheet.params.swipeToClose ? sheetElOffsetHeight : swipeStepTranslate;\n        }\n\n        isMoved = true;\n      }\n\n      currentTranslate = startTranslate - touchesDiff;\n      currentTranslate = Math.min(Math.max(currentTranslate, minTranslate), maxTranslate);\n      e.preventDefault();\n\n      if (sheet.push && pushOffset) {\n        var progress = (currentTranslate - startTranslate) / sheetElOffsetHeight;\n\n        if (sheet.params.swipeToStep) {\n          if (isTopSheetModal) {\n            progress = currentTranslate / swipeStepTranslate;\n          } else {\n            progress = 1 - (swipeStepTranslate - currentTranslate) / swipeStepTranslate;\n          }\n        }\n\n        progress = Math.abs(progress);\n        progress = Math.min(Math.max(progress, 0), 1);\n        var pushProgress = 1 - progress;\n        var scale = 1 - (1 - pushViewScale(pushOffset)) * pushProgress;\n        $pushViewEl.transition(0).forEach(function (el) {\n          el.style.setProperty('transform', \"translate3d(0,0,0) scale(\" + scale + \")\", 'important');\n        });\n\n        if (sheet.params.swipeToStep) {\n          $pushViewEl.css('border-radius', pushBorderRadius * pushProgress + \"px\");\n        }\n      }\n\n      $el.transition(0).transform(\"translate3d(0,\" + currentTranslate + \"px,0)\");\n\n      if (sheet.params.swipeToStep) {\n        var _progress;\n\n        if (isTopSheetModal) {\n          _progress = 1 - currentTranslate / swipeStepTranslate;\n        } else {\n          _progress = (swipeStepTranslate - currentTranslate) / swipeStepTranslate;\n        }\n\n        _progress = Math.min(Math.max(_progress, 0), 1);\n        $el.trigger('sheet:stepprogress', _progress);\n        sheet.emit('local::stepProgress sheetStepProgress', sheet, _progress);\n      }\n    }\n\n    function handleTouchEnd() {\n      isTouched = false;\n\n      if (!isMoved) {\n        return;\n      }\n\n      isMoved = false;\n      $el.transform('').transition('');\n\n      if (sheet.push && pushOffset) {\n        $pushViewEl.transition('').transform('');\n        $pushViewEl.css('border-radius', '');\n      }\n\n      var direction = touchesDiff < 0 ? 'to-bottom' : 'to-top';\n      var diff = Math.abs(touchesDiff);\n      if (diff === 0 || currentTranslate === startTranslate) return;\n      var timeDiff = new Date().getTime() - touchStartTime;\n\n      if (!sheet.params.swipeToStep) {\n        if (direction !== (isTopSheetModal ? 'to-top' : 'to-bottom')) {\n          return;\n        }\n\n        if (timeDiff < 300 && diff > 20 || timeDiff >= 300 && diff > sheetElOffsetHeight / 2) {\n          sheet.close();\n        }\n\n        return;\n      }\n\n      var openDirection = isTopSheetModal ? 'to-bottom' : 'to-top';\n      var closeDirection = isTopSheetModal ? 'to-top' : 'to-bottom';\n      var absCurrentTranslate = Math.abs(currentTranslate);\n      var absSwipeStepTranslate = Math.abs(swipeStepTranslate);\n\n      if (timeDiff < 300 && diff > 10) {\n        if (direction === openDirection && absCurrentTranslate < absSwipeStepTranslate) {\n          // open step\n          $el.removeClass('modal-in-swipe-step');\n          $el.trigger('sheet:stepprogress', 1);\n          sheet.emit('local::stepProgress sheetStepProgress', sheet, 1);\n          $el.trigger('sheet:stepopen');\n          sheet.emit('local::stepOpen sheetStepOpen', sheet);\n\n          if (sheet.push && pushOffset) {\n            sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n            $pushViewEl.css('border-radius', '');\n          }\n        }\n\n        if (direction === closeDirection && absCurrentTranslate > absSwipeStepTranslate) {\n          // close sheet\n          if (sheet.params.swipeToClose) {\n            sheet.close();\n          } else {\n            // close step\n            $el.addClass('modal-in-swipe-step');\n            $el.trigger('sheet:stepprogress', 0);\n            sheet.emit('local::stepProgress sheetStepProgress', sheet, 0);\n            $el.trigger('sheet:stepclose');\n            sheet.emit('local::stepClose sheetStepClose', sheet);\n\n            if (sheet.push && pushOffset) {\n              sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n              $pushViewEl.css('border-radius', '0px');\n            }\n          }\n        }\n\n        if (direction === closeDirection && absCurrentTranslate <= absSwipeStepTranslate) {\n          // close step\n          $el.addClass('modal-in-swipe-step');\n          $el.trigger('sheet:stepprogress', 0);\n          sheet.emit('local::stepProgress sheetStepProgress', sheet, 0);\n          $el.trigger('sheet:stepclose');\n          sheet.emit('local::stepClose sheetStepClose', sheet);\n\n          if (sheet.push && pushOffset) {\n            sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n            $pushViewEl.css('border-radius', '0px');\n          }\n        }\n\n        return;\n      }\n\n      if (timeDiff >= 300) {\n        var stepOpened = !$el.hasClass('modal-in-swipe-step');\n\n        if (!stepOpened) {\n          if (absCurrentTranslate < absSwipeStepTranslate / 2) {\n            // open step\n            $el.removeClass('modal-in-swipe-step');\n            $el.trigger('sheet:stepprogress', 1);\n            sheet.emit('local::stepProgress sheetStepProgress', sheet, 1);\n            $el.trigger('sheet:stepopen');\n            sheet.emit('local::stepOpen sheetStepOpen', sheet);\n\n            if (sheet.push && pushOffset) {\n              sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n              $pushViewEl.css('border-radius', '');\n            }\n          } else if (absCurrentTranslate - absSwipeStepTranslate > (sheetElOffsetHeight - absSwipeStepTranslate) / 2) {\n            // close sheet\n            if (sheet.params.swipeToClose) sheet.close();\n          }\n        } else if (stepOpened) {\n          if (absCurrentTranslate > absSwipeStepTranslate + (sheetElOffsetHeight - absSwipeStepTranslate) / 2) {\n            // close sheet\n            if (sheet.params.swipeToClose) sheet.close();\n          } else if (absCurrentTranslate > absSwipeStepTranslate / 2) {\n            // close step\n            $el.addClass('modal-in-swipe-step');\n            $el.trigger('sheet:stepprogress', 0);\n            sheet.emit('local::stepProgress sheetStepProgress', sheet, 0);\n            $el.trigger('sheet:stepclose');\n            sheet.emit('local::stepClose sheetStepClose', sheet);\n\n            if (sheet.push && pushOffset) {\n              sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n              $pushViewEl.css('border-radius', '0px');\n            }\n          }\n        }\n      }\n    }\n\n    sheet.setSwipeStep = function setSwipeStep(byResize) {\n      if (byResize === void 0) {\n        byResize = true;\n      }\n\n      var $swipeStepEl = $el.find('.sheet-modal-swipe-step').eq(0);\n      if (!$swipeStepEl.length) return;\n\n      if ($el.hasClass('sheet-modal-top')) {\n        swipeStepTranslate = -($swipeStepEl.offset().top - $el.offset().top + $swipeStepEl[0].offsetHeight);\n      } else {\n        swipeStepTranslate = $el[0].offsetHeight - ($swipeStepEl.offset().top - $el.offset().top + $swipeStepEl[0].offsetHeight);\n      }\n\n      $el[0].style.setProperty('--f7-sheet-swipe-step', swipeStepTranslate + \"px\");\n\n      if (!byResize) {\n        $el.addClass('modal-in-swipe-step');\n      }\n    };\n\n    function onResize() {\n      sheet.setSwipeStep(true);\n    }\n\n    var passive = support.passiveListener ? {\n      passive: true\n    } : false;\n\n    if (sheet.params.swipeToClose || sheet.params.swipeToStep) {\n      $el.on(app.touchEvents.start, handleTouchStart, passive);\n      app.on('touchmove', handleTouchMove);\n      app.on('touchend:passive', handleTouchEnd);\n      sheet.once('sheetDestroy', function () {\n        $el.off(app.touchEvents.start, handleTouchStart, passive);\n        app.off('touchmove', handleTouchMove);\n        app.off('touchend:passive', handleTouchEnd);\n      });\n    }\n\n    sheet.on('open', function () {\n      if (sheet.params.closeOnEscape) {\n        $(document).on('keydown', onKeyDown);\n      }\n\n      $el.prevAll('.popup.modal-in').addClass('popup-behind');\n\n      if (sheet.params.swipeToStep) {\n        sheet.setSwipeStep(false);\n        app.on('resize', onResize);\n      }\n\n      if (sheet.params.scrollToEl) {\n        scrollToElementOnOpen();\n      }\n\n      if (sheet.push) {\n        pushOffset = parseInt($el.css('--f7-sheet-push-offset'), 10);\n        if (Number.isNaN(pushOffset)) pushOffset = 0;\n\n        if (pushOffset) {\n          $el.addClass('sheet-modal-push');\n          sheet.$htmlEl.addClass('with-modal-sheet-push');\n\n          if (!sheet.params.swipeToStep) {\n            sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n          } else {\n            $pushViewEl = app.$el.children('.view, .views');\n            pushBorderRadius = parseFloat($el.css(\"border-\" + (isTopSheetModal ? 'bottom' : 'top') + \"-left-radius\"));\n            $pushViewEl.css('border-radius', '0px');\n          }\n        }\n      }\n    });\n    sheet.on('opened', function () {\n      if (sheet.params.closeByOutsideClick || sheet.params.closeByBackdropClick) {\n        app.on('click', handleClick);\n      }\n    });\n    sheet.on('close', function () {\n      if (sheet.params.swipeToStep) {\n        $el.removeClass('modal-in-swipe-step');\n        app.off('resize', onResize);\n      }\n\n      if (sheet.params.closeOnEscape) {\n        $(document).off('keydown', onKeyDown);\n      }\n\n      if (sheet.params.scrollToEl) {\n        scrollToElementOnClose();\n      }\n\n      if (sheet.params.closeByOutsideClick || sheet.params.closeByBackdropClick) {\n        app.off('click', handleClick);\n      }\n\n      $el.prevAll('.popup.modal-in').eq(0).removeClass('popup-behind');\n\n      if (sheet.push && pushOffset) {\n        sheet.$htmlEl.removeClass('with-modal-sheet-push');\n        sheet.$htmlEl.addClass('with-modal-sheet-push-closing');\n      }\n    });\n    sheet.on('closed', function () {\n      if (sheet.push && pushOffset) {\n        sheet.$htmlEl.removeClass('with-modal-sheet-push-closing');\n        sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n      }\n    });\n\n    sheet.stepOpen = function stepOpen() {\n      $el.removeClass('modal-in-swipe-step');\n\n      if (sheet.push) {\n        if (!pushOffset) {\n          pushOffset = parseInt($el.css('--f7-sheet-push-offset'), 10);\n          if (Number.isNaN(pushOffset)) pushOffset = 0;\n        }\n\n        if (pushOffset) {\n          sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n        }\n      }\n    };\n\n    sheet.stepClose = function stepClose() {\n      $el.addClass('modal-in-swipe-step');\n\n      if (sheet.push) {\n        sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n      }\n    };\n\n    sheet.stepToggle = function stepToggle() {\n      $el.toggleClass('modal-in-swipe-step');\n    };\n\n    $el[0].f7Modal = sheet;\n    return sheet || _assertThisInitialized(_this);\n  }\n\n  return Sheet;\n}(Modal);\n\nexport default Sheet;","map":{"version":3,"sources":["E:/Programming/React/rashi-app/node_modules/framework7/esm/components/sheet/sheet-class.js"],"names":["_assertThisInitialized","self","ReferenceError","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","__proto__","getWindow","getDocument","$","extend","now","getTranslate","getSupport","getDevice","Modal","Sheet","_Modal","app","params","_this","extendedParams","on","sheet","call","window","document","support","device","backdrop","theme","$el","el","content","filter","node","nodeType","eq","length","f7Modal","destroy","$backdropEl","backdropEl","$containerEl","children","append","push","hasClass","type","$htmlEl","addClass","$pageContentEl","scrollToElementOnOpen","$scrollEl","scrollToEl","parents","paddingTop","parseInt","css","paddingBottom","pageHeight","offsetHeight","height","pageScrollHeight","scrollHeight","pageScroll","scrollTop","newPaddingBottom","scrollElTop","offset","top","scrollToElementOnClose","handleClick","e","target","$target","keyboardOpened","desktop","cordova","Keyboard","isVisible","plugins","closest","closeByBackdropClick","close","closeByOutsideClick","onKeyDown","keyCode","closeOnEscape","pushOffset","pushViewScale","isTouched","startTouch","currentTouch","isScrolling","touchStartTime","touchesDiff","isMoved","isTopSheetModal","swipeStepTranslate","startTranslate","currentTranslate","sheetElOffsetHeight","minTranslate","maxTranslate","$pushViewEl","pushBorderRadius","sheetPageContentEl","sheetPageContentScrollTop","sheetPageContentScrollHeight","sheetPageContentOffsetHeight","handleTouchStart","swipeToClose","swipeToStep","swipeHandler","x","targetTouches","pageX","y","pageY","undefined","handleTouchMove","Math","abs","direction","transform","min","max","preventDefault","progress","pushProgress","scale","transition","forEach","style","setProperty","_progress","trigger","emit","handleTouchEnd","diff","timeDiff","Date","getTime","openDirection","closeDirection","absCurrentTranslate","absSwipeStepTranslate","removeClass","removeProperty","stepOpened","setSwipeStep","byResize","$swipeStepEl","find","onResize","passive","passiveListener","touchEvents","start","once","off","prevAll","Number","isNaN","parseFloat","stepOpen","stepClose","stepToggle","toggleClass"],"mappings":"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","sourcesContent":["function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nimport { getWindow, getDocument } from 'ssr-window';\nimport $ from '../../shared/dom7';\nimport { extend, now, getTranslate } from '../../shared/utils';\nimport { getSupport } from '../../shared/get-support';\nimport { getDevice } from '../../shared/get-device';\nimport Modal from '../modal/modal-class';\n\nvar Sheet = /*#__PURE__*/function (_Modal) {\n  _inheritsLoose(Sheet, _Modal);\n\n  function Sheet(app, params) {\n    var _this;\n\n    var extendedParams = extend({\n      on: {}\n    }, app.params.sheet, params); // Extends with open/close Modal methods;\n\n    _this = _Modal.call(this, app, extendedParams) || this;\n\n    var sheet = _assertThisInitialized(_this);\n\n    var window = getWindow();\n    var document = getDocument();\n    var support = getSupport();\n    var device = getDevice();\n    sheet.params = extendedParams;\n\n    if (typeof sheet.params.backdrop === 'undefined') {\n      sheet.params.backdrop = app.theme !== 'ios';\n    } // Find Element\n\n\n    var $el;\n\n    if (!sheet.params.el) {\n      $el = $(sheet.params.content).filter(function (node) {\n        return node.nodeType === 1;\n      }).eq(0);\n    } else {\n      $el = $(sheet.params.el).eq(0);\n    }\n\n    if ($el && $el.length > 0 && $el[0].f7Modal) {\n      return $el[0].f7Modal || _assertThisInitialized(_this);\n    }\n\n    if ($el.length === 0) {\n      return sheet.destroy() || _assertThisInitialized(_this);\n    }\n\n    var $backdropEl;\n\n    if (sheet.params.backdrop && sheet.params.backdropEl) {\n      $backdropEl = $(sheet.params.backdropEl);\n    } else if (sheet.params.backdrop) {\n      $backdropEl = sheet.$containerEl.children('.sheet-backdrop');\n\n      if ($backdropEl.length === 0) {\n        $backdropEl = $('<div class=\"sheet-backdrop\"></div>');\n        sheet.$containerEl.append($backdropEl);\n      }\n    }\n\n    extend(sheet, {\n      app: app,\n      push: $el.hasClass('sheet-modal-push') || sheet.params.push,\n      $el: $el,\n      el: $el[0],\n      $backdropEl: $backdropEl,\n      backdropEl: $backdropEl && $backdropEl[0],\n      type: 'sheet',\n      $htmlEl: $('html')\n    });\n\n    if (sheet.params.push) {\n      $el.addClass('sheet-modal-push');\n    }\n\n    var $pageContentEl;\n\n    function scrollToElementOnOpen() {\n      var $scrollEl = $(sheet.params.scrollToEl).eq(0);\n      if ($scrollEl.length === 0) return;\n      $pageContentEl = $scrollEl.parents('.page-content');\n      if ($pageContentEl.length === 0) return;\n      var paddingTop = parseInt($pageContentEl.css('padding-top'), 10);\n      var paddingBottom = parseInt($pageContentEl.css('padding-bottom'), 10);\n      var pageHeight = $pageContentEl[0].offsetHeight - paddingTop - $el.height();\n      var pageScrollHeight = $pageContentEl[0].scrollHeight - paddingTop - $el.height();\n      var pageScroll = $pageContentEl.scrollTop();\n      var newPaddingBottom;\n      var scrollElTop = $scrollEl.offset().top - paddingTop + $scrollEl[0].offsetHeight;\n\n      if (scrollElTop > pageHeight) {\n        var scrollTop = pageScroll + scrollElTop - pageHeight;\n\n        if (scrollTop + pageHeight > pageScrollHeight) {\n          newPaddingBottom = scrollTop + pageHeight - pageScrollHeight + paddingBottom;\n\n          if (pageHeight === pageScrollHeight) {\n            newPaddingBottom = $el.height();\n          }\n\n          $pageContentEl.css({\n            'padding-bottom': newPaddingBottom + \"px\"\n          });\n        }\n\n        $pageContentEl.scrollTop(scrollTop, 300);\n      }\n    }\n\n    function scrollToElementOnClose() {\n      if ($pageContentEl && $pageContentEl.length > 0) {\n        $pageContentEl.css({\n          'padding-bottom': ''\n        });\n      }\n    }\n\n    function handleClick(e) {\n      var target = e.target;\n      var $target = $(target);\n      var keyboardOpened = !device.desktop && device.cordova && (window.Keyboard && window.Keyboard.isVisible || window.cordova.plugins && window.cordova.plugins.Keyboard && window.cordova.plugins.Keyboard.isVisible);\n      if (keyboardOpened) return;\n\n      if ($target.closest(sheet.el).length === 0) {\n        if (sheet.params.closeByBackdropClick && sheet.params.backdrop && sheet.backdropEl && sheet.backdropEl === target) {\n          sheet.close();\n        } else if (sheet.params.closeByOutsideClick) {\n          sheet.close();\n        }\n      }\n    }\n\n    function onKeyDown(e) {\n      var keyCode = e.keyCode;\n\n      if (keyCode === 27 && sheet.params.closeOnEscape) {\n        sheet.close();\n      }\n    }\n\n    var pushOffset;\n\n    function pushViewScale(offset) {\n      return (app.height - offset * 2) / app.height;\n    }\n\n    var isTouched = false;\n    var startTouch;\n    var currentTouch;\n    var isScrolling;\n    var touchStartTime;\n    var touchesDiff;\n    var isMoved = false;\n    var isTopSheetModal;\n    var swipeStepTranslate;\n    var startTranslate;\n    var currentTranslate;\n    var sheetElOffsetHeight;\n    var minTranslate;\n    var maxTranslate;\n    var $pushViewEl;\n    var pushBorderRadius;\n    var sheetPageContentEl;\n    var sheetPageContentScrollTop;\n    var sheetPageContentScrollHeight;\n    var sheetPageContentOffsetHeight;\n\n    function handleTouchStart(e) {\n      if (isTouched || !(sheet.params.swipeToClose || sheet.params.swipeToStep)) return;\n\n      if (sheet.params.swipeHandler && $(e.target).closest(sheet.params.swipeHandler).length === 0) {\n        return;\n      }\n\n      isTouched = true;\n      isMoved = false;\n      startTouch = {\n        x: e.type === 'touchstart' ? e.targetTouches[0].pageX : e.pageX,\n        y: e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY\n      };\n      touchStartTime = now();\n      isScrolling = undefined;\n      isTopSheetModal = $el.hasClass('sheet-modal-top');\n\n      if (!sheet.params.swipeHandler && e.type === 'touchstart') {\n        sheetPageContentEl = $(e.target).closest('.page-content')[0];\n      }\n    }\n\n    function handleTouchMove(e) {\n      if (!isTouched) return;\n      currentTouch = {\n        x: e.type === 'touchmove' ? e.targetTouches[0].pageX : e.pageX,\n        y: e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY\n      };\n\n      if (typeof isScrolling === 'undefined') {\n        isScrolling = !!(isScrolling || Math.abs(currentTouch.x - startTouch.x) > Math.abs(currentTouch.y - startTouch.y));\n      }\n\n      if (isScrolling) {\n        isTouched = false;\n        isMoved = false;\n        return;\n      }\n\n      touchesDiff = startTouch.y - currentTouch.y;\n      var direction = touchesDiff < 0 ? 'to-bottom' : 'to-top';\n\n      if (!isMoved) {\n        if (sheetPageContentEl && !$el.hasClass('modal-in-swipe-step')) {\n          sheetPageContentScrollTop = sheetPageContentEl.scrollTop;\n          sheetPageContentScrollHeight = sheetPageContentEl.scrollHeight;\n          sheetPageContentOffsetHeight = sheetPageContentEl.offsetHeight;\n\n          if (!(sheetPageContentScrollHeight === sheetPageContentOffsetHeight) && !(direction === 'to-bottom' && sheetPageContentScrollTop === 0) && !(direction === 'to-top' && sheetPageContentScrollTop === sheetPageContentScrollHeight - sheetPageContentOffsetHeight)) {\n            $el.transform('');\n            isTouched = false;\n            isMoved = false;\n            return;\n          }\n        }\n\n        if (sheet.push && pushOffset) {\n          $pushViewEl = app.$el.children('.view, .views');\n        }\n\n        sheetElOffsetHeight = $el[0].offsetHeight;\n        startTranslate = getTranslate($el[0], 'y');\n\n        if (isTopSheetModal) {\n          minTranslate = sheet.params.swipeToClose ? -sheetElOffsetHeight : -swipeStepTranslate;\n          maxTranslate = 0;\n        } else {\n          minTranslate = 0;\n          maxTranslate = sheet.params.swipeToClose ? sheetElOffsetHeight : swipeStepTranslate;\n        }\n\n        isMoved = true;\n      }\n\n      currentTranslate = startTranslate - touchesDiff;\n      currentTranslate = Math.min(Math.max(currentTranslate, minTranslate), maxTranslate);\n      e.preventDefault();\n\n      if (sheet.push && pushOffset) {\n        var progress = (currentTranslate - startTranslate) / sheetElOffsetHeight;\n\n        if (sheet.params.swipeToStep) {\n          if (isTopSheetModal) {\n            progress = currentTranslate / swipeStepTranslate;\n          } else {\n            progress = 1 - (swipeStepTranslate - currentTranslate) / swipeStepTranslate;\n          }\n        }\n\n        progress = Math.abs(progress);\n        progress = Math.min(Math.max(progress, 0), 1);\n        var pushProgress = 1 - progress;\n        var scale = 1 - (1 - pushViewScale(pushOffset)) * pushProgress;\n        $pushViewEl.transition(0).forEach(function (el) {\n          el.style.setProperty('transform', \"translate3d(0,0,0) scale(\" + scale + \")\", 'important');\n        });\n\n        if (sheet.params.swipeToStep) {\n          $pushViewEl.css('border-radius', pushBorderRadius * pushProgress + \"px\");\n        }\n      }\n\n      $el.transition(0).transform(\"translate3d(0,\" + currentTranslate + \"px,0)\");\n\n      if (sheet.params.swipeToStep) {\n        var _progress;\n\n        if (isTopSheetModal) {\n          _progress = 1 - currentTranslate / swipeStepTranslate;\n        } else {\n          _progress = (swipeStepTranslate - currentTranslate) / swipeStepTranslate;\n        }\n\n        _progress = Math.min(Math.max(_progress, 0), 1);\n        $el.trigger('sheet:stepprogress', _progress);\n        sheet.emit('local::stepProgress sheetStepProgress', sheet, _progress);\n      }\n    }\n\n    function handleTouchEnd() {\n      isTouched = false;\n\n      if (!isMoved) {\n        return;\n      }\n\n      isMoved = false;\n      $el.transform('').transition('');\n\n      if (sheet.push && pushOffset) {\n        $pushViewEl.transition('').transform('');\n        $pushViewEl.css('border-radius', '');\n      }\n\n      var direction = touchesDiff < 0 ? 'to-bottom' : 'to-top';\n      var diff = Math.abs(touchesDiff);\n      if (diff === 0 || currentTranslate === startTranslate) return;\n      var timeDiff = new Date().getTime() - touchStartTime;\n\n      if (!sheet.params.swipeToStep) {\n        if (direction !== (isTopSheetModal ? 'to-top' : 'to-bottom')) {\n          return;\n        }\n\n        if (timeDiff < 300 && diff > 20 || timeDiff >= 300 && diff > sheetElOffsetHeight / 2) {\n          sheet.close();\n        }\n\n        return;\n      }\n\n      var openDirection = isTopSheetModal ? 'to-bottom' : 'to-top';\n      var closeDirection = isTopSheetModal ? 'to-top' : 'to-bottom';\n      var absCurrentTranslate = Math.abs(currentTranslate);\n      var absSwipeStepTranslate = Math.abs(swipeStepTranslate);\n\n      if (timeDiff < 300 && diff > 10) {\n        if (direction === openDirection && absCurrentTranslate < absSwipeStepTranslate) {\n          // open step\n          $el.removeClass('modal-in-swipe-step');\n          $el.trigger('sheet:stepprogress', 1);\n          sheet.emit('local::stepProgress sheetStepProgress', sheet, 1);\n          $el.trigger('sheet:stepopen');\n          sheet.emit('local::stepOpen sheetStepOpen', sheet);\n\n          if (sheet.push && pushOffset) {\n            sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n            $pushViewEl.css('border-radius', '');\n          }\n        }\n\n        if (direction === closeDirection && absCurrentTranslate > absSwipeStepTranslate) {\n          // close sheet\n          if (sheet.params.swipeToClose) {\n            sheet.close();\n          } else {\n            // close step\n            $el.addClass('modal-in-swipe-step');\n            $el.trigger('sheet:stepprogress', 0);\n            sheet.emit('local::stepProgress sheetStepProgress', sheet, 0);\n            $el.trigger('sheet:stepclose');\n            sheet.emit('local::stepClose sheetStepClose', sheet);\n\n            if (sheet.push && pushOffset) {\n              sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n              $pushViewEl.css('border-radius', '0px');\n            }\n          }\n        }\n\n        if (direction === closeDirection && absCurrentTranslate <= absSwipeStepTranslate) {\n          // close step\n          $el.addClass('modal-in-swipe-step');\n          $el.trigger('sheet:stepprogress', 0);\n          sheet.emit('local::stepProgress sheetStepProgress', sheet, 0);\n          $el.trigger('sheet:stepclose');\n          sheet.emit('local::stepClose sheetStepClose', sheet);\n\n          if (sheet.push && pushOffset) {\n            sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n            $pushViewEl.css('border-radius', '0px');\n          }\n        }\n\n        return;\n      }\n\n      if (timeDiff >= 300) {\n        var stepOpened = !$el.hasClass('modal-in-swipe-step');\n\n        if (!stepOpened) {\n          if (absCurrentTranslate < absSwipeStepTranslate / 2) {\n            // open step\n            $el.removeClass('modal-in-swipe-step');\n            $el.trigger('sheet:stepprogress', 1);\n            sheet.emit('local::stepProgress sheetStepProgress', sheet, 1);\n            $el.trigger('sheet:stepopen');\n            sheet.emit('local::stepOpen sheetStepOpen', sheet);\n\n            if (sheet.push && pushOffset) {\n              sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n              $pushViewEl.css('border-radius', '');\n            }\n          } else if (absCurrentTranslate - absSwipeStepTranslate > (sheetElOffsetHeight - absSwipeStepTranslate) / 2) {\n            // close sheet\n            if (sheet.params.swipeToClose) sheet.close();\n          }\n        } else if (stepOpened) {\n          if (absCurrentTranslate > absSwipeStepTranslate + (sheetElOffsetHeight - absSwipeStepTranslate) / 2) {\n            // close sheet\n            if (sheet.params.swipeToClose) sheet.close();\n          } else if (absCurrentTranslate > absSwipeStepTranslate / 2) {\n            // close step\n            $el.addClass('modal-in-swipe-step');\n            $el.trigger('sheet:stepprogress', 0);\n            sheet.emit('local::stepProgress sheetStepProgress', sheet, 0);\n            $el.trigger('sheet:stepclose');\n            sheet.emit('local::stepClose sheetStepClose', sheet);\n\n            if (sheet.push && pushOffset) {\n              sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n              $pushViewEl.css('border-radius', '0px');\n            }\n          }\n        }\n      }\n    }\n\n    sheet.setSwipeStep = function setSwipeStep(byResize) {\n      if (byResize === void 0) {\n        byResize = true;\n      }\n\n      var $swipeStepEl = $el.find('.sheet-modal-swipe-step').eq(0);\n      if (!$swipeStepEl.length) return;\n\n      if ($el.hasClass('sheet-modal-top')) {\n        swipeStepTranslate = -($swipeStepEl.offset().top - $el.offset().top + $swipeStepEl[0].offsetHeight);\n      } else {\n        swipeStepTranslate = $el[0].offsetHeight - ($swipeStepEl.offset().top - $el.offset().top + $swipeStepEl[0].offsetHeight);\n      }\n\n      $el[0].style.setProperty('--f7-sheet-swipe-step', swipeStepTranslate + \"px\");\n\n      if (!byResize) {\n        $el.addClass('modal-in-swipe-step');\n      }\n    };\n\n    function onResize() {\n      sheet.setSwipeStep(true);\n    }\n\n    var passive = support.passiveListener ? {\n      passive: true\n    } : false;\n\n    if (sheet.params.swipeToClose || sheet.params.swipeToStep) {\n      $el.on(app.touchEvents.start, handleTouchStart, passive);\n      app.on('touchmove', handleTouchMove);\n      app.on('touchend:passive', handleTouchEnd);\n      sheet.once('sheetDestroy', function () {\n        $el.off(app.touchEvents.start, handleTouchStart, passive);\n        app.off('touchmove', handleTouchMove);\n        app.off('touchend:passive', handleTouchEnd);\n      });\n    }\n\n    sheet.on('open', function () {\n      if (sheet.params.closeOnEscape) {\n        $(document).on('keydown', onKeyDown);\n      }\n\n      $el.prevAll('.popup.modal-in').addClass('popup-behind');\n\n      if (sheet.params.swipeToStep) {\n        sheet.setSwipeStep(false);\n        app.on('resize', onResize);\n      }\n\n      if (sheet.params.scrollToEl) {\n        scrollToElementOnOpen();\n      }\n\n      if (sheet.push) {\n        pushOffset = parseInt($el.css('--f7-sheet-push-offset'), 10);\n        if (Number.isNaN(pushOffset)) pushOffset = 0;\n\n        if (pushOffset) {\n          $el.addClass('sheet-modal-push');\n          sheet.$htmlEl.addClass('with-modal-sheet-push');\n\n          if (!sheet.params.swipeToStep) {\n            sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n          } else {\n            $pushViewEl = app.$el.children('.view, .views');\n            pushBorderRadius = parseFloat($el.css(\"border-\" + (isTopSheetModal ? 'bottom' : 'top') + \"-left-radius\"));\n            $pushViewEl.css('border-radius', '0px');\n          }\n        }\n      }\n    });\n    sheet.on('opened', function () {\n      if (sheet.params.closeByOutsideClick || sheet.params.closeByBackdropClick) {\n        app.on('click', handleClick);\n      }\n    });\n    sheet.on('close', function () {\n      if (sheet.params.swipeToStep) {\n        $el.removeClass('modal-in-swipe-step');\n        app.off('resize', onResize);\n      }\n\n      if (sheet.params.closeOnEscape) {\n        $(document).off('keydown', onKeyDown);\n      }\n\n      if (sheet.params.scrollToEl) {\n        scrollToElementOnClose();\n      }\n\n      if (sheet.params.closeByOutsideClick || sheet.params.closeByBackdropClick) {\n        app.off('click', handleClick);\n      }\n\n      $el.prevAll('.popup.modal-in').eq(0).removeClass('popup-behind');\n\n      if (sheet.push && pushOffset) {\n        sheet.$htmlEl.removeClass('with-modal-sheet-push');\n        sheet.$htmlEl.addClass('with-modal-sheet-push-closing');\n      }\n    });\n    sheet.on('closed', function () {\n      if (sheet.push && pushOffset) {\n        sheet.$htmlEl.removeClass('with-modal-sheet-push-closing');\n        sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n      }\n    });\n\n    sheet.stepOpen = function stepOpen() {\n      $el.removeClass('modal-in-swipe-step');\n\n      if (sheet.push) {\n        if (!pushOffset) {\n          pushOffset = parseInt($el.css('--f7-sheet-push-offset'), 10);\n          if (Number.isNaN(pushOffset)) pushOffset = 0;\n        }\n\n        if (pushOffset) {\n          sheet.$htmlEl[0].style.setProperty('--f7-sheet-push-scale', pushViewScale(pushOffset));\n        }\n      }\n    };\n\n    sheet.stepClose = function stepClose() {\n      $el.addClass('modal-in-swipe-step');\n\n      if (sheet.push) {\n        sheet.$htmlEl[0].style.removeProperty('--f7-sheet-push-scale');\n      }\n    };\n\n    sheet.stepToggle = function stepToggle() {\n      $el.toggleClass('modal-in-swipe-step');\n    };\n\n    $el[0].f7Modal = sheet;\n    return sheet || _assertThisInitialized(_this);\n  }\n\n  return Sheet;\n}(Modal);\n\nexport default Sheet;"]},"metadata":{},"sourceType":"module"}