{"ast":null,"code":"import $ from '../../shared/dom7';\nimport History from '../../shared/history';\nimport { getSupport } from '../../shared/get-support';\nimport { getDevice } from '../../shared/get-device';\nimport { now } from '../../shared/utils';\n\nfunction SwipeBack(r) {\n  var router = r;\n  var $el = router.$el,\n      $navbarsEl = router.$navbarsEl,\n      app = router.app,\n      params = router.params;\n  var support = getSupport();\n  var device = getDevice();\n  var isTouched = false;\n  var isMoved = false;\n  var touchesStart = {};\n  var isScrolling;\n  var $currentPageEl = [];\n  var $previousPageEl = [];\n  var viewContainerWidth;\n  var touchesDiff;\n  var allowViewTouchMove = true;\n  var touchStartTime;\n  var $currentNavbarEl = [];\n  var $previousNavbarEl = [];\n  var dynamicNavbar;\n  var $pageShadowEl;\n  var $pageOpacityEl;\n  var animatableNavEls;\n  var paramsSwipeBackAnimateShadow = params[app.theme + \"SwipeBackAnimateShadow\"];\n  var paramsSwipeBackAnimateOpacity = params[app.theme + \"SwipeBackAnimateOpacity\"];\n  var paramsSwipeBackActiveArea = params[app.theme + \"SwipeBackActiveArea\"];\n  var paramsSwipeBackThreshold = params[app.theme + \"SwipeBackThreshold\"];\n  var transformOrigin = app.rtl ? 'right center' : 'left center';\n  var transformOriginTitleLarge = app.rtl ? 'calc(100% - var(--f7-navbar-large-title-padding-left) - var(--f7-safe-area-left)) center' : 'calc(var(--f7-navbar-large-title-padding-left) + var(--f7-safe-area-left)) center';\n\n  function animatableNavElements() {\n    var els = [];\n    var inverter = app.rtl ? -1 : 1;\n    var currentNavIsTransparent = $currentNavbarEl.hasClass('navbar-transparent') && !$currentNavbarEl.hasClass('navbar-large') && !$currentNavbarEl.hasClass('navbar-transparent-visible');\n    var currentNavIsLarge = $currentNavbarEl.hasClass('navbar-large');\n    var currentNavIsCollapsed = $currentNavbarEl.hasClass('navbar-large-collapsed');\n    var currentNavIsLargeTransparent = $currentNavbarEl.hasClass('navbar-large-transparent') || $currentNavbarEl.hasClass('navbar-large') && $currentNavbarEl.hasClass('navbar-transparent');\n    var previousNavIsTransparent = $previousNavbarEl.hasClass('navbar-transparent') && !$previousNavbarEl.hasClass('navbar-large') && !$previousNavbarEl.hasClass('navbar-transparent-visible');\n    var previousNavIsLarge = $previousNavbarEl.hasClass('navbar-large');\n    var previousNavIsCollapsed = $previousNavbarEl.hasClass('navbar-large-collapsed');\n    var previousNavIsLargeTransparent = $previousNavbarEl.hasClass('navbar-large-transparent') || $previousNavbarEl.hasClass('navbar-large') && $previousNavbarEl.hasClass('navbar-transparent');\n    var fromLarge = currentNavIsLarge && !currentNavIsCollapsed;\n    var toLarge = previousNavIsLarge && !previousNavIsCollapsed;\n    var $currentNavElements = $currentNavbarEl.find('.left, .title, .right, .subnavbar, .fading, .title-large, .navbar-bg');\n    var $previousNavElements = $previousNavbarEl.find('.left, .title, .right, .subnavbar, .fading, .title-large, .navbar-bg');\n    var activeNavBackIconText;\n    var previousNavBackIconText;\n\n    if (params.iosAnimateNavbarBackIcon) {\n      if ($currentNavbarEl.hasClass('sliding') || $currentNavbarEl.find('.navbar-inner.sliding').length) {\n        activeNavBackIconText = $currentNavbarEl.find('.left').find('.back .icon + span').eq(0);\n      } else {\n        activeNavBackIconText = $currentNavbarEl.find('.left.sliding').find('.back .icon + span').eq(0);\n      }\n\n      if ($previousNavbarEl.hasClass('sliding') || $previousNavbarEl.find('.navbar-inner.sliding').length) {\n        previousNavBackIconText = $previousNavbarEl.find('.left').find('.back .icon + span').eq(0);\n      } else {\n        previousNavBackIconText = $previousNavbarEl.find('.left.sliding').find('.back .icon + span').eq(0);\n      }\n\n      if (activeNavBackIconText.length) {\n        $previousNavElements.each(function (el) {\n          if (!$(el).hasClass('title')) return;\n          el.f7NavbarLeftOffset += activeNavBackIconText.prev('.icon')[0].offsetWidth;\n        });\n      }\n    }\n\n    $currentNavElements.each(function (navEl) {\n      var $navEl = $(navEl);\n      var isSubnavbar = $navEl.hasClass('subnavbar');\n      var isLeft = $navEl.hasClass('left');\n      var isTitle = $navEl.hasClass('title');\n      var isBg = $navEl.hasClass('navbar-bg');\n      if ((isTitle || isBg) && currentNavIsTransparent) return;\n      if (!fromLarge && $navEl.hasClass('.title-large')) return;\n      var el = {\n        el: navEl\n      };\n\n      if (fromLarge) {\n        if (isTitle) return;\n\n        if ($navEl.hasClass('title-large')) {\n          if (els.indexOf(el) < 0) els.push(el);\n          el.overflow = 'visible';\n          $navEl.find('.title-large-text').each(function (subNavEl) {\n            els.push({\n              el: subNavEl,\n              transform: function transform(progress) {\n                return \"translateX(\" + progress * 100 * inverter + \"%)\";\n              }\n            });\n          });\n          return;\n        }\n      }\n\n      if (toLarge) {\n        if (!fromLarge) {\n          if ($navEl.hasClass('title-large')) {\n            if (els.indexOf(el) < 0) els.push(el);\n            el.opacity = 0;\n          }\n        }\n\n        if (isLeft) {\n          if (els.indexOf(el) < 0) els.push(el);\n\n          el.opacity = function (progress) {\n            return 1 - Math.pow(progress, 0.33);\n          };\n\n          $navEl.find('.back span').each(function (subNavEl) {\n            els.push({\n              el: subNavEl,\n              'transform-origin': transformOrigin,\n              transform: function transform(progress) {\n                return \"translateX(calc(\" + progress + \" * (var(--f7-navbarTitleLargeOffset) - var(--f7-navbarLeftTextOffset)))) translateY(calc(\" + progress + \" * (var(--f7-navbar-large-title-height) - var(--f7-navbar-large-title-padding-vertical) / 2))) scale(\" + (1 + 1 * progress) + \")\";\n              }\n            });\n          });\n          return;\n        }\n      }\n\n      if (isBg) {\n        if (els.indexOf(el) < 0) els.push(el);\n\n        if (!fromLarge && !toLarge) {\n          if (currentNavIsCollapsed) {\n            if (currentNavIsLargeTransparent) {\n              el.className = 'ios-swipeback-navbar-bg-large';\n            }\n\n            el.transform = function (progress) {\n              return \"translateX(\" + 100 * progress * inverter + \"%) translateY(calc(-1 * var(--f7-navbar-large-title-height)))\";\n            };\n          } else {\n            el.transform = function (progress) {\n              return \"translateX(\" + 100 * progress * inverter + \"%)\";\n            };\n          }\n        }\n\n        if (!fromLarge && toLarge) {\n          el.className = 'ios-swipeback-navbar-bg-large';\n\n          el.transform = function (progress) {\n            return \"translateX(\" + 100 * progress * inverter + \"%) translateY(calc(-1 * \" + (1 - progress) + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        if (fromLarge && toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + 100 * progress * inverter + \"%)\";\n          };\n        }\n\n        if (fromLarge && !toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + 100 * progress * inverter + \"%) translateY(calc(-\" + progress + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        return;\n      }\n\n      if ($navEl.hasClass('title-large')) return;\n      var isSliding = $navEl.hasClass('sliding') || $navEl.parents('.navbar-inner.sliding').length;\n      if (els.indexOf(el) < 0) els.push(el);\n\n      if (!isSubnavbar || isSubnavbar && !isSliding) {\n        el.opacity = function (progress) {\n          return 1 - Math.pow(progress, 0.33);\n        };\n      }\n\n      if (isSliding) {\n        var transformTarget = el;\n\n        if (isLeft && activeNavBackIconText.length && params.iosAnimateNavbarBackIcon) {\n          var textEl = {\n            el: activeNavBackIconText[0]\n          };\n          transformTarget = textEl;\n          els.push(textEl);\n        }\n\n        transformTarget.transform = function (progress) {\n          var activeNavTranslate = progress * transformTarget.el.f7NavbarRightOffset;\n          if (device.pixelRatio === 1) activeNavTranslate = Math.round(activeNavTranslate);\n\n          if (isSubnavbar && currentNavIsLarge) {\n            return \"translate3d(\" + activeNavTranslate + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\";\n          }\n\n          return \"translate3d(\" + activeNavTranslate + \"px,0,0)\";\n        };\n      }\n    });\n    $previousNavElements.each(function (navEl) {\n      var $navEl = $(navEl);\n      var isSubnavbar = $navEl.hasClass('subnavbar');\n      var isLeft = $navEl.hasClass('left');\n      var isTitle = $navEl.hasClass('title');\n      var isBg = $navEl.hasClass('navbar-bg');\n      if ((isTitle || isBg) && previousNavIsTransparent) return;\n      var el = {\n        el: navEl\n      };\n\n      if (toLarge) {\n        if (isTitle) return;\n        if (els.indexOf(el) < 0) els.push(el);\n\n        if ($navEl.hasClass('title-large')) {\n          el.opacity = 1;\n          el.overflow = 'visible';\n          $navEl.find('.title-large-text').each(function (subNavEl) {\n            els.push({\n              el: subNavEl,\n              'transform-origin': transformOriginTitleLarge,\n              opacity: function opacity(progress) {\n                return Math.pow(progress, 3);\n              },\n              transform: function transform(progress) {\n                return \"translateX(calc(\" + (1 - progress) + \" * (var(--f7-navbarLeftTextOffset) - var(--f7-navbarTitleLargeOffset)))) translateY(calc(\" + (progress - 1) + \" * var(--f7-navbar-large-title-height) + \" + (1 - progress) + \" * var(--f7-navbar-large-title-padding-vertical))) scale(\" + (0.5 + progress * 0.5) + \")\";\n              }\n            });\n          });\n          return;\n        }\n      }\n\n      if (isBg) {\n        if (els.indexOf(el) < 0) els.push(el);\n\n        if (!fromLarge && !toLarge) {\n          if (previousNavIsCollapsed) {\n            if (previousNavIsLargeTransparent) {\n              el.className = 'ios-swipeback-navbar-bg-large';\n            }\n\n            el.transform = function (progress) {\n              return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%) translateY(calc(-1 * var(--f7-navbar-large-title-height)))\";\n            };\n          } else {\n            el.transform = function (progress) {\n              return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%)\";\n            };\n          }\n        }\n\n        if (!fromLarge && toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%) translateY(calc(-1 * \" + (1 - progress) + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        if (fromLarge && !toLarge) {\n          el.className = 'ios-swipeback-navbar-bg-large';\n\n          el.transform = function (progress) {\n            return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%) translateY(calc(-\" + progress + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        if (fromLarge && toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%)\";\n          };\n        }\n\n        return;\n      }\n\n      if ($navEl.hasClass('title-large')) return;\n      var isSliding = $navEl.hasClass('sliding') || $previousNavbarEl.children('.navbar-inner.sliding').length;\n      if (els.indexOf(el) < 0) els.push(el);\n\n      if (!isSubnavbar || isSubnavbar && !isSliding) {\n        el.opacity = function (progress) {\n          return Math.pow(progress, 3);\n        };\n      }\n\n      if (isSliding) {\n        var transformTarget = el;\n\n        if (isLeft && previousNavBackIconText.length && params.iosAnimateNavbarBackIcon) {\n          var textEl = {\n            el: previousNavBackIconText[0]\n          };\n          transformTarget = textEl;\n          els.push(textEl);\n        }\n\n        transformTarget.transform = function (progress) {\n          var previousNavTranslate = transformTarget.el.f7NavbarLeftOffset * (1 - progress);\n          if (device.pixelRatio === 1) previousNavTranslate = Math.round(previousNavTranslate);\n\n          if (isSubnavbar && previousNavIsLarge) {\n            return \"translate3d(\" + previousNavTranslate + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\";\n          }\n\n          return \"translate3d(\" + previousNavTranslate + \"px,0,0)\";\n        };\n      }\n    });\n    return els;\n  }\n\n  function setAnimatableNavElements(_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        progress = _ref.progress,\n        reset = _ref.reset,\n        transition = _ref.transition,\n        reflow = _ref.reflow;\n\n    var styles = ['overflow', 'transform', 'transform-origin', 'opacity'];\n\n    if (transition === true || transition === false) {\n      for (var i = 0; i < animatableNavEls.length; i += 1) {\n        var el = animatableNavEls[i];\n\n        if (el && el.el) {\n          if (transition === true) el.el.classList.add('navbar-page-transitioning');\n          if (transition === false) el.el.classList.remove('navbar-page-transitioning');\n        }\n      }\n    }\n\n    if (reflow && animatableNavEls.length && animatableNavEls[0] && animatableNavEls[0].el) {\n      // eslint-disable-next-line\n      animatableNavEls[0].el._clientLeft = animatableNavEls[0].el.clientLeft;\n    }\n\n    for (var _i = 0; _i < animatableNavEls.length; _i += 1) {\n      var _el = animatableNavEls[_i];\n\n      if (_el && _el.el) {\n        if (_el.className && !_el.classNameSet && !reset) {\n          _el.el.classList.add(_el.className);\n\n          _el.classNameSet = true;\n        }\n\n        if (_el.className && reset) {\n          _el.el.classList.remove(_el.className);\n        }\n\n        for (var j = 0; j < styles.length; j += 1) {\n          var styleProp = styles[j];\n\n          if (_el[styleProp]) {\n            if (reset) {\n              _el.el.style[styleProp] = '';\n            } else if (typeof _el[styleProp] === 'function') {\n              _el.el.style[styleProp] = _el[styleProp](progress);\n            } else {\n              _el.el.style[styleProp] = _el[styleProp];\n            }\n          }\n        }\n      }\n    }\n  }\n\n  function handleTouchStart(e) {\n    var swipeBackEnabled = params[app.theme + \"SwipeBack\"];\n    if (!allowViewTouchMove || !swipeBackEnabled || isTouched || app.swipeout && app.swipeout.el || !router.allowPageChange) return;\n    if ($(e.target).closest('.range-slider, .calendar-months').length > 0) return;\n    if ($(e.target).closest('.page-master, .page-master-detail').length > 0 && params.masterDetailBreakpoint > 0 && app.width >= params.masterDetailBreakpoint) return;\n    isMoved = false;\n    isTouched = true;\n    isScrolling = undefined;\n    touchesStart.x = e.type === 'touchstart' ? e.targetTouches[0].pageX : e.pageX;\n    touchesStart.y = e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY;\n    touchStartTime = now();\n    dynamicNavbar = router.dynamicNavbar;\n  }\n\n  function handleTouchMove(e) {\n    if (!isTouched) return;\n    var pageX = e.type === 'touchmove' ? e.targetTouches[0].pageX : e.pageX;\n    var pageY = e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY;\n\n    if (typeof isScrolling === 'undefined') {\n      isScrolling = !!(isScrolling || Math.abs(pageY - touchesStart.y) > Math.abs(pageX - touchesStart.x)) || pageX < touchesStart.x && !app.rtl || pageX > touchesStart.x && app.rtl;\n    }\n\n    if (isScrolling || e.f7PreventSwipeBack || app.preventSwipeBack) {\n      isTouched = false;\n      return;\n    }\n\n    if (!isMoved) {\n      // Calc values during first move fired\n      var cancel = false;\n      var target = $(e.target);\n      var swipeout = target.closest('.swipeout');\n\n      if (swipeout.length > 0) {\n        if (!app.rtl && swipeout.find('.swipeout-actions-left').length > 0) cancel = true;\n        if (app.rtl && swipeout.find('.swipeout-actions-right').length > 0) cancel = true;\n      }\n\n      $currentPageEl = target.closest('.page');\n      if ($currentPageEl.hasClass('no-swipeback') || target.closest('.no-swipeback, .card-opened').length > 0) cancel = true;\n      $previousPageEl = $el.find('.page-previous:not(.stacked)');\n\n      if ($previousPageEl.length > 1) {\n        $previousPageEl = $previousPageEl.eq($previousPageEl.length - 1);\n      }\n\n      var notFromBorder = touchesStart.x - $el.offset().left > paramsSwipeBackActiveArea;\n      viewContainerWidth = $el.width();\n\n      if (app.rtl) {\n        notFromBorder = touchesStart.x < $el.offset().left - $el[0].scrollLeft + (viewContainerWidth - paramsSwipeBackActiveArea);\n      } else {\n        notFromBorder = touchesStart.x - $el.offset().left > paramsSwipeBackActiveArea;\n      }\n\n      if (notFromBorder) cancel = true;\n      if ($previousPageEl.length === 0 || $currentPageEl.length === 0) cancel = true;\n\n      if (cancel) {\n        isTouched = false;\n        return;\n      }\n\n      if (paramsSwipeBackAnimateShadow) {\n        $pageShadowEl = $currentPageEl.find('.page-shadow-effect');\n\n        if ($pageShadowEl.length === 0) {\n          $pageShadowEl = $('<div class=\"page-shadow-effect\"></div>');\n          $currentPageEl.append($pageShadowEl);\n        }\n      }\n\n      if (paramsSwipeBackAnimateOpacity) {\n        $pageOpacityEl = $previousPageEl.find('.page-opacity-effect');\n\n        if ($pageOpacityEl.length === 0) {\n          $pageOpacityEl = $('<div class=\"page-opacity-effect\"></div>');\n          $previousPageEl.append($pageOpacityEl);\n        }\n      }\n\n      if (dynamicNavbar) {\n        $currentNavbarEl = $navbarsEl.find('.navbar-current:not(.stacked)');\n        $previousNavbarEl = $navbarsEl.find('.navbar-previous:not(.stacked)');\n\n        if ($previousNavbarEl.length > 1) {\n          $previousNavbarEl = $previousNavbarEl.eq($previousNavbarEl.length - 1);\n        }\n\n        animatableNavEls = animatableNavElements($previousNavbarEl, $currentNavbarEl);\n      } // Close/Hide Any Picker\n\n\n      if ($('.sheet.modal-in').length > 0 && app.sheet) {\n        app.sheet.close($('.sheet.modal-in'));\n      }\n    }\n\n    e.f7PreventSwipePanel = true;\n    isMoved = true;\n    app.preventSwipePanelBySwipeBack = true;\n    e.preventDefault(); // RTL inverter\n\n    var inverter = app.rtl ? -1 : 1; // Touches diff\n\n    touchesDiff = (pageX - touchesStart.x - paramsSwipeBackThreshold) * inverter;\n    if (touchesDiff < 0) touchesDiff = 0;\n    var percentage = Math.min(Math.max(touchesDiff / viewContainerWidth, 0), 1); // Swipe Back Callback\n\n    var callbackData = {\n      percentage: percentage,\n      progress: percentage,\n      currentPageEl: $currentPageEl[0],\n      previousPageEl: $previousPageEl[0],\n      currentNavbarEl: $currentNavbarEl[0],\n      previousNavbarEl: $previousNavbarEl[0]\n    };\n    $el.trigger('swipeback:move', callbackData);\n    router.emit('swipebackMove', callbackData); // Transform pages\n\n    var currentPageTranslate = touchesDiff * inverter;\n    var previousPageTranslate = (touchesDiff / 5 - viewContainerWidth / 5) * inverter;\n\n    if (!app.rtl) {\n      currentPageTranslate = Math.min(currentPageTranslate, viewContainerWidth);\n      previousPageTranslate = Math.min(previousPageTranslate, 0);\n    } else {\n      currentPageTranslate = Math.max(currentPageTranslate, -viewContainerWidth);\n      previousPageTranslate = Math.max(previousPageTranslate, 0);\n    }\n\n    if (device.pixelRatio === 1) {\n      currentPageTranslate = Math.round(currentPageTranslate);\n      previousPageTranslate = Math.round(previousPageTranslate);\n    }\n\n    router.swipeBackActive = true;\n    $([$currentPageEl[0], $previousPageEl[0]]).addClass('page-swipeback-active');\n    $currentPageEl.transform(\"translate3d(\" + currentPageTranslate + \"px,0,0)\");\n    if (paramsSwipeBackAnimateShadow) $pageShadowEl[0].style.opacity = 1 - 1 * percentage;\n\n    if (app.theme === 'ios') {\n      $previousPageEl.transform(\"translate3d(\" + previousPageTranslate + \"px,0,0)\");\n    }\n\n    if (paramsSwipeBackAnimateOpacity) $pageOpacityEl[0].style.opacity = 1 - 1 * percentage; // Dynamic Navbars Animation\n\n    if (!dynamicNavbar) return;\n    setAnimatableNavElements({\n      progress: percentage\n    });\n  }\n\n  function handleTouchEnd() {\n    app.preventSwipePanelBySwipeBack = false;\n\n    if (!isTouched || !isMoved) {\n      isTouched = false;\n      isMoved = false;\n      return;\n    }\n\n    isTouched = false;\n    isMoved = false;\n    router.swipeBackActive = false;\n    var $pages = $([$currentPageEl[0], $previousPageEl[0]]);\n    $pages.removeClass('page-swipeback-active');\n\n    if (touchesDiff === 0) {\n      $pages.transform('');\n      if ($pageShadowEl && $pageShadowEl.length > 0) $pageShadowEl.remove();\n      if ($pageOpacityEl && $pageOpacityEl.length > 0) $pageOpacityEl.remove();\n\n      if (dynamicNavbar) {\n        setAnimatableNavElements({\n          reset: true\n        });\n      }\n\n      return;\n    }\n\n    var timeDiff = now() - touchStartTime;\n    var pageChanged = false; // Swipe back to previous page\n\n    if (timeDiff < 300 && touchesDiff > 10 || timeDiff >= 300 && touchesDiff > viewContainerWidth / 2) {\n      $currentPageEl.removeClass('page-current').addClass(\"page-next\" + (app.theme !== 'ios' ? ' page-next-on-right' : ''));\n      $previousPageEl.removeClass('page-previous').addClass('page-current').removeAttr('aria-hidden');\n      if ($pageShadowEl) $pageShadowEl[0].style.opacity = '';\n      if ($pageOpacityEl) $pageOpacityEl[0].style.opacity = '';\n\n      if (dynamicNavbar) {\n        router.setNavbarPosition($currentNavbarEl, 'next');\n        router.setNavbarPosition($previousNavbarEl, 'current', false);\n      }\n\n      pageChanged = true;\n    } // Reset custom styles\n    // Add transitioning class for transition-duration\n\n\n    $pages.addClass('page-transitioning page-transitioning-swipeback');\n\n    if (device.ios) {\n      // eslint-disable-next-line\n      $currentPageEl[0]._clientLeft = $currentPageEl[0].clientLeft;\n    }\n\n    $pages.transform('');\n\n    if (dynamicNavbar) {\n      setAnimatableNavElements({\n        progress: pageChanged ? 1 : 0,\n        transition: true,\n        reflow: !!device.ios\n      });\n    }\n\n    allowViewTouchMove = false;\n    router.allowPageChange = false; // Swipe Back Callback\n\n    var callbackData = {\n      currentPageEl: $currentPageEl[0],\n      previousPageEl: $previousPageEl[0],\n      currentNavbarEl: $currentNavbarEl[0],\n      previousNavbarEl: $previousNavbarEl[0]\n    };\n\n    if (pageChanged) {\n      // Update Route\n      router.currentRoute = $previousPageEl[0].f7Page.route;\n      router.currentPage = $previousPageEl[0]; // Page before animation callback\n\n      router.pageCallback('beforeOut', $currentPageEl, $currentNavbarEl, 'current', 'next', {\n        route: $currentPageEl[0].f7Page.route,\n        swipeBack: true\n      });\n      router.pageCallback('beforeIn', $previousPageEl, $previousNavbarEl, 'previous', 'current', {\n        route: $previousPageEl[0].f7Page.route,\n        swipeBack: true\n      }, $currentPageEl[0]);\n      $el.trigger('swipeback:beforechange', callbackData);\n      router.emit('swipebackBeforeChange', callbackData);\n    } else {\n      $el.trigger('swipeback:beforereset', callbackData);\n      router.emit('swipebackBeforeReset', callbackData);\n    }\n\n    $currentPageEl.transitionEnd(function () {\n      $pages.removeClass('page-transitioning page-transitioning-swipeback');\n\n      if (dynamicNavbar) {\n        setAnimatableNavElements({\n          reset: true,\n          transition: false\n        });\n      }\n\n      allowViewTouchMove = true;\n      router.allowPageChange = true;\n\n      if (pageChanged) {\n        // Update History\n        if (router.history.length === 1) {\n          router.history.unshift(router.url);\n        }\n\n        router.history.pop();\n        router.saveHistory(); // Update push state\n\n        if (params.browserHistory) {\n          History.back();\n        } // Page after animation callback\n\n\n        router.pageCallback('afterOut', $currentPageEl, $currentNavbarEl, 'current', 'next', {\n          route: $currentPageEl[0].f7Page.route,\n          swipeBack: true\n        });\n        router.pageCallback('afterIn', $previousPageEl, $previousNavbarEl, 'previous', 'current', {\n          route: $previousPageEl[0].f7Page.route,\n          swipeBack: true\n        }); // Remove Old Page\n\n        if (params.stackPages && router.initialPages.indexOf($currentPageEl[0]) >= 0) {\n          $currentPageEl.addClass('stacked');\n\n          if (dynamicNavbar) {\n            $currentNavbarEl.addClass('stacked');\n          }\n        } else {\n          router.pageCallback('beforeRemove', $currentPageEl, $currentNavbarEl, 'next', {\n            swipeBack: true\n          });\n          router.removePage($currentPageEl);\n\n          if (dynamicNavbar) {\n            router.removeNavbar($currentNavbarEl);\n          }\n        }\n\n        $el.trigger('swipeback:afterchange', callbackData);\n        router.emit('swipebackAfterChange', callbackData);\n        router.emit('routeChanged', router.currentRoute, router.previousRoute, router);\n\n        if (params.preloadPreviousPage) {\n          router.back(router.history[router.history.length - 2], {\n            preload: true\n          });\n        }\n      } else {\n        $el.trigger('swipeback:afterreset', callbackData);\n        router.emit('swipebackAfterReset', callbackData);\n      }\n\n      if ($pageShadowEl && $pageShadowEl.length > 0) $pageShadowEl.remove();\n      if ($pageOpacityEl && $pageOpacityEl.length > 0) $pageOpacityEl.remove();\n    });\n  }\n\n  function attachEvents() {\n    var passiveListener = app.touchEvents.start === 'touchstart' && support.passiveListener ? {\n      passive: true,\n      capture: false\n    } : false;\n    $el.on(app.touchEvents.start, handleTouchStart, passiveListener);\n    app.on('touchmove:active', handleTouchMove);\n    app.on('touchend:passive', handleTouchEnd);\n  }\n\n  function detachEvents() {\n    var passiveListener = app.touchEvents.start === 'touchstart' && support.passiveListener ? {\n      passive: true,\n      capture: false\n    } : false;\n    $el.off(app.touchEvents.start, handleTouchStart, passiveListener);\n    app.off('touchmove:active', handleTouchMove);\n    app.off('touchend:passive', handleTouchEnd);\n  }\n\n  attachEvents();\n  router.on('routerDestroy', detachEvents);\n}\n\nexport default SwipeBack;","map":{"version":3,"sources":["E:/Programming/React/rashiApp/node_modules/framework7/esm/modules/router/swipe-back.js"],"names":["$","History","getSupport","getDevice","now","SwipeBack","r","router","$el","$navbarsEl","app","params","support","device","isTouched","isMoved","touchesStart","isScrolling","$currentPageEl","$previousPageEl","viewContainerWidth","touchesDiff","allowViewTouchMove","touchStartTime","$currentNavbarEl","$previousNavbarEl","dynamicNavbar","$pageShadowEl","$pageOpacityEl","animatableNavEls","paramsSwipeBackAnimateShadow","theme","paramsSwipeBackAnimateOpacity","paramsSwipeBackActiveArea","paramsSwipeBackThreshold","transformOrigin","rtl","transformOriginTitleLarge","animatableNavElements","els","inverter","currentNavIsTransparent","hasClass","currentNavIsLarge","currentNavIsCollapsed","currentNavIsLargeTransparent","previousNavIsTransparent","previousNavIsLarge","previousNavIsCollapsed","previousNavIsLargeTransparent","fromLarge","toLarge","$currentNavElements","find","$previousNavElements","activeNavBackIconText","previousNavBackIconText","iosAnimateNavbarBackIcon","length","eq","each","el","f7NavbarLeftOffset","prev","offsetWidth","navEl","$navEl","isSubnavbar","isLeft","isTitle","isBg","indexOf","push","overflow","subNavEl","transform","progress","opacity","Math","pow","className","isSliding","parents","transformTarget","textEl","activeNavTranslate","f7NavbarRightOffset","pixelRatio","round","children","previousNavTranslate","setAnimatableNavElements","_temp","_ref","reset","transition","reflow","styles","i","classList","add","remove","_clientLeft","clientLeft","_i","_el","classNameSet","j","styleProp","style","handleTouchStart","e","swipeBackEnabled","swipeout","allowPageChange","target","closest","masterDetailBreakpoint","width","undefined","x","type","targetTouches","pageX","y","pageY","handleTouchMove","abs","f7PreventSwipeBack","preventSwipeBack","cancel","notFromBorder","offset","left","scrollLeft","append","sheet","close","f7PreventSwipePanel","preventSwipePanelBySwipeBack","preventDefault","percentage","min","max","callbackData","currentPageEl","previousPageEl","currentNavbarEl","previousNavbarEl","trigger","emit","currentPageTranslate","previousPageTranslate","swipeBackActive","addClass","handleTouchEnd","$pages","removeClass","timeDiff","pageChanged","removeAttr","setNavbarPosition","ios","currentRoute","f7Page","route","currentPage","pageCallback","swipeBack","transitionEnd","history","unshift","url","pop","saveHistory","browserHistory","back","stackPages","initialPages","removePage","removeNavbar","previousRoute","preloadPreviousPage","preload","attachEvents","passiveListener","touchEvents","start","passive","capture","on","detachEvents","off"],"mappings":"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","sourcesContent":["import $ from '../../shared/dom7';\nimport History from '../../shared/history';\nimport { getSupport } from '../../shared/get-support';\nimport { getDevice } from '../../shared/get-device';\nimport { now } from '../../shared/utils';\n\nfunction SwipeBack(r) {\n  var router = r;\n  var $el = router.$el,\n      $navbarsEl = router.$navbarsEl,\n      app = router.app,\n      params = router.params;\n  var support = getSupport();\n  var device = getDevice();\n  var isTouched = false;\n  var isMoved = false;\n  var touchesStart = {};\n  var isScrolling;\n  var $currentPageEl = [];\n  var $previousPageEl = [];\n  var viewContainerWidth;\n  var touchesDiff;\n  var allowViewTouchMove = true;\n  var touchStartTime;\n  var $currentNavbarEl = [];\n  var $previousNavbarEl = [];\n  var dynamicNavbar;\n  var $pageShadowEl;\n  var $pageOpacityEl;\n  var animatableNavEls;\n  var paramsSwipeBackAnimateShadow = params[app.theme + \"SwipeBackAnimateShadow\"];\n  var paramsSwipeBackAnimateOpacity = params[app.theme + \"SwipeBackAnimateOpacity\"];\n  var paramsSwipeBackActiveArea = params[app.theme + \"SwipeBackActiveArea\"];\n  var paramsSwipeBackThreshold = params[app.theme + \"SwipeBackThreshold\"];\n  var transformOrigin = app.rtl ? 'right center' : 'left center';\n  var transformOriginTitleLarge = app.rtl ? 'calc(100% - var(--f7-navbar-large-title-padding-left) - var(--f7-safe-area-left)) center' : 'calc(var(--f7-navbar-large-title-padding-left) + var(--f7-safe-area-left)) center';\n\n  function animatableNavElements() {\n    var els = [];\n    var inverter = app.rtl ? -1 : 1;\n    var currentNavIsTransparent = $currentNavbarEl.hasClass('navbar-transparent') && !$currentNavbarEl.hasClass('navbar-large') && !$currentNavbarEl.hasClass('navbar-transparent-visible');\n    var currentNavIsLarge = $currentNavbarEl.hasClass('navbar-large');\n    var currentNavIsCollapsed = $currentNavbarEl.hasClass('navbar-large-collapsed');\n    var currentNavIsLargeTransparent = $currentNavbarEl.hasClass('navbar-large-transparent') || $currentNavbarEl.hasClass('navbar-large') && $currentNavbarEl.hasClass('navbar-transparent');\n    var previousNavIsTransparent = $previousNavbarEl.hasClass('navbar-transparent') && !$previousNavbarEl.hasClass('navbar-large') && !$previousNavbarEl.hasClass('navbar-transparent-visible');\n    var previousNavIsLarge = $previousNavbarEl.hasClass('navbar-large');\n    var previousNavIsCollapsed = $previousNavbarEl.hasClass('navbar-large-collapsed');\n    var previousNavIsLargeTransparent = $previousNavbarEl.hasClass('navbar-large-transparent') || $previousNavbarEl.hasClass('navbar-large') && $previousNavbarEl.hasClass('navbar-transparent');\n    var fromLarge = currentNavIsLarge && !currentNavIsCollapsed;\n    var toLarge = previousNavIsLarge && !previousNavIsCollapsed;\n    var $currentNavElements = $currentNavbarEl.find('.left, .title, .right, .subnavbar, .fading, .title-large, .navbar-bg');\n    var $previousNavElements = $previousNavbarEl.find('.left, .title, .right, .subnavbar, .fading, .title-large, .navbar-bg');\n    var activeNavBackIconText;\n    var previousNavBackIconText;\n\n    if (params.iosAnimateNavbarBackIcon) {\n      if ($currentNavbarEl.hasClass('sliding') || $currentNavbarEl.find('.navbar-inner.sliding').length) {\n        activeNavBackIconText = $currentNavbarEl.find('.left').find('.back .icon + span').eq(0);\n      } else {\n        activeNavBackIconText = $currentNavbarEl.find('.left.sliding').find('.back .icon + span').eq(0);\n      }\n\n      if ($previousNavbarEl.hasClass('sliding') || $previousNavbarEl.find('.navbar-inner.sliding').length) {\n        previousNavBackIconText = $previousNavbarEl.find('.left').find('.back .icon + span').eq(0);\n      } else {\n        previousNavBackIconText = $previousNavbarEl.find('.left.sliding').find('.back .icon + span').eq(0);\n      }\n\n      if (activeNavBackIconText.length) {\n        $previousNavElements.each(function (el) {\n          if (!$(el).hasClass('title')) return;\n          el.f7NavbarLeftOffset += activeNavBackIconText.prev('.icon')[0].offsetWidth;\n        });\n      }\n    }\n\n    $currentNavElements.each(function (navEl) {\n      var $navEl = $(navEl);\n      var isSubnavbar = $navEl.hasClass('subnavbar');\n      var isLeft = $navEl.hasClass('left');\n      var isTitle = $navEl.hasClass('title');\n      var isBg = $navEl.hasClass('navbar-bg');\n      if ((isTitle || isBg) && currentNavIsTransparent) return;\n      if (!fromLarge && $navEl.hasClass('.title-large')) return;\n      var el = {\n        el: navEl\n      };\n\n      if (fromLarge) {\n        if (isTitle) return;\n\n        if ($navEl.hasClass('title-large')) {\n          if (els.indexOf(el) < 0) els.push(el);\n          el.overflow = 'visible';\n          $navEl.find('.title-large-text').each(function (subNavEl) {\n            els.push({\n              el: subNavEl,\n              transform: function transform(progress) {\n                return \"translateX(\" + progress * 100 * inverter + \"%)\";\n              }\n            });\n          });\n          return;\n        }\n      }\n\n      if (toLarge) {\n        if (!fromLarge) {\n          if ($navEl.hasClass('title-large')) {\n            if (els.indexOf(el) < 0) els.push(el);\n            el.opacity = 0;\n          }\n        }\n\n        if (isLeft) {\n          if (els.indexOf(el) < 0) els.push(el);\n\n          el.opacity = function (progress) {\n            return 1 - Math.pow(progress, 0.33);\n          };\n\n          $navEl.find('.back span').each(function (subNavEl) {\n            els.push({\n              el: subNavEl,\n              'transform-origin': transformOrigin,\n              transform: function transform(progress) {\n                return \"translateX(calc(\" + progress + \" * (var(--f7-navbarTitleLargeOffset) - var(--f7-navbarLeftTextOffset)))) translateY(calc(\" + progress + \" * (var(--f7-navbar-large-title-height) - var(--f7-navbar-large-title-padding-vertical) / 2))) scale(\" + (1 + 1 * progress) + \")\";\n              }\n            });\n          });\n          return;\n        }\n      }\n\n      if (isBg) {\n        if (els.indexOf(el) < 0) els.push(el);\n\n        if (!fromLarge && !toLarge) {\n          if (currentNavIsCollapsed) {\n            if (currentNavIsLargeTransparent) {\n              el.className = 'ios-swipeback-navbar-bg-large';\n            }\n\n            el.transform = function (progress) {\n              return \"translateX(\" + 100 * progress * inverter + \"%) translateY(calc(-1 * var(--f7-navbar-large-title-height)))\";\n            };\n          } else {\n            el.transform = function (progress) {\n              return \"translateX(\" + 100 * progress * inverter + \"%)\";\n            };\n          }\n        }\n\n        if (!fromLarge && toLarge) {\n          el.className = 'ios-swipeback-navbar-bg-large';\n\n          el.transform = function (progress) {\n            return \"translateX(\" + 100 * progress * inverter + \"%) translateY(calc(-1 * \" + (1 - progress) + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        if (fromLarge && toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + 100 * progress * inverter + \"%)\";\n          };\n        }\n\n        if (fromLarge && !toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + 100 * progress * inverter + \"%) translateY(calc(-\" + progress + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        return;\n      }\n\n      if ($navEl.hasClass('title-large')) return;\n      var isSliding = $navEl.hasClass('sliding') || $navEl.parents('.navbar-inner.sliding').length;\n      if (els.indexOf(el) < 0) els.push(el);\n\n      if (!isSubnavbar || isSubnavbar && !isSliding) {\n        el.opacity = function (progress) {\n          return 1 - Math.pow(progress, 0.33);\n        };\n      }\n\n      if (isSliding) {\n        var transformTarget = el;\n\n        if (isLeft && activeNavBackIconText.length && params.iosAnimateNavbarBackIcon) {\n          var textEl = {\n            el: activeNavBackIconText[0]\n          };\n          transformTarget = textEl;\n          els.push(textEl);\n        }\n\n        transformTarget.transform = function (progress) {\n          var activeNavTranslate = progress * transformTarget.el.f7NavbarRightOffset;\n          if (device.pixelRatio === 1) activeNavTranslate = Math.round(activeNavTranslate);\n\n          if (isSubnavbar && currentNavIsLarge) {\n            return \"translate3d(\" + activeNavTranslate + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\";\n          }\n\n          return \"translate3d(\" + activeNavTranslate + \"px,0,0)\";\n        };\n      }\n    });\n    $previousNavElements.each(function (navEl) {\n      var $navEl = $(navEl);\n      var isSubnavbar = $navEl.hasClass('subnavbar');\n      var isLeft = $navEl.hasClass('left');\n      var isTitle = $navEl.hasClass('title');\n      var isBg = $navEl.hasClass('navbar-bg');\n      if ((isTitle || isBg) && previousNavIsTransparent) return;\n      var el = {\n        el: navEl\n      };\n\n      if (toLarge) {\n        if (isTitle) return;\n        if (els.indexOf(el) < 0) els.push(el);\n\n        if ($navEl.hasClass('title-large')) {\n          el.opacity = 1;\n          el.overflow = 'visible';\n          $navEl.find('.title-large-text').each(function (subNavEl) {\n            els.push({\n              el: subNavEl,\n              'transform-origin': transformOriginTitleLarge,\n              opacity: function opacity(progress) {\n                return Math.pow(progress, 3);\n              },\n              transform: function transform(progress) {\n                return \"translateX(calc(\" + (1 - progress) + \" * (var(--f7-navbarLeftTextOffset) - var(--f7-navbarTitleLargeOffset)))) translateY(calc(\" + (progress - 1) + \" * var(--f7-navbar-large-title-height) + \" + (1 - progress) + \" * var(--f7-navbar-large-title-padding-vertical))) scale(\" + (0.5 + progress * 0.5) + \")\";\n              }\n            });\n          });\n          return;\n        }\n      }\n\n      if (isBg) {\n        if (els.indexOf(el) < 0) els.push(el);\n\n        if (!fromLarge && !toLarge) {\n          if (previousNavIsCollapsed) {\n            if (previousNavIsLargeTransparent) {\n              el.className = 'ios-swipeback-navbar-bg-large';\n            }\n\n            el.transform = function (progress) {\n              return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%) translateY(calc(-1 * var(--f7-navbar-large-title-height)))\";\n            };\n          } else {\n            el.transform = function (progress) {\n              return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%)\";\n            };\n          }\n        }\n\n        if (!fromLarge && toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%) translateY(calc(-1 * \" + (1 - progress) + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        if (fromLarge && !toLarge) {\n          el.className = 'ios-swipeback-navbar-bg-large';\n\n          el.transform = function (progress) {\n            return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%) translateY(calc(-\" + progress + \" * var(--f7-navbar-large-title-height)))\";\n          };\n        }\n\n        if (fromLarge && toLarge) {\n          el.transform = function (progress) {\n            return \"translateX(\" + (-100 + 100 * progress) * inverter + \"%)\";\n          };\n        }\n\n        return;\n      }\n\n      if ($navEl.hasClass('title-large')) return;\n      var isSliding = $navEl.hasClass('sliding') || $previousNavbarEl.children('.navbar-inner.sliding').length;\n      if (els.indexOf(el) < 0) els.push(el);\n\n      if (!isSubnavbar || isSubnavbar && !isSliding) {\n        el.opacity = function (progress) {\n          return Math.pow(progress, 3);\n        };\n      }\n\n      if (isSliding) {\n        var transformTarget = el;\n\n        if (isLeft && previousNavBackIconText.length && params.iosAnimateNavbarBackIcon) {\n          var textEl = {\n            el: previousNavBackIconText[0]\n          };\n          transformTarget = textEl;\n          els.push(textEl);\n        }\n\n        transformTarget.transform = function (progress) {\n          var previousNavTranslate = transformTarget.el.f7NavbarLeftOffset * (1 - progress);\n          if (device.pixelRatio === 1) previousNavTranslate = Math.round(previousNavTranslate);\n\n          if (isSubnavbar && previousNavIsLarge) {\n            return \"translate3d(\" + previousNavTranslate + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\";\n          }\n\n          return \"translate3d(\" + previousNavTranslate + \"px,0,0)\";\n        };\n      }\n    });\n    return els;\n  }\n\n  function setAnimatableNavElements(_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        progress = _ref.progress,\n        reset = _ref.reset,\n        transition = _ref.transition,\n        reflow = _ref.reflow;\n\n    var styles = ['overflow', 'transform', 'transform-origin', 'opacity'];\n\n    if (transition === true || transition === false) {\n      for (var i = 0; i < animatableNavEls.length; i += 1) {\n        var el = animatableNavEls[i];\n\n        if (el && el.el) {\n          if (transition === true) el.el.classList.add('navbar-page-transitioning');\n          if (transition === false) el.el.classList.remove('navbar-page-transitioning');\n        }\n      }\n    }\n\n    if (reflow && animatableNavEls.length && animatableNavEls[0] && animatableNavEls[0].el) {\n      // eslint-disable-next-line\n      animatableNavEls[0].el._clientLeft = animatableNavEls[0].el.clientLeft;\n    }\n\n    for (var _i = 0; _i < animatableNavEls.length; _i += 1) {\n      var _el = animatableNavEls[_i];\n\n      if (_el && _el.el) {\n        if (_el.className && !_el.classNameSet && !reset) {\n          _el.el.classList.add(_el.className);\n\n          _el.classNameSet = true;\n        }\n\n        if (_el.className && reset) {\n          _el.el.classList.remove(_el.className);\n        }\n\n        for (var j = 0; j < styles.length; j += 1) {\n          var styleProp = styles[j];\n\n          if (_el[styleProp]) {\n            if (reset) {\n              _el.el.style[styleProp] = '';\n            } else if (typeof _el[styleProp] === 'function') {\n              _el.el.style[styleProp] = _el[styleProp](progress);\n            } else {\n              _el.el.style[styleProp] = _el[styleProp];\n            }\n          }\n        }\n      }\n    }\n  }\n\n  function handleTouchStart(e) {\n    var swipeBackEnabled = params[app.theme + \"SwipeBack\"];\n    if (!allowViewTouchMove || !swipeBackEnabled || isTouched || app.swipeout && app.swipeout.el || !router.allowPageChange) return;\n    if ($(e.target).closest('.range-slider, .calendar-months').length > 0) return;\n    if ($(e.target).closest('.page-master, .page-master-detail').length > 0 && params.masterDetailBreakpoint > 0 && app.width >= params.masterDetailBreakpoint) return;\n    isMoved = false;\n    isTouched = true;\n    isScrolling = undefined;\n    touchesStart.x = e.type === 'touchstart' ? e.targetTouches[0].pageX : e.pageX;\n    touchesStart.y = e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY;\n    touchStartTime = now();\n    dynamicNavbar = router.dynamicNavbar;\n  }\n\n  function handleTouchMove(e) {\n    if (!isTouched) return;\n    var pageX = e.type === 'touchmove' ? e.targetTouches[0].pageX : e.pageX;\n    var pageY = e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY;\n\n    if (typeof isScrolling === 'undefined') {\n      isScrolling = !!(isScrolling || Math.abs(pageY - touchesStart.y) > Math.abs(pageX - touchesStart.x)) || pageX < touchesStart.x && !app.rtl || pageX > touchesStart.x && app.rtl;\n    }\n\n    if (isScrolling || e.f7PreventSwipeBack || app.preventSwipeBack) {\n      isTouched = false;\n      return;\n    }\n\n    if (!isMoved) {\n      // Calc values during first move fired\n      var cancel = false;\n      var target = $(e.target);\n      var swipeout = target.closest('.swipeout');\n\n      if (swipeout.length > 0) {\n        if (!app.rtl && swipeout.find('.swipeout-actions-left').length > 0) cancel = true;\n        if (app.rtl && swipeout.find('.swipeout-actions-right').length > 0) cancel = true;\n      }\n\n      $currentPageEl = target.closest('.page');\n      if ($currentPageEl.hasClass('no-swipeback') || target.closest('.no-swipeback, .card-opened').length > 0) cancel = true;\n      $previousPageEl = $el.find('.page-previous:not(.stacked)');\n\n      if ($previousPageEl.length > 1) {\n        $previousPageEl = $previousPageEl.eq($previousPageEl.length - 1);\n      }\n\n      var notFromBorder = touchesStart.x - $el.offset().left > paramsSwipeBackActiveArea;\n      viewContainerWidth = $el.width();\n\n      if (app.rtl) {\n        notFromBorder = touchesStart.x < $el.offset().left - $el[0].scrollLeft + (viewContainerWidth - paramsSwipeBackActiveArea);\n      } else {\n        notFromBorder = touchesStart.x - $el.offset().left > paramsSwipeBackActiveArea;\n      }\n\n      if (notFromBorder) cancel = true;\n      if ($previousPageEl.length === 0 || $currentPageEl.length === 0) cancel = true;\n\n      if (cancel) {\n        isTouched = false;\n        return;\n      }\n\n      if (paramsSwipeBackAnimateShadow) {\n        $pageShadowEl = $currentPageEl.find('.page-shadow-effect');\n\n        if ($pageShadowEl.length === 0) {\n          $pageShadowEl = $('<div class=\"page-shadow-effect\"></div>');\n          $currentPageEl.append($pageShadowEl);\n        }\n      }\n\n      if (paramsSwipeBackAnimateOpacity) {\n        $pageOpacityEl = $previousPageEl.find('.page-opacity-effect');\n\n        if ($pageOpacityEl.length === 0) {\n          $pageOpacityEl = $('<div class=\"page-opacity-effect\"></div>');\n          $previousPageEl.append($pageOpacityEl);\n        }\n      }\n\n      if (dynamicNavbar) {\n        $currentNavbarEl = $navbarsEl.find('.navbar-current:not(.stacked)');\n        $previousNavbarEl = $navbarsEl.find('.navbar-previous:not(.stacked)');\n\n        if ($previousNavbarEl.length > 1) {\n          $previousNavbarEl = $previousNavbarEl.eq($previousNavbarEl.length - 1);\n        }\n\n        animatableNavEls = animatableNavElements($previousNavbarEl, $currentNavbarEl);\n      } // Close/Hide Any Picker\n\n\n      if ($('.sheet.modal-in').length > 0 && app.sheet) {\n        app.sheet.close($('.sheet.modal-in'));\n      }\n    }\n\n    e.f7PreventSwipePanel = true;\n    isMoved = true;\n    app.preventSwipePanelBySwipeBack = true;\n    e.preventDefault(); // RTL inverter\n\n    var inverter = app.rtl ? -1 : 1; // Touches diff\n\n    touchesDiff = (pageX - touchesStart.x - paramsSwipeBackThreshold) * inverter;\n    if (touchesDiff < 0) touchesDiff = 0;\n    var percentage = Math.min(Math.max(touchesDiff / viewContainerWidth, 0), 1); // Swipe Back Callback\n\n    var callbackData = {\n      percentage: percentage,\n      progress: percentage,\n      currentPageEl: $currentPageEl[0],\n      previousPageEl: $previousPageEl[0],\n      currentNavbarEl: $currentNavbarEl[0],\n      previousNavbarEl: $previousNavbarEl[0]\n    };\n    $el.trigger('swipeback:move', callbackData);\n    router.emit('swipebackMove', callbackData); // Transform pages\n\n    var currentPageTranslate = touchesDiff * inverter;\n    var previousPageTranslate = (touchesDiff / 5 - viewContainerWidth / 5) * inverter;\n\n    if (!app.rtl) {\n      currentPageTranslate = Math.min(currentPageTranslate, viewContainerWidth);\n      previousPageTranslate = Math.min(previousPageTranslate, 0);\n    } else {\n      currentPageTranslate = Math.max(currentPageTranslate, -viewContainerWidth);\n      previousPageTranslate = Math.max(previousPageTranslate, 0);\n    }\n\n    if (device.pixelRatio === 1) {\n      currentPageTranslate = Math.round(currentPageTranslate);\n      previousPageTranslate = Math.round(previousPageTranslate);\n    }\n\n    router.swipeBackActive = true;\n    $([$currentPageEl[0], $previousPageEl[0]]).addClass('page-swipeback-active');\n    $currentPageEl.transform(\"translate3d(\" + currentPageTranslate + \"px,0,0)\");\n    if (paramsSwipeBackAnimateShadow) $pageShadowEl[0].style.opacity = 1 - 1 * percentage;\n\n    if (app.theme === 'ios') {\n      $previousPageEl.transform(\"translate3d(\" + previousPageTranslate + \"px,0,0)\");\n    }\n\n    if (paramsSwipeBackAnimateOpacity) $pageOpacityEl[0].style.opacity = 1 - 1 * percentage; // Dynamic Navbars Animation\n\n    if (!dynamicNavbar) return;\n    setAnimatableNavElements({\n      progress: percentage\n    });\n  }\n\n  function handleTouchEnd() {\n    app.preventSwipePanelBySwipeBack = false;\n\n    if (!isTouched || !isMoved) {\n      isTouched = false;\n      isMoved = false;\n      return;\n    }\n\n    isTouched = false;\n    isMoved = false;\n    router.swipeBackActive = false;\n    var $pages = $([$currentPageEl[0], $previousPageEl[0]]);\n    $pages.removeClass('page-swipeback-active');\n\n    if (touchesDiff === 0) {\n      $pages.transform('');\n      if ($pageShadowEl && $pageShadowEl.length > 0) $pageShadowEl.remove();\n      if ($pageOpacityEl && $pageOpacityEl.length > 0) $pageOpacityEl.remove();\n\n      if (dynamicNavbar) {\n        setAnimatableNavElements({\n          reset: true\n        });\n      }\n\n      return;\n    }\n\n    var timeDiff = now() - touchStartTime;\n    var pageChanged = false; // Swipe back to previous page\n\n    if (timeDiff < 300 && touchesDiff > 10 || timeDiff >= 300 && touchesDiff > viewContainerWidth / 2) {\n      $currentPageEl.removeClass('page-current').addClass(\"page-next\" + (app.theme !== 'ios' ? ' page-next-on-right' : ''));\n      $previousPageEl.removeClass('page-previous').addClass('page-current').removeAttr('aria-hidden');\n      if ($pageShadowEl) $pageShadowEl[0].style.opacity = '';\n      if ($pageOpacityEl) $pageOpacityEl[0].style.opacity = '';\n\n      if (dynamicNavbar) {\n        router.setNavbarPosition($currentNavbarEl, 'next');\n        router.setNavbarPosition($previousNavbarEl, 'current', false);\n      }\n\n      pageChanged = true;\n    } // Reset custom styles\n    // Add transitioning class for transition-duration\n\n\n    $pages.addClass('page-transitioning page-transitioning-swipeback');\n\n    if (device.ios) {\n      // eslint-disable-next-line\n      $currentPageEl[0]._clientLeft = $currentPageEl[0].clientLeft;\n    }\n\n    $pages.transform('');\n\n    if (dynamicNavbar) {\n      setAnimatableNavElements({\n        progress: pageChanged ? 1 : 0,\n        transition: true,\n        reflow: !!device.ios\n      });\n    }\n\n    allowViewTouchMove = false;\n    router.allowPageChange = false; // Swipe Back Callback\n\n    var callbackData = {\n      currentPageEl: $currentPageEl[0],\n      previousPageEl: $previousPageEl[0],\n      currentNavbarEl: $currentNavbarEl[0],\n      previousNavbarEl: $previousNavbarEl[0]\n    };\n\n    if (pageChanged) {\n      // Update Route\n      router.currentRoute = $previousPageEl[0].f7Page.route;\n      router.currentPage = $previousPageEl[0]; // Page before animation callback\n\n      router.pageCallback('beforeOut', $currentPageEl, $currentNavbarEl, 'current', 'next', {\n        route: $currentPageEl[0].f7Page.route,\n        swipeBack: true\n      });\n      router.pageCallback('beforeIn', $previousPageEl, $previousNavbarEl, 'previous', 'current', {\n        route: $previousPageEl[0].f7Page.route,\n        swipeBack: true\n      }, $currentPageEl[0]);\n      $el.trigger('swipeback:beforechange', callbackData);\n      router.emit('swipebackBeforeChange', callbackData);\n    } else {\n      $el.trigger('swipeback:beforereset', callbackData);\n      router.emit('swipebackBeforeReset', callbackData);\n    }\n\n    $currentPageEl.transitionEnd(function () {\n      $pages.removeClass('page-transitioning page-transitioning-swipeback');\n\n      if (dynamicNavbar) {\n        setAnimatableNavElements({\n          reset: true,\n          transition: false\n        });\n      }\n\n      allowViewTouchMove = true;\n      router.allowPageChange = true;\n\n      if (pageChanged) {\n        // Update History\n        if (router.history.length === 1) {\n          router.history.unshift(router.url);\n        }\n\n        router.history.pop();\n        router.saveHistory(); // Update push state\n\n        if (params.browserHistory) {\n          History.back();\n        } // Page after animation callback\n\n\n        router.pageCallback('afterOut', $currentPageEl, $currentNavbarEl, 'current', 'next', {\n          route: $currentPageEl[0].f7Page.route,\n          swipeBack: true\n        });\n        router.pageCallback('afterIn', $previousPageEl, $previousNavbarEl, 'previous', 'current', {\n          route: $previousPageEl[0].f7Page.route,\n          swipeBack: true\n        }); // Remove Old Page\n\n        if (params.stackPages && router.initialPages.indexOf($currentPageEl[0]) >= 0) {\n          $currentPageEl.addClass('stacked');\n\n          if (dynamicNavbar) {\n            $currentNavbarEl.addClass('stacked');\n          }\n        } else {\n          router.pageCallback('beforeRemove', $currentPageEl, $currentNavbarEl, 'next', {\n            swipeBack: true\n          });\n          router.removePage($currentPageEl);\n\n          if (dynamicNavbar) {\n            router.removeNavbar($currentNavbarEl);\n          }\n        }\n\n        $el.trigger('swipeback:afterchange', callbackData);\n        router.emit('swipebackAfterChange', callbackData);\n        router.emit('routeChanged', router.currentRoute, router.previousRoute, router);\n\n        if (params.preloadPreviousPage) {\n          router.back(router.history[router.history.length - 2], {\n            preload: true\n          });\n        }\n      } else {\n        $el.trigger('swipeback:afterreset', callbackData);\n        router.emit('swipebackAfterReset', callbackData);\n      }\n\n      if ($pageShadowEl && $pageShadowEl.length > 0) $pageShadowEl.remove();\n      if ($pageOpacityEl && $pageOpacityEl.length > 0) $pageOpacityEl.remove();\n    });\n  }\n\n  function attachEvents() {\n    var passiveListener = app.touchEvents.start === 'touchstart' && support.passiveListener ? {\n      passive: true,\n      capture: false\n    } : false;\n    $el.on(app.touchEvents.start, handleTouchStart, passiveListener);\n    app.on('touchmove:active', handleTouchMove);\n    app.on('touchend:passive', handleTouchEnd);\n  }\n\n  function detachEvents() {\n    var passiveListener = app.touchEvents.start === 'touchstart' && support.passiveListener ? {\n      passive: true,\n      capture: false\n    } : false;\n    $el.off(app.touchEvents.start, handleTouchStart, passiveListener);\n    app.off('touchmove:active', handleTouchMove);\n    app.off('touchend:passive', handleTouchEnd);\n  }\n\n  attachEvents();\n  router.on('routerDestroy', detachEvents);\n}\n\nexport default SwipeBack;"]},"metadata":{},"sourceType":"module"}