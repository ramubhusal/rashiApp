{"ast":null,"code":"import { getWindow, getDocument } from 'ssr-window';\nimport $ from './dom7';\nimport { extend } from './utils';\nvar History = {\n  queue: [],\n  clearQueue: function clearQueue() {\n    if (History.queue.length === 0) return;\n    var currentQueue = History.queue.shift();\n    currentQueue();\n  },\n  routerQueue: [],\n  clearRouterQueue: function clearRouterQueue() {\n    if (History.routerQueue.length === 0) return;\n    var currentQueue = History.routerQueue.pop();\n    var router = currentQueue.router,\n        stateUrl = currentQueue.stateUrl,\n        action = currentQueue.action;\n    var animate = router.params.animate;\n    if (router.params.browserHistoryAnimate === false) animate = false;\n\n    if (action === 'back') {\n      router.back({\n        animate: animate,\n        browserHistory: false\n      });\n    }\n\n    if (action === 'load') {\n      router.navigate(stateUrl, {\n        animate: animate,\n        browserHistory: false\n      });\n    }\n  },\n  handle: function handle(e) {\n    if (History.blockPopstate) return;\n    var app = this; // const mainView = app.views.main;\n\n    var state = e.state;\n    History.previousState = History.state;\n    History.state = state;\n    History.allowChange = true;\n    History.clearQueue();\n    state = History.state;\n    if (!state) state = {};\n    app.views.forEach(function (view) {\n      var router = view.router;\n      var viewState = state[view.id];\n\n      if (!viewState && view.params.browserHistory) {\n        viewState = {\n          url: view.router.history[0]\n        };\n      }\n\n      if (!viewState) return;\n      var stateUrl = viewState.url || undefined;\n      var animate = router.params.animate;\n      if (router.params.browserHistoryAnimate === false) animate = false;\n\n      if (stateUrl !== router.url) {\n        if (router.history.indexOf(stateUrl) >= 0) {\n          // Go Back\n          if (router.allowPageChange) {\n            router.back({\n              animate: animate,\n              browserHistory: false\n            });\n          } else {\n            History.routerQueue.push({\n              action: 'back',\n              router: router\n            });\n          }\n        } else if (router.allowPageChange) {\n          // Load page\n          router.navigate(stateUrl, {\n            animate: animate,\n            browserHistory: false\n          });\n        } else {\n          History.routerQueue.unshift({\n            action: 'load',\n            stateUrl: stateUrl,\n            router: router\n          });\n        }\n      }\n    });\n  },\n  initViewState: function initViewState(viewId, viewState) {\n    var _extend;\n\n    var window = getWindow();\n    var newState = extend({}, History.state || {}, (_extend = {}, _extend[viewId] = viewState, _extend));\n    History.state = newState;\n    window.history.replaceState(newState, '');\n  },\n  push: function push(viewId, viewState, url) {\n    var _extend2;\n\n    var window = getWindow();\n\n    if (url.substr(-3) === '#!/') {\n      // eslint-disable-next-line\n      url = url.replace('#!/', '');\n    }\n\n    if (!History.allowChange) {\n      History.queue.push(function () {\n        History.push(viewId, viewState, url);\n      });\n      return;\n    }\n\n    History.previousState = History.state;\n    var newState = extend({}, History.previousState || {}, (_extend2 = {}, _extend2[viewId] = viewState, _extend2));\n    History.state = newState;\n    window.history.pushState(newState, '', url);\n  },\n  replace: function replace(viewId, viewState, url) {\n    var _extend3;\n\n    var window = getWindow();\n\n    if (url.substr(-3) === '#!/') {\n      // eslint-disable-next-line\n      url = url.replace('#!/', '');\n    }\n\n    if (!History.allowChange) {\n      History.queue.push(function () {\n        History.replace(viewId, viewState, url);\n      });\n      return;\n    }\n\n    History.previousState = History.state;\n    var newState = extend({}, History.previousState || {}, (_extend3 = {}, _extend3[viewId] = viewState, _extend3));\n    History.state = newState;\n    window.history.replaceState(newState, '', url);\n  },\n  go: function go(index) {\n    var window = getWindow();\n    History.allowChange = false;\n    window.history.go(index);\n  },\n  back: function back() {\n    var window = getWindow();\n    History.allowChange = false;\n    window.history.back();\n  },\n  allowChange: true,\n  previousState: {},\n  state: {},\n  blockPopstate: true,\n  init: function init(app) {\n    var window = getWindow();\n    var document = getDocument();\n    History.state = window.history.state;\n    $(window).on('load', function () {\n      setTimeout(function () {\n        History.blockPopstate = false;\n      }, 0);\n    });\n\n    if (document.readyState && document.readyState === 'complete') {\n      History.blockPopstate = false;\n    }\n\n    $(window).on('popstate', History.handle.bind(app));\n  }\n};\nexport default History;","map":{"version":3,"sources":["E:/Programming/React/rashiApp/node_modules/framework7/esm/shared/history.js"],"names":["getWindow","getDocument","$","extend","History","queue","clearQueue","length","currentQueue","shift","routerQueue","clearRouterQueue","pop","router","stateUrl","action","animate","params","browserHistoryAnimate","back","browserHistory","navigate","handle","e","blockPopstate","app","state","previousState","allowChange","views","forEach","view","viewState","id","url","history","undefined","indexOf","allowPageChange","push","unshift","initViewState","viewId","_extend","window","newState","replaceState","_extend2","substr","replace","pushState","_extend3","go","index","init","document","on","setTimeout","readyState","bind"],"mappings":"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","sourcesContent":["import { getWindow, getDocument } from 'ssr-window';\nimport $ from './dom7';\nimport { extend } from './utils';\nvar History = {\n  queue: [],\n  clearQueue: function clearQueue() {\n    if (History.queue.length === 0) return;\n    var currentQueue = History.queue.shift();\n    currentQueue();\n  },\n  routerQueue: [],\n  clearRouterQueue: function clearRouterQueue() {\n    if (History.routerQueue.length === 0) return;\n    var currentQueue = History.routerQueue.pop();\n    var router = currentQueue.router,\n        stateUrl = currentQueue.stateUrl,\n        action = currentQueue.action;\n    var animate = router.params.animate;\n    if (router.params.browserHistoryAnimate === false) animate = false;\n\n    if (action === 'back') {\n      router.back({\n        animate: animate,\n        browserHistory: false\n      });\n    }\n\n    if (action === 'load') {\n      router.navigate(stateUrl, {\n        animate: animate,\n        browserHistory: false\n      });\n    }\n  },\n  handle: function handle(e) {\n    if (History.blockPopstate) return;\n    var app = this; // const mainView = app.views.main;\n\n    var state = e.state;\n    History.previousState = History.state;\n    History.state = state;\n    History.allowChange = true;\n    History.clearQueue();\n    state = History.state;\n    if (!state) state = {};\n    app.views.forEach(function (view) {\n      var router = view.router;\n      var viewState = state[view.id];\n\n      if (!viewState && view.params.browserHistory) {\n        viewState = {\n          url: view.router.history[0]\n        };\n      }\n\n      if (!viewState) return;\n      var stateUrl = viewState.url || undefined;\n      var animate = router.params.animate;\n      if (router.params.browserHistoryAnimate === false) animate = false;\n\n      if (stateUrl !== router.url) {\n        if (router.history.indexOf(stateUrl) >= 0) {\n          // Go Back\n          if (router.allowPageChange) {\n            router.back({\n              animate: animate,\n              browserHistory: false\n            });\n          } else {\n            History.routerQueue.push({\n              action: 'back',\n              router: router\n            });\n          }\n        } else if (router.allowPageChange) {\n          // Load page\n          router.navigate(stateUrl, {\n            animate: animate,\n            browserHistory: false\n          });\n        } else {\n          History.routerQueue.unshift({\n            action: 'load',\n            stateUrl: stateUrl,\n            router: router\n          });\n        }\n      }\n    });\n  },\n  initViewState: function initViewState(viewId, viewState) {\n    var _extend;\n\n    var window = getWindow();\n    var newState = extend({}, History.state || {}, (_extend = {}, _extend[viewId] = viewState, _extend));\n    History.state = newState;\n    window.history.replaceState(newState, '');\n  },\n  push: function push(viewId, viewState, url) {\n    var _extend2;\n\n    var window = getWindow();\n\n    if (url.substr(-3) === '#!/') {\n      // eslint-disable-next-line\n      url = url.replace('#!/', '');\n    }\n\n    if (!History.allowChange) {\n      History.queue.push(function () {\n        History.push(viewId, viewState, url);\n      });\n      return;\n    }\n\n    History.previousState = History.state;\n    var newState = extend({}, History.previousState || {}, (_extend2 = {}, _extend2[viewId] = viewState, _extend2));\n    History.state = newState;\n    window.history.pushState(newState, '', url);\n  },\n  replace: function replace(viewId, viewState, url) {\n    var _extend3;\n\n    var window = getWindow();\n\n    if (url.substr(-3) === '#!/') {\n      // eslint-disable-next-line\n      url = url.replace('#!/', '');\n    }\n\n    if (!History.allowChange) {\n      History.queue.push(function () {\n        History.replace(viewId, viewState, url);\n      });\n      return;\n    }\n\n    History.previousState = History.state;\n    var newState = extend({}, History.previousState || {}, (_extend3 = {}, _extend3[viewId] = viewState, _extend3));\n    History.state = newState;\n    window.history.replaceState(newState, '', url);\n  },\n  go: function go(index) {\n    var window = getWindow();\n    History.allowChange = false;\n    window.history.go(index);\n  },\n  back: function back() {\n    var window = getWindow();\n    History.allowChange = false;\n    window.history.back();\n  },\n  allowChange: true,\n  previousState: {},\n  state: {},\n  blockPopstate: true,\n  init: function init(app) {\n    var window = getWindow();\n    var document = getDocument();\n    History.state = window.history.state;\n    $(window).on('load', function () {\n      setTimeout(function () {\n        History.blockPopstate = false;\n      }, 0);\n    });\n\n    if (document.readyState && document.readyState === 'complete') {\n      History.blockPopstate = false;\n    }\n\n    $(window).on('popstate', History.handle.bind(app));\n  }\n};\nexport default History;"]},"metadata":{},"sourceType":"module"}