{"ast":null,"code":"function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nimport { getWindow, getDocument } from 'ssr-window';\nimport { pathToRegexp, compile } from 'path-to-regexp';\nimport $ from '../../shared/dom7';\nimport Framework7Class from '../../shared/class';\nimport { extend, nextFrame, parseUrlQuery, serializeObject, now, eventNameToColonCase } from '../../shared/utils';\nimport History from '../../shared/history';\nimport SwipeBack from './swipe-back';\nimport { refreshPage, navigate } from './navigate';\nimport { tabLoad, tabRemove } from './tab';\nimport { modalLoad, modalRemove } from './modal';\nimport { back } from './back';\nimport { clearPreviousHistory } from './clear-previous-history';\nimport appRouterCheck from './app-router-check';\n\nvar Router = /*#__PURE__*/function (_Framework7Class) {\n  _inheritsLoose(Router, _Framework7Class);\n\n  function Router(app, view) {\n    var _this;\n\n    _this = _Framework7Class.call(this, {}, [typeof view === 'undefined' ? app : view]) || this;\n\n    var router = _assertThisInitialized(_this); // Is App Router\n\n\n    router.isAppRouter = typeof view === 'undefined';\n\n    if (router.isAppRouter) {\n      // App Router\n      extend(false, router, {\n        app: app,\n        params: app.params.view,\n        routes: app.routes || [],\n        cache: app.cache\n      });\n    } else {\n      // View Router\n      extend(false, router, {\n        app: app,\n        view: view,\n        viewId: view.id,\n        id: view.params.routerId,\n        params: view.params,\n        routes: view.routes,\n        history: view.history,\n        scrollHistory: view.scrollHistory,\n        cache: app.cache,\n        dynamicNavbar: app.theme === 'ios' && view.params.iosDynamicNavbar,\n        initialPages: [],\n        initialNavbars: []\n      });\n    } // Install Modules\n\n\n    router.useModules(); // AllowPageChage\n\n    router.allowPageChange = true; // Current Route\n\n    var currentRoute = {};\n    var previousRoute = {};\n    Object.defineProperty(router, 'currentRoute', {\n      enumerable: true,\n      configurable: true,\n      set: function set(newRoute) {\n        if (newRoute === void 0) {\n          newRoute = {};\n        }\n\n        previousRoute = extend({}, currentRoute);\n        currentRoute = newRoute;\n        if (!currentRoute) return;\n        router.url = currentRoute.url;\n        router.emit('routeChange', newRoute, previousRoute, router);\n      },\n      get: function get() {\n        return currentRoute;\n      }\n    });\n    Object.defineProperty(router, 'previousRoute', {\n      enumerable: true,\n      configurable: true,\n      get: function get() {\n        return previousRoute;\n      },\n      set: function set(newRoute) {\n        previousRoute = newRoute;\n      }\n    });\n    return router || _assertThisInitialized(_this);\n  }\n\n  var _proto = Router.prototype;\n\n  _proto.mount = function mount() {\n    var router = this;\n    var view = router.view;\n    var document = getDocument();\n    extend(false, router, {\n      tempDom: document.createElement('div'),\n      $el: view.$el,\n      el: view.el,\n      $navbarsEl: view.$navbarsEl,\n      navbarsEl: view.navbarsEl\n    });\n    router.emit('local::mount routerMount', router);\n  };\n\n  _proto.animatableNavElements = function animatableNavElements($newNavbarEl, $oldNavbarEl, toLarge, fromLarge, direction) {\n    var router = this;\n    var dynamicNavbar = router.dynamicNavbar;\n    var animateIcon = router.params.iosAnimateNavbarBackIcon;\n    var newNavEls;\n    var oldNavEls;\n\n    function animatableNavEl($el, $navbarInner) {\n      var isSliding = $el.hasClass('sliding') || $navbarInner.hasClass('sliding');\n      var isSubnavbar = $el.hasClass('subnavbar');\n      var needsOpacityTransition = isSliding ? !isSubnavbar : true;\n      var $iconEl = $el.find('.back .icon');\n      var isIconLabel;\n\n      if (isSliding && animateIcon && $el.hasClass('left') && $iconEl.length > 0 && $iconEl.next('span').length) {\n        $el = $iconEl.next('span'); // eslint-disable-line\n\n        isIconLabel = true;\n      }\n\n      return {\n        $el: $el,\n        isIconLabel: isIconLabel,\n        leftOffset: $el[0].f7NavbarLeftOffset,\n        rightOffset: $el[0].f7NavbarRightOffset,\n        isSliding: isSliding,\n        isSubnavbar: isSubnavbar,\n        needsOpacityTransition: needsOpacityTransition\n      };\n    }\n\n    if (dynamicNavbar) {\n      newNavEls = [];\n      oldNavEls = [];\n      $newNavbarEl.children('.navbar-inner').children('.left, .right, .title, .subnavbar').each(function (navEl) {\n        var $navEl = $(navEl);\n        if ($navEl.hasClass('left') && fromLarge && direction === 'forward') return;\n        if ($navEl.hasClass('title') && toLarge) return;\n        newNavEls.push(animatableNavEl($navEl, $newNavbarEl.children('.navbar-inner')));\n      });\n\n      if (!($oldNavbarEl.hasClass('navbar-master') && router.params.masterDetailBreakpoint > 0 && router.app.width >= router.params.masterDetailBreakpoint)) {\n        $oldNavbarEl.children('.navbar-inner').children('.left, .right, .title, .subnavbar').each(function (navEl) {\n          var $navEl = $(navEl);\n          if ($navEl.hasClass('left') && toLarge && !fromLarge && direction === 'forward') return;\n          if ($navEl.hasClass('left') && toLarge && direction === 'backward') return;\n\n          if ($navEl.hasClass('title') && fromLarge) {\n            return;\n          }\n\n          oldNavEls.push(animatableNavEl($navEl, $oldNavbarEl.children('.navbar-inner')));\n        });\n      }\n\n      [oldNavEls, newNavEls].forEach(function (navEls) {\n        navEls.forEach(function (navEl) {\n          var n = navEl;\n          var isSliding = navEl.isSliding,\n              $el = navEl.$el;\n          var otherEls = navEls === oldNavEls ? newNavEls : oldNavEls;\n          if (!(isSliding && $el.hasClass('title') && otherEls)) return;\n          otherEls.forEach(function (otherNavEl) {\n            if (otherNavEl.isIconLabel) {\n              var iconTextEl = otherNavEl.$el[0];\n              n.leftOffset += iconTextEl ? iconTextEl.offsetLeft || 0 : 0;\n            }\n          });\n        });\n      });\n    }\n\n    return {\n      newNavEls: newNavEls,\n      oldNavEls: oldNavEls\n    };\n  };\n\n  _proto.animate = function animate($oldPageEl, $newPageEl, $oldNavbarEl, $newNavbarEl, direction, transition, callback) {\n    var router = this;\n\n    if (router.params.animateCustom) {\n      router.params.animateCustom.apply(router, [$oldPageEl, $newPageEl, $oldNavbarEl, $newNavbarEl, direction, callback]);\n      return;\n    }\n\n    var dynamicNavbar = router.dynamicNavbar;\n    var ios = router.app.theme === 'ios';\n\n    if (transition) {\n      var routerCustomTransitionClass = \"router-transition-custom router-transition-\" + transition + \"-\" + direction; // Animate\n\n      var onCustomTransitionDone = function onCustomTransitionDone() {\n        router.$el.removeClass(routerCustomTransitionClass);\n\n        if (dynamicNavbar && router.$navbarsEl.length) {\n          if ($newNavbarEl) {\n            router.$navbarsEl.prepend($newNavbarEl);\n          }\n\n          if ($oldNavbarEl) {\n            router.$navbarsEl.prepend($oldNavbarEl);\n          }\n        }\n\n        if (callback) callback();\n      };\n\n      (direction === 'forward' ? $newPageEl : $oldPageEl).animationEnd(onCustomTransitionDone);\n\n      if (dynamicNavbar) {\n        if ($newNavbarEl && $newPageEl) {\n          router.setNavbarPosition($newNavbarEl, '');\n          $newNavbarEl.removeClass('navbar-next navbar-previous navbar-current');\n          $newPageEl.prepend($newNavbarEl);\n        }\n\n        if ($oldNavbarEl && $oldPageEl) {\n          router.setNavbarPosition($oldNavbarEl, '');\n          $oldNavbarEl.removeClass('navbar-next navbar-previous navbar-current');\n          $oldPageEl.prepend($oldNavbarEl);\n        }\n      }\n\n      router.$el.addClass(routerCustomTransitionClass);\n      return;\n    } // Router Animation class\n\n\n    var routerTransitionClass = \"router-transition-\" + direction + \" router-transition\";\n    var newNavEls;\n    var oldNavEls;\n    var fromLarge;\n    var toLarge;\n    var toDifferent;\n    var oldIsLarge;\n    var newIsLarge;\n\n    if (ios && dynamicNavbar) {\n      var betweenMasterAndDetail = router.params.masterDetailBreakpoint > 0 && router.app.width >= router.params.masterDetailBreakpoint && ($oldNavbarEl.hasClass('navbar-master') && $newNavbarEl.hasClass('navbar-master-detail') || $oldNavbarEl.hasClass('navbar-master-detail') && $newNavbarEl.hasClass('navbar-master'));\n\n      if (!betweenMasterAndDetail) {\n        oldIsLarge = $oldNavbarEl && $oldNavbarEl.hasClass('navbar-large');\n        newIsLarge = $newNavbarEl && $newNavbarEl.hasClass('navbar-large');\n        fromLarge = oldIsLarge && !$oldNavbarEl.hasClass('navbar-large-collapsed');\n        toLarge = newIsLarge && !$newNavbarEl.hasClass('navbar-large-collapsed');\n        toDifferent = fromLarge && !toLarge || toLarge && !fromLarge;\n      }\n\n      var navEls = router.animatableNavElements($newNavbarEl, $oldNavbarEl, toLarge, fromLarge, direction);\n      newNavEls = navEls.newNavEls;\n      oldNavEls = navEls.oldNavEls;\n    }\n\n    function animateNavbars(progress) {\n      if (!(ios && dynamicNavbar)) return;\n\n      if (progress === 1) {\n        if (toLarge) {\n          $newNavbarEl.addClass('router-navbar-transition-to-large');\n          $oldNavbarEl.addClass('router-navbar-transition-to-large');\n        }\n\n        if (fromLarge) {\n          $newNavbarEl.addClass('router-navbar-transition-from-large');\n          $oldNavbarEl.addClass('router-navbar-transition-from-large');\n        }\n      }\n\n      newNavEls.forEach(function (navEl) {\n        var $el = navEl.$el;\n        var offset = direction === 'forward' ? navEl.rightOffset : navEl.leftOffset;\n\n        if (navEl.isSliding) {\n          if (navEl.isSubnavbar && newIsLarge) {\n            // prettier-ignore\n            $el[0].style.setProperty('transform', \"translate3d(\" + offset * (1 - progress) + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\", 'important');\n          } else {\n            $el.transform(\"translate3d(\" + offset * (1 - progress) + \"px,0,0)\");\n          }\n        }\n      });\n      oldNavEls.forEach(function (navEl) {\n        var $el = navEl.$el;\n        var offset = direction === 'forward' ? navEl.leftOffset : navEl.rightOffset;\n\n        if (navEl.isSliding) {\n          if (navEl.isSubnavbar && oldIsLarge) {\n            $el.transform(\"translate3d(\" + offset * progress + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\");\n          } else {\n            $el.transform(\"translate3d(\" + offset * progress + \"px,0,0)\");\n          }\n        }\n      });\n    } // AnimationEnd Callback\n\n\n    function onDone() {\n      if (router.dynamicNavbar) {\n        if ($newNavbarEl) {\n          $newNavbarEl.removeClass('router-navbar-transition-to-large router-navbar-transition-from-large');\n          $newNavbarEl.addClass('navbar-no-title-large-transition');\n          nextFrame(function () {\n            $newNavbarEl.removeClass('navbar-no-title-large-transition');\n          });\n        }\n\n        if ($oldNavbarEl) {\n          $oldNavbarEl.removeClass('router-navbar-transition-to-large router-navbar-transition-from-large');\n        }\n\n        if ($newNavbarEl.hasClass('sliding') || $newNavbarEl.children('.navbar-inner.sliding').length) {\n          $newNavbarEl.find('.title, .left, .right, .left .icon, .subnavbar').transform('');\n        } else {\n          $newNavbarEl.find('.sliding').transform('');\n        }\n\n        if ($oldNavbarEl.hasClass('sliding') || $oldNavbarEl.children('.navbar-inner.sliding').length) {\n          $oldNavbarEl.find('.title, .left, .right, .left .icon, .subnavbar').transform('');\n        } else {\n          $oldNavbarEl.find('.sliding').transform('');\n        }\n      }\n\n      router.$el.removeClass(routerTransitionClass);\n      if (callback) callback();\n    }\n\n    (direction === 'forward' ? $newPageEl : $oldPageEl).animationEnd(function () {\n      onDone();\n    }); // Animate\n\n    if (dynamicNavbar) {\n      // Prepare Navbars\n      animateNavbars(0);\n      nextFrame(function () {\n        // Add class, start animation\n        router.$el.addClass(routerTransitionClass);\n\n        if (toDifferent) {\n          // eslint-disable-next-line\n          router.el._clientLeft = router.el.clientLeft;\n        }\n\n        animateNavbars(1);\n      });\n    } else {\n      // Add class, start animation\n      router.$el.addClass(routerTransitionClass);\n    }\n  };\n\n  _proto.removeModal = function removeModal(modalEl) {\n    var router = this;\n    router.removeEl(modalEl);\n  } // eslint-disable-next-line\n  ;\n\n  _proto.removeTabContent = function removeTabContent(tabEl) {\n    var $tabEl = $(tabEl);\n    $tabEl.html('');\n  };\n\n  _proto.removeNavbar = function removeNavbar(el) {\n    var router = this;\n    router.removeEl(el);\n  };\n\n  _proto.removePage = function removePage(el) {\n    var $el = $(el);\n    var f7Page = $el && $el[0] && $el[0].f7Page;\n    var router = this;\n\n    if (f7Page && f7Page.route && f7Page.route.route && f7Page.route.route.keepAlive) {\n      $el.remove();\n      return;\n    }\n\n    router.removeEl(el);\n  };\n\n  _proto.removeEl = function removeEl(el) {\n    if (!el) return;\n    var router = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n    $el.find('.tab').each(function (tabEl) {\n      $(tabEl).children().each(function (tabChild) {\n        if (tabChild.f7Component) {\n          $(tabChild).trigger('tab:beforeremove');\n          tabChild.f7Component.destroy();\n        }\n      });\n    });\n\n    if ($el[0].f7Component && $el[0].f7Component.destroy) {\n      $el[0].f7Component.destroy();\n    }\n\n    if (!router.params.removeElements) {\n      return;\n    }\n\n    if (router.params.removeElementsWithTimeout) {\n      setTimeout(function () {\n        $el.remove();\n      }, router.params.removeElementsTimeout);\n    } else {\n      $el.remove();\n    }\n  };\n\n  _proto.getPageEl = function getPageEl(content) {\n    var router = this;\n\n    if (typeof content === 'string') {\n      router.tempDom.innerHTML = content;\n    } else {\n      if ($(content).hasClass('page')) {\n        return content;\n      }\n\n      router.tempDom.innerHTML = '';\n      $(router.tempDom).append(content);\n    }\n\n    return router.findElement('.page', router.tempDom);\n  };\n\n  _proto.findElement = function findElement(stringSelector, container, notStacked) {\n    var router = this;\n    var view = router.view;\n    var app = router.app; // Modals Selector\n\n    var modalsSelector = '.popup, .dialog, .popover, .actions-modal, .sheet-modal, .login-screen, .page';\n    var $container = $(container);\n    var selector = stringSelector;\n    if (notStacked) selector += ':not(.stacked)';\n    var found = $container.find(selector).filter(function (el) {\n      return $(el).parents(modalsSelector).length === 0;\n    });\n\n    if (found.length > 1) {\n      if (typeof view.selector === 'string') {\n        // Search in related view\n        found = $container.find(view.selector + \" \" + selector);\n      }\n\n      if (found.length > 1) {\n        // Search in main view\n        found = $container.find(\".\" + app.params.viewMainClass + \" \" + selector);\n      }\n    }\n\n    if (found.length === 1) return found; // Try to find not stacked\n\n    if (!notStacked) found = router.findElement(selector, $container, true);\n    if (found && found.length === 1) return found;\n    if (found && found.length > 1) return $(found[0]);\n    return undefined;\n  };\n\n  _proto.flattenRoutes = function flattenRoutes(routes) {\n    if (routes === void 0) {\n      routes = this.routes;\n    }\n\n    var router = this;\n    var flattenedRoutes = [];\n    routes.forEach(function (route) {\n      var hasTabRoutes = false;\n\n      if ('tabs' in route && route.tabs) {\n        var mergedPathsRoutes = route.tabs.map(function (tabRoute) {\n          var tRoute = extend({}, route, {\n            path: (route.path + \"/\" + tabRoute.path).replace('///', '/').replace('//', '/'),\n            parentPath: route.path,\n            tab: tabRoute\n          });\n          delete tRoute.tabs;\n          delete tRoute.routes;\n          return tRoute;\n        });\n        hasTabRoutes = true;\n        flattenedRoutes = flattenedRoutes.concat(router.flattenRoutes(mergedPathsRoutes));\n      }\n\n      if ('detailRoutes' in route) {\n        var _mergedPathsRoutes = route.detailRoutes.map(function (detailRoute) {\n          var dRoute = extend({}, detailRoute);\n          dRoute.masterRoute = route;\n          dRoute.masterRoutePath = route.path;\n          return dRoute;\n        });\n\n        flattenedRoutes = flattenedRoutes.concat(route, router.flattenRoutes(_mergedPathsRoutes));\n      }\n\n      if ('routes' in route) {\n        var _mergedPathsRoutes2 = route.routes.map(function (childRoute) {\n          var cRoute = extend({}, childRoute);\n          cRoute.path = (route.path + \"/\" + cRoute.path).replace('///', '/').replace('//', '/');\n          return cRoute;\n        });\n\n        if (hasTabRoutes) {\n          flattenedRoutes = flattenedRoutes.concat(router.flattenRoutes(_mergedPathsRoutes2));\n        } else {\n          flattenedRoutes = flattenedRoutes.concat(route, router.flattenRoutes(_mergedPathsRoutes2));\n        }\n      }\n\n      if (!('routes' in route) && !('tabs' in route && route.tabs) && !('detailRoutes' in route)) {\n        flattenedRoutes.push(route);\n      }\n    });\n    return flattenedRoutes;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.parseRouteUrl = function parseRouteUrl(url) {\n    if (!url) return {};\n    var query = parseUrlQuery(url);\n    var hash = url.split('#')[1];\n    var params = {};\n    var path = url.split('#')[0].split('?')[0];\n    return {\n      query: query,\n      hash: hash,\n      params: params,\n      url: url,\n      path: path\n    };\n  };\n\n  _proto.generateUrl = function generateUrl(parameters) {\n    if (parameters === void 0) {\n      parameters = {};\n    }\n\n    if (typeof parameters === 'string') {\n      return parameters;\n    }\n\n    var _parameters = parameters,\n        name = _parameters.name,\n        path = _parameters.path,\n        params = _parameters.params,\n        query = _parameters.query;\n\n    if (!name && !path) {\n      throw new Error('Framework7: \"name\" or \"path\" parameter is required');\n    }\n\n    var router = this;\n    var route = name ? router.findRouteByKey('name', name) : router.findRouteByKey('path', path);\n\n    if (!route) {\n      if (name) {\n        throw new Error(\"Framework7: route with name \\\"\" + name + \"\\\" not found\");\n      } else {\n        throw new Error(\"Framework7: route with path \\\"\" + path + \"\\\" not found\");\n      }\n    }\n\n    var url = router.constructRouteUrl(route, {\n      params: params,\n      query: query\n    });\n\n    if (!url) {\n      throw new Error(\"Framework7: can't construct URL for route with name \\\"\" + name + \"\\\"\");\n    }\n\n    return url;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.constructRouteUrl = function constructRouteUrl(route, _temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        params = _ref.params,\n        query = _ref.query;\n\n    var path = route.path;\n    var toUrl = compile(path);\n    var url;\n\n    try {\n      url = toUrl(params || {});\n    } catch (error) {\n      throw new Error(\"Framework7: error constructing route URL from passed params:\\nRoute: \" + path + \"\\n\" + error.toString());\n    }\n\n    if (query) {\n      if (typeof query === 'string') url += \"?\" + query;else url += \"?\" + serializeObject(query);\n    }\n\n    return url;\n  };\n\n  _proto.findTabRoute = function findTabRoute(tabEl) {\n    var router = this;\n    var $tabEl = $(tabEl);\n    var parentPath = router.currentRoute.route.parentPath;\n    var tabId = $tabEl.attr('id');\n    var flattenedRoutes = router.flattenRoutes(router.routes);\n    var foundTabRoute;\n    flattenedRoutes.forEach(function (route) {\n      if (route.parentPath === parentPath && route.tab && route.tab.id === tabId) {\n        foundTabRoute = route;\n      }\n    });\n    return foundTabRoute;\n  };\n\n  _proto.findRouteByKey = function findRouteByKey(key, value) {\n    var router = this;\n    var routes = router.routes;\n    var flattenedRoutes = router.flattenRoutes(routes);\n    var matchingRoute;\n    flattenedRoutes.forEach(function (route) {\n      if (matchingRoute) return;\n\n      if (route[key] === value) {\n        matchingRoute = route;\n      }\n    });\n    return matchingRoute;\n  };\n\n  _proto.findMatchingRoute = function findMatchingRoute(url) {\n    if (!url) return undefined;\n    var router = this;\n    var routes = router.routes;\n    var flattenedRoutes = router.flattenRoutes(routes);\n\n    var _router$parseRouteUrl = router.parseRouteUrl(url),\n        path = _router$parseRouteUrl.path,\n        query = _router$parseRouteUrl.query,\n        hash = _router$parseRouteUrl.hash,\n        params = _router$parseRouteUrl.params;\n\n    var matchingRoute;\n    flattenedRoutes.forEach(function (route) {\n      if (matchingRoute) return;\n      var keys = [];\n      var pathsToMatch = [route.path];\n\n      if (route.alias) {\n        if (typeof route.alias === 'string') pathsToMatch.push(route.alias);else if (Array.isArray(route.alias)) {\n          route.alias.forEach(function (aliasPath) {\n            pathsToMatch.push(aliasPath);\n          });\n        }\n      }\n\n      var matched;\n      pathsToMatch.forEach(function (pathToMatch) {\n        if (matched) return;\n        matched = pathToRegexp(pathToMatch, keys).exec(path);\n      });\n\n      if (matched) {\n        keys.forEach(function (keyObj, index) {\n          if (typeof keyObj.name === 'number') return;\n          var paramValue = matched[index + 1];\n\n          if (typeof paramValue === 'undefined' || paramValue === null) {\n            params[keyObj.name] = paramValue;\n          } else {\n            params[keyObj.name] = decodeURIComponent(paramValue);\n          }\n        });\n        var parentPath;\n\n        if (route.parentPath) {\n          parentPath = path.split('/').slice(0, route.parentPath.split('/').length - 1).join('/');\n        }\n\n        matchingRoute = {\n          query: query,\n          hash: hash,\n          params: params,\n          url: url,\n          path: path,\n          parentPath: parentPath,\n          route: route,\n          name: route.name\n        };\n      }\n    });\n    return matchingRoute;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.replaceRequestUrlParams = function replaceRequestUrlParams(url, options) {\n    if (url === void 0) {\n      url = '';\n    }\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var compiledUrl = url;\n\n    if (typeof compiledUrl === 'string' && compiledUrl.indexOf('{{') >= 0 && options && options.route && options.route.params && Object.keys(options.route.params).length) {\n      Object.keys(options.route.params).forEach(function (paramName) {\n        var regExp = new RegExp(\"{{\" + paramName + \"}}\", 'g');\n        compiledUrl = compiledUrl.replace(regExp, options.route.params[paramName] || '');\n      });\n    }\n\n    return compiledUrl;\n  };\n\n  _proto.removeFromXhrCache = function removeFromXhrCache(url) {\n    var router = this;\n    var xhrCache = router.cache.xhr;\n    var index = false;\n\n    for (var i = 0; i < xhrCache.length; i += 1) {\n      if (xhrCache[i].url === url) index = i;\n    }\n\n    if (index !== false) xhrCache.splice(index, 1);\n  };\n\n  _proto.xhrRequest = function xhrRequest(requestUrl, options) {\n    var router = this;\n    var params = router.params;\n    var ignoreCache = options.ignoreCache;\n    var url = requestUrl;\n    var hasQuery = url.indexOf('?') >= 0;\n\n    if (params.passRouteQueryToRequest && options && options.route && options.route.query && Object.keys(options.route.query).length) {\n      url += \"\" + (hasQuery ? '&' : '?') + serializeObject(options.route.query);\n      hasQuery = true;\n    }\n\n    if (params.passRouteParamsToRequest && options && options.route && options.route.params && Object.keys(options.route.params).length) {\n      url += \"\" + (hasQuery ? '&' : '?') + serializeObject(options.route.params);\n      hasQuery = true;\n    }\n\n    if (url.indexOf('{{') >= 0) {\n      url = router.replaceRequestUrlParams(url, options);\n    } // should we ignore get params or not\n\n\n    if (params.xhrCacheIgnoreGetParameters && url.indexOf('?') >= 0) {\n      url = url.split('?')[0];\n    }\n\n    return new Promise(function (resolve, reject) {\n      if (params.xhrCache && !ignoreCache && url.indexOf('nocache') < 0 && params.xhrCacheIgnore.indexOf(url) < 0) {\n        for (var i = 0; i < router.cache.xhr.length; i += 1) {\n          var cachedUrl = router.cache.xhr[i];\n\n          if (cachedUrl.url === url) {\n            // Check expiration\n            if (now() - cachedUrl.time < params.xhrCacheDuration) {\n              // Load from cache\n              resolve(cachedUrl.content);\n              return;\n            }\n          }\n        }\n      }\n\n      router.xhrAbortController = router.app.request.abortController();\n      router.app.request({\n        abortController: router.xhrAbortController,\n        url: url,\n        method: 'GET',\n        beforeSend: function beforeSend(xhr) {\n          router.emit('routerAjaxStart', xhr, options);\n        },\n        complete: function complete(xhr, status) {\n          router.emit('routerAjaxComplete', xhr);\n\n          if (status !== 'error' && status !== 'timeout' && xhr.status >= 200 && xhr.status < 300 || xhr.status === 0) {\n            if (params.xhrCache && xhr.responseText !== '') {\n              router.removeFromXhrCache(url);\n              router.cache.xhr.push({\n                url: url,\n                time: now(),\n                content: xhr.responseText\n              });\n            }\n\n            router.emit('routerAjaxSuccess', xhr, options);\n            resolve(xhr.responseText);\n          } else {\n            router.emit('routerAjaxError', xhr, options);\n            reject(xhr);\n          }\n        },\n        error: function error(xhr) {\n          router.emit('routerAjaxError', xhr, options);\n          reject(xhr);\n        }\n      });\n    });\n  };\n\n  _proto.setNavbarPosition = function setNavbarPosition($el, position, ariaHidden) {\n    var router = this;\n    $el.removeClass('navbar-previous navbar-current navbar-next');\n\n    if (position) {\n      $el.addClass(\"navbar-\" + position);\n    }\n\n    if (ariaHidden === false) {\n      $el.removeAttr('aria-hidden');\n    } else if (ariaHidden === true) {\n      $el.attr('aria-hidden', 'true');\n    }\n\n    $el.trigger('navbar:position', {\n      position: position\n    });\n    router.emit('navbarPosition', $el[0], position);\n  };\n\n  _proto.setPagePosition = function setPagePosition($el, position, ariaHidden) {\n    var router = this;\n    $el.removeClass('page-previous page-current page-next');\n    $el.addClass(\"page-\" + position);\n\n    if (ariaHidden === false) {\n      $el.removeAttr('aria-hidden');\n    } else if (ariaHidden === true) {\n      $el.attr('aria-hidden', 'true');\n    }\n\n    $el.trigger('page:position', {\n      position: position\n    });\n    router.emit('pagePosition', $el[0], position);\n  } // Remove theme elements\n  ;\n\n  _proto.removeThemeElements = function removeThemeElements(el) {\n    var router = this;\n    var theme = router.app.theme;\n    var toRemove;\n\n    if (theme === 'ios') {\n      toRemove = '.md-only, .aurora-only, .if-md, .if-aurora, .if-not-ios, .not-ios';\n    } else if (theme === 'md') {\n      toRemove = '.ios-only, .aurora-only, .if-ios, .if-aurora, .if-not-md, .not-md';\n    } else if (theme === 'aurora') {\n      toRemove = '.ios-only, .md-only, .if-ios, .if-md, .if-not-aurora, .not-aurora';\n    }\n\n    $(el).find(toRemove).remove();\n  };\n\n  _proto.getPageData = function getPageData(pageEl, navbarEl, from, to, route, pageFromEl) {\n    if (route === void 0) {\n      route = {};\n    }\n\n    var router = this;\n    var $pageEl = $(pageEl).eq(0);\n    var $navbarEl = $(navbarEl).eq(0);\n    var currentPage = $pageEl[0].f7Page || {};\n    var direction;\n    var pageFrom;\n    if (from === 'next' && to === 'current' || from === 'current' && to === 'previous') direction = 'forward';\n    if (from === 'current' && to === 'next' || from === 'previous' && to === 'current') direction = 'backward';\n\n    if (currentPage && !currentPage.fromPage) {\n      var $pageFromEl = $(pageFromEl);\n\n      if ($pageFromEl.length) {\n        pageFrom = $pageFromEl[0].f7Page;\n      }\n    }\n\n    pageFrom = currentPage.pageFrom || pageFrom;\n\n    if (pageFrom && pageFrom.pageFrom) {\n      pageFrom.pageFrom = null;\n    }\n\n    var page = {\n      app: router.app,\n      view: router.view,\n      router: router,\n      $el: $pageEl,\n      el: $pageEl[0],\n      $pageEl: $pageEl,\n      pageEl: $pageEl[0],\n      $navbarEl: $navbarEl,\n      navbarEl: $navbarEl[0],\n      name: $pageEl.attr('data-name'),\n      position: from,\n      from: from,\n      to: to,\n      direction: direction,\n      route: currentPage.route ? currentPage.route : route,\n      pageFrom: pageFrom\n    };\n    $pageEl[0].f7Page = page;\n    return page;\n  } // Callbacks\n  ;\n\n  _proto.pageCallback = function pageCallback(callback, pageEl, navbarEl, from, to, options, pageFromEl) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!pageEl) return;\n    var router = this;\n    var $pageEl = $(pageEl);\n    if (!$pageEl.length) return;\n    var $navbarEl = $(navbarEl);\n    var _options = options,\n        route = _options.route;\n    var restoreScrollTopOnBack = router.params.restoreScrollTopOnBack && !(router.params.masterDetailBreakpoint > 0 && $pageEl.hasClass('page-master') && router.app.width >= router.params.masterDetailBreakpoint);\n    var keepAlive = $pageEl[0].f7Page && $pageEl[0].f7Page.route && $pageEl[0].f7Page.route.route && $pageEl[0].f7Page.route.route.keepAlive;\n\n    if (callback === 'beforeRemove' && keepAlive) {\n      callback = 'beforeUnmount'; // eslint-disable-line\n    }\n\n    var camelName = \"page\" + (callback[0].toUpperCase() + callback.slice(1, callback.length));\n    var colonName = \"page:\" + callback.toLowerCase();\n    var page = {};\n\n    if (callback === 'beforeRemove' && $pageEl[0].f7Page) {\n      page = extend($pageEl[0].f7Page, {\n        from: from,\n        to: to,\n        position: from\n      });\n    } else {\n      page = router.getPageData($pageEl[0], $navbarEl[0], from, to, route, pageFromEl);\n    }\n\n    page.swipeBack = !!options.swipeBack;\n\n    var _ref2 = options.route ? options.route.route : {},\n        _ref2$on = _ref2.on,\n        on = _ref2$on === void 0 ? {} : _ref2$on,\n        _ref2$once = _ref2.once,\n        once = _ref2$once === void 0 ? {} : _ref2$once;\n\n    if (options.on) {\n      extend(on, options.on);\n    }\n\n    if (options.once) {\n      extend(once, options.once);\n    }\n\n    function attachEvents() {\n      if ($pageEl[0].f7RouteEventsAttached) return;\n      $pageEl[0].f7RouteEventsAttached = true;\n\n      if (on && Object.keys(on).length > 0) {\n        $pageEl[0].f7RouteEventsOn = on;\n        Object.keys(on).forEach(function (eventName) {\n          on[eventName] = on[eventName].bind(router);\n          $pageEl.on(eventNameToColonCase(eventName), on[eventName]);\n        });\n      }\n\n      if (once && Object.keys(once).length > 0) {\n        $pageEl[0].f7RouteEventsOnce = once;\n        Object.keys(once).forEach(function (eventName) {\n          once[eventName] = once[eventName].bind(router);\n          $pageEl.once(eventNameToColonCase(eventName), once[eventName]);\n        });\n      }\n    }\n\n    function detachEvents() {\n      if (!$pageEl[0].f7RouteEventsAttached) return;\n\n      if ($pageEl[0].f7RouteEventsOn) {\n        Object.keys($pageEl[0].f7RouteEventsOn).forEach(function (eventName) {\n          $pageEl.off(eventNameToColonCase(eventName), $pageEl[0].f7RouteEventsOn[eventName]);\n        });\n      }\n\n      if ($pageEl[0].f7RouteEventsOnce) {\n        Object.keys($pageEl[0].f7RouteEventsOnce).forEach(function (eventName) {\n          $pageEl.off(eventNameToColonCase(eventName), $pageEl[0].f7RouteEventsOnce[eventName]);\n        });\n      }\n\n      $pageEl[0].f7RouteEventsAttached = null;\n      $pageEl[0].f7RouteEventsOn = null;\n      $pageEl[0].f7RouteEventsOnce = null;\n      delete $pageEl[0].f7RouteEventsAttached;\n      delete $pageEl[0].f7RouteEventsOn;\n      delete $pageEl[0].f7RouteEventsOnce;\n    }\n\n    if (callback === 'mounted') {\n      attachEvents();\n    }\n\n    if (callback === 'init') {\n      if (restoreScrollTopOnBack && (from === 'previous' || !from) && to === 'current' && router.scrollHistory[page.route.url] && !$pageEl.hasClass('no-restore-scroll')) {\n        var $pageContent = $pageEl.find('.page-content');\n\n        if ($pageContent.length > 0) {\n          // eslint-disable-next-line\n          $pageContent = $pageContent.filter(function (pageContentEl) {\n            return $(pageContentEl).parents('.tab:not(.tab-active)').length === 0 && !$(pageContentEl).is('.tab:not(.tab-active)');\n          });\n        }\n\n        $pageContent.scrollTop(router.scrollHistory[page.route.url]);\n      }\n\n      attachEvents();\n\n      if ($pageEl[0].f7PageInitialized) {\n        $pageEl.trigger('page:reinit', page);\n        router.emit('pageReinit', page);\n        return;\n      }\n\n      $pageEl[0].f7PageInitialized = true;\n    }\n\n    if (restoreScrollTopOnBack && callback === 'beforeOut' && from === 'current' && to === 'previous') {\n      // Save scroll position\n      var _$pageContent = $pageEl.find('.page-content');\n\n      if (_$pageContent.length > 0) {\n        // eslint-disable-next-line\n        _$pageContent = _$pageContent.filter(function (pageContentEl) {\n          return $(pageContentEl).parents('.tab:not(.tab-active)').length === 0 && !$(pageContentEl).is('.tab:not(.tab-active)');\n        });\n      }\n\n      router.scrollHistory[page.route.url] = _$pageContent.scrollTop();\n    }\n\n    if (restoreScrollTopOnBack && callback === 'beforeOut' && from === 'current' && to === 'next') {\n      // Delete scroll position\n      delete router.scrollHistory[page.route.url];\n    }\n\n    $pageEl.trigger(colonName, page);\n    router.emit(camelName, page);\n\n    if (callback === 'beforeRemove' || callback === 'beforeUnmount') {\n      detachEvents();\n\n      if (!keepAlive) {\n        if ($pageEl[0].f7Page && $pageEl[0].f7Page.navbarEl) {\n          delete $pageEl[0].f7Page.navbarEl.f7Page;\n        }\n\n        $pageEl[0].f7Page = null;\n      }\n    }\n  };\n\n  _proto.saveHistory = function saveHistory() {\n    var router = this;\n    var window = getWindow();\n    router.view.history = router.history;\n\n    if (router.params.browserHistory && router.params.browserHistoryStoreHistory && window.localStorage) {\n      window.localStorage[\"f7router-\" + router.view.id + \"-history\"] = JSON.stringify(router.history);\n    }\n  };\n\n  _proto.restoreHistory = function restoreHistory() {\n    var router = this;\n    var window = getWindow();\n\n    if (router.params.browserHistory && router.params.browserHistoryStoreHistory && window.localStorage && window.localStorage[\"f7router-\" + router.view.id + \"-history\"]) {\n      router.history = JSON.parse(window.localStorage[\"f7router-\" + router.view.id + \"-history\"]);\n      router.view.history = router.history;\n    }\n  };\n\n  _proto.clearHistory = function clearHistory() {\n    var router = this;\n    router.history = [];\n    if (router.view) router.view.history = [];\n    router.saveHistory();\n  };\n\n  _proto.updateCurrentUrl = function updateCurrentUrl(newUrl) {\n    var router = this;\n    appRouterCheck(router, 'updateCurrentUrl'); // Update history\n\n    if (router.history.length) {\n      router.history[router.history.length - 1] = newUrl;\n    } else {\n      router.history.push(newUrl);\n    } // Update current route params\n\n\n    var _router$parseRouteUrl2 = router.parseRouteUrl(newUrl),\n        query = _router$parseRouteUrl2.query,\n        hash = _router$parseRouteUrl2.hash,\n        params = _router$parseRouteUrl2.params,\n        url = _router$parseRouteUrl2.url,\n        path = _router$parseRouteUrl2.path;\n\n    if (router.currentRoute) {\n      extend(router.currentRoute, {\n        query: query,\n        hash: hash,\n        params: params,\n        url: url,\n        path: path\n      });\n    }\n\n    if (router.params.browserHistory) {\n      var browserHistoryRoot = router.params.browserHistoryRoot || '';\n      History.replace(router.view.id, {\n        url: newUrl\n      }, browserHistoryRoot + router.params.browserHistorySeparator + newUrl);\n    } // Save History\n\n\n    router.saveHistory();\n    router.emit('routeUrlUpdate', router.currentRoute, router);\n  };\n\n  _proto.getInitialUrl = function getInitialUrl() {\n    var router = this;\n\n    if (router.initialUrl) {\n      return {\n        initialUrl: router.initialUrl,\n        historyRestored: router.historyRestored\n      };\n    }\n\n    var app = router.app,\n        view = router.view;\n    var document = getDocument();\n    var window = getWindow();\n    var location = app.params.url && typeof app.params.url === 'string' && typeof URL !== 'undefined' ? new URL(app.params.url) : document.location;\n    var initialUrl = router.params.url;\n    var documentUrl = location.href.split(location.origin)[1];\n    var historyRestored;\n    var _router$params = router.params,\n        browserHistory = _router$params.browserHistory,\n        browserHistoryOnLoad = _router$params.browserHistoryOnLoad,\n        browserHistorySeparator = _router$params.browserHistorySeparator;\n    var browserHistoryRoot = router.params.browserHistoryRoot;\n\n    if ((window.cordova || window.Capacitor && window.Capacitor.isNative) && browserHistory && !browserHistorySeparator && !browserHistoryRoot && location.pathname.indexOf('index.html')) {\n      // eslint-disable-next-line\n      console.warn('Framework7: wrong or not complete browserHistory configuration, trying to guess browserHistoryRoot');\n      browserHistoryRoot = location.pathname.split('index.html')[0];\n    }\n\n    if (!browserHistory || !browserHistoryOnLoad) {\n      if (!initialUrl) {\n        initialUrl = documentUrl;\n      }\n\n      if (location.search && initialUrl.indexOf('?') < 0) {\n        initialUrl += location.search;\n      }\n\n      if (location.hash && initialUrl.indexOf('#') < 0) {\n        initialUrl += location.hash;\n      }\n    } else {\n      if (browserHistoryRoot && documentUrl.indexOf(browserHistoryRoot) >= 0) {\n        documentUrl = documentUrl.split(browserHistoryRoot)[1];\n        if (documentUrl === '') documentUrl = '/';\n      }\n\n      if (browserHistorySeparator.length > 0 && documentUrl.indexOf(browserHistorySeparator) >= 0) {\n        initialUrl = documentUrl.split(browserHistorySeparator)[1];\n      } else {\n        initialUrl = documentUrl;\n      }\n\n      router.restoreHistory();\n\n      if (router.history.indexOf(initialUrl) >= 0) {\n        router.history = router.history.slice(0, router.history.indexOf(initialUrl) + 1);\n      } else if (router.params.url === initialUrl) {\n        router.history = [initialUrl];\n      } else if (History.state && History.state[view.id] && History.state[view.id].url === router.history[router.history.length - 1]) {\n        initialUrl = router.history[router.history.length - 1];\n      } else {\n        router.history = [documentUrl.split(browserHistorySeparator)[0] || '/', initialUrl];\n      }\n\n      if (router.history.length > 1) {\n        historyRestored = true;\n      } else {\n        router.history = [];\n      }\n\n      router.saveHistory();\n    }\n\n    router.initialUrl = initialUrl;\n    router.historyRestored = historyRestored;\n    return {\n      initialUrl: initialUrl,\n      historyRestored: historyRestored\n    };\n  };\n\n  _proto.init = function init() {\n    var router = this;\n    var app = router.app,\n        view = router.view;\n    var document = getDocument();\n    router.mount();\n\n    var _router$getInitialUrl = router.getInitialUrl(),\n        initialUrl = _router$getInitialUrl.initialUrl,\n        historyRestored = _router$getInitialUrl.historyRestored; // Init Swipeback\n\n\n    if (view && router.params.iosSwipeBack && app.theme === 'ios' || view && router.params.mdSwipeBack && app.theme === 'md' || view && router.params.auroraSwipeBack && app.theme === 'aurora') {\n      SwipeBack(router);\n    }\n\n    var _router$params2 = router.params,\n        browserHistory = _router$params2.browserHistory,\n        browserHistoryOnLoad = _router$params2.browserHistoryOnLoad,\n        browserHistoryAnimateOnLoad = _router$params2.browserHistoryAnimateOnLoad,\n        browserHistoryInitialMatch = _router$params2.browserHistoryInitialMatch;\n    var currentRoute;\n\n    if (router.history.length > 1) {\n      // Will load page\n      var initUrl = browserHistoryInitialMatch ? initialUrl : router.history[0];\n      currentRoute = router.findMatchingRoute(initUrl);\n\n      if (!currentRoute) {\n        currentRoute = extend(router.parseRouteUrl(initUrl), {\n          route: {\n            url: initUrl,\n            path: initUrl.split('?')[0]\n          }\n        });\n      }\n    } else {\n      // Don't load page\n      currentRoute = router.findMatchingRoute(initialUrl);\n\n      if (!currentRoute) {\n        currentRoute = extend(router.parseRouteUrl(initialUrl), {\n          route: {\n            url: initialUrl,\n            path: initialUrl.split('?')[0]\n          }\n        });\n      }\n    }\n\n    if (router.params.stackPages) {\n      router.$el.children('.page').each(function (pageEl) {\n        var $pageEl = $(pageEl);\n        router.initialPages.push($pageEl[0]);\n\n        if (router.dynamicNavbar && $pageEl.children('.navbar').length > 0) {\n          router.initialNavbars.push($pageEl.children('.navbar')[0]);\n        }\n      });\n    }\n\n    if (router.$el.children('.page:not(.stacked)').length === 0 && initialUrl && router.params.loadInitialPage) {\n      // No pages presented in DOM, reload new page\n      router.navigate(initialUrl, {\n        initial: true,\n        reloadCurrent: true,\n        browserHistory: false,\n        animate: false,\n        once: {\n          modalOpen: function modalOpen() {\n            if (!historyRestored) return;\n            var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n            if (preloadPreviousPage && router.history.length > 1) {\n              router.back({\n                preload: true\n              });\n            }\n          },\n          pageAfterIn: function pageAfterIn() {\n            if (!historyRestored) return;\n            var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n            if (preloadPreviousPage && router.history.length > 1) {\n              router.back({\n                preload: true\n              });\n            }\n          }\n        }\n      });\n    } else if (router.$el.children('.page:not(.stacked)').length) {\n      // Init current DOM page\n      var hasTabRoute;\n      router.currentRoute = currentRoute;\n      router.$el.children('.page:not(.stacked)').each(function (pageEl) {\n        var $pageEl = $(pageEl);\n        var $navbarEl;\n        router.setPagePosition($pageEl, 'current');\n\n        if (router.dynamicNavbar) {\n          $navbarEl = $pageEl.children('.navbar');\n\n          if ($navbarEl.length > 0) {\n            if (!router.$navbarsEl.parents(document).length) {\n              router.$el.prepend(router.$navbarsEl);\n            }\n\n            router.setNavbarPosition($navbarEl, 'current');\n            router.$navbarsEl.append($navbarEl);\n\n            if ($navbarEl.children('.title-large').length) {\n              $navbarEl.addClass('navbar-large');\n            }\n\n            $pageEl.children('.navbar').remove();\n          } else {\n            router.$navbarsEl.addClass('navbar-hidden');\n\n            if ($navbarEl.children('.title-large').length) {\n              router.$navbarsEl.addClass('navbar-hidden navbar-large-hidden');\n            }\n          }\n        }\n\n        if (router.currentRoute && router.currentRoute.route && (router.currentRoute.route.master === true || typeof router.currentRoute.route.master === 'function' && router.currentRoute.route.master(app, router)) && router.params.masterDetailBreakpoint > 0) {\n          $pageEl.addClass('page-master');\n          $pageEl.trigger('page:role', {\n            role: 'master'\n          });\n\n          if ($navbarEl && $navbarEl.length) {\n            $navbarEl.addClass('navbar-master');\n          }\n\n          view.checkMasterDetailBreakpoint();\n        }\n\n        var initOptions = {\n          route: router.currentRoute\n        };\n\n        if (router.currentRoute && router.currentRoute.route && router.currentRoute.route.options) {\n          extend(initOptions, router.currentRoute.route.options);\n        }\n\n        router.currentPageEl = $pageEl[0];\n\n        if (router.dynamicNavbar && $navbarEl.length) {\n          router.currentNavbarEl = $navbarEl[0];\n        }\n\n        router.removeThemeElements($pageEl);\n\n        if (router.dynamicNavbar && $navbarEl.length) {\n          router.removeThemeElements($navbarEl);\n        }\n\n        if (initOptions.route.route.tab) {\n          hasTabRoute = true;\n          router.tabLoad(initOptions.route.route.tab, extend({}, initOptions));\n        }\n\n        router.pageCallback('init', $pageEl, $navbarEl, 'current', undefined, initOptions);\n        router.pageCallback('beforeIn', $pageEl, $navbarEl, 'current', undefined, initOptions);\n        router.pageCallback('afterIn', $pageEl, $navbarEl, 'current', undefined, initOptions);\n      });\n\n      if (historyRestored) {\n        if (browserHistoryInitialMatch) {\n          var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n          if (preloadPreviousPage && router.history.length > 1) {\n            router.back({\n              preload: true\n            });\n          }\n        } else {\n          router.navigate(initialUrl, {\n            initial: true,\n            browserHistory: false,\n            history: false,\n            animate: browserHistoryAnimateOnLoad,\n            once: {\n              pageAfterIn: function pageAfterIn() {\n                var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n                if (preloadPreviousPage && router.history.length > 2) {\n                  router.back({\n                    preload: true\n                  });\n                }\n              }\n            }\n          });\n        }\n      }\n\n      if (!historyRestored && !hasTabRoute) {\n        router.history.push(initialUrl);\n        router.saveHistory();\n      }\n    }\n\n    if (initialUrl && browserHistory && browserHistoryOnLoad && (!History.state || !History.state[view.id])) {\n      History.initViewState(view.id, {\n        url: initialUrl\n      });\n    }\n\n    router.emit('local::init routerInit', router);\n  };\n\n  _proto.destroy = function destroy() {\n    var router = this;\n    router.emit('local::destroy routerDestroy', router); // Delete props & methods\n\n    Object.keys(router).forEach(function (routerProp) {\n      router[routerProp] = null;\n      delete router[routerProp];\n    });\n    router = null;\n  };\n\n  return Router;\n}(Framework7Class); // Load\n\n\nRouter.prototype.navigate = navigate;\nRouter.prototype.refreshPage = refreshPage; // Tab\n\nRouter.prototype.tabLoad = tabLoad;\nRouter.prototype.tabRemove = tabRemove; // Modal\n\nRouter.prototype.modalLoad = modalLoad;\nRouter.prototype.modalRemove = modalRemove; // Back\n\nRouter.prototype.back = back; // Clear history\n\nRouter.prototype.clearPreviousHistory = clearPreviousHistory;\nexport default Router;","map":{"version":3,"sources":["E:/Programming/React/rashiApp/node_modules/framework7/esm/modules/router/router-class.js"],"names":["_assertThisInitialized","self","ReferenceError","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","__proto__","getWindow","getDocument","pathToRegexp","compile","$","Framework7Class","extend","nextFrame","parseUrlQuery","serializeObject","now","eventNameToColonCase","History","SwipeBack","refreshPage","navigate","tabLoad","tabRemove","modalLoad","modalRemove","back","clearPreviousHistory","appRouterCheck","Router","_Framework7Class","app","view","_this","call","router","isAppRouter","params","routes","cache","viewId","id","routerId","history","scrollHistory","dynamicNavbar","theme","iosDynamicNavbar","initialPages","initialNavbars","useModules","allowPageChange","currentRoute","previousRoute","defineProperty","enumerable","configurable","set","newRoute","url","emit","get","_proto","mount","document","tempDom","createElement","$el","el","$navbarsEl","navbarsEl","animatableNavElements","$newNavbarEl","$oldNavbarEl","toLarge","fromLarge","direction","animateIcon","iosAnimateNavbarBackIcon","newNavEls","oldNavEls","animatableNavEl","$navbarInner","isSliding","hasClass","isSubnavbar","needsOpacityTransition","$iconEl","find","isIconLabel","length","next","leftOffset","f7NavbarLeftOffset","rightOffset","f7NavbarRightOffset","children","each","navEl","$navEl","push","masterDetailBreakpoint","width","forEach","navEls","n","otherEls","otherNavEl","iconTextEl","offsetLeft","animate","$oldPageEl","$newPageEl","transition","callback","animateCustom","apply","ios","routerCustomTransitionClass","onCustomTransitionDone","removeClass","prepend","animationEnd","setNavbarPosition","addClass","routerTransitionClass","toDifferent","oldIsLarge","newIsLarge","betweenMasterAndDetail","animateNavbars","progress","offset","style","setProperty","transform","onDone","_clientLeft","clientLeft","removeModal","modalEl","removeEl","removeTabContent","tabEl","$tabEl","html","removeNavbar","removePage","f7Page","route","keepAlive","remove","tabChild","f7Component","trigger","destroy","removeElements","removeElementsWithTimeout","setTimeout","removeElementsTimeout","getPageEl","content","innerHTML","append","findElement","stringSelector","container","notStacked","modalsSelector","$container","selector","found","filter","parents","viewMainClass","undefined","flattenRoutes","flattenedRoutes","hasTabRoutes","tabs","mergedPathsRoutes","map","tabRoute","tRoute","path","replace","parentPath","tab","concat","_mergedPathsRoutes","detailRoutes","detailRoute","dRoute","masterRoute","masterRoutePath","_mergedPathsRoutes2","childRoute","cRoute","parseRouteUrl","query","hash","split","generateUrl","parameters","_parameters","name","Error","findRouteByKey","constructRouteUrl","_temp","_ref","toUrl","error","toString","findTabRoute","tabId","attr","foundTabRoute","key","value","matchingRoute","findMatchingRoute","_router$parseRouteUrl","keys","pathsToMatch","alias","Array","isArray","aliasPath","matched","pathToMatch","exec","keyObj","index","paramValue","decodeURIComponent","slice","join","replaceRequestUrlParams","options","compiledUrl","indexOf","paramName","regExp","RegExp","removeFromXhrCache","xhrCache","xhr","i","splice","xhrRequest","requestUrl","ignoreCache","hasQuery","passRouteQueryToRequest","passRouteParamsToRequest","xhrCacheIgnoreGetParameters","Promise","resolve","reject","xhrCacheIgnore","cachedUrl","time","xhrCacheDuration","xhrAbortController","request","abortController","method","beforeSend","complete","status","responseText","position","ariaHidden","removeAttr","setPagePosition","removeThemeElements","toRemove","getPageData","pageEl","navbarEl","from","to","pageFromEl","$pageEl","eq","$navbarEl","currentPage","pageFrom","fromPage","$pageFromEl","page","pageCallback","_options","restoreScrollTopOnBack","camelName","toUpperCase","colonName","toLowerCase","swipeBack","_ref2","_ref2$on","on","_ref2$once","once","attachEvents","f7RouteEventsAttached","f7RouteEventsOn","eventName","bind","f7RouteEventsOnce","detachEvents","off","$pageContent","pageContentEl","is","scrollTop","f7PageInitialized","_$pageContent","saveHistory","window","browserHistory","browserHistoryStoreHistory","localStorage","JSON","stringify","restoreHistory","parse","clearHistory","updateCurrentUrl","newUrl","_router$parseRouteUrl2","browserHistoryRoot","browserHistorySeparator","getInitialUrl","initialUrl","historyRestored","location","URL","documentUrl","href","origin","_router$params","browserHistoryOnLoad","cordova","Capacitor","isNative","pathname","console","warn","search","state","init","_router$getInitialUrl","iosSwipeBack","mdSwipeBack","auroraSwipeBack","_router$params2","browserHistoryAnimateOnLoad","browserHistoryInitialMatch","initUrl","stackPages","loadInitialPage","initial","reloadCurrent","modalOpen","preloadPreviousPage","preload","pageAfterIn","hasTabRoute","master","role","checkMasterDetailBreakpoint","initOptions","currentPageEl","currentNavbarEl","initViewState","routerProp"],"mappings":"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","sourcesContent":["function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nimport { getWindow, getDocument } from 'ssr-window';\nimport { pathToRegexp, compile } from 'path-to-regexp';\nimport $ from '../../shared/dom7';\nimport Framework7Class from '../../shared/class';\nimport { extend, nextFrame, parseUrlQuery, serializeObject, now, eventNameToColonCase } from '../../shared/utils';\nimport History from '../../shared/history';\nimport SwipeBack from './swipe-back';\nimport { refreshPage, navigate } from './navigate';\nimport { tabLoad, tabRemove } from './tab';\nimport { modalLoad, modalRemove } from './modal';\nimport { back } from './back';\nimport { clearPreviousHistory } from './clear-previous-history';\nimport appRouterCheck from './app-router-check';\n\nvar Router = /*#__PURE__*/function (_Framework7Class) {\n  _inheritsLoose(Router, _Framework7Class);\n\n  function Router(app, view) {\n    var _this;\n\n    _this = _Framework7Class.call(this, {}, [typeof view === 'undefined' ? app : view]) || this;\n\n    var router = _assertThisInitialized(_this); // Is App Router\n\n\n    router.isAppRouter = typeof view === 'undefined';\n\n    if (router.isAppRouter) {\n      // App Router\n      extend(false, router, {\n        app: app,\n        params: app.params.view,\n        routes: app.routes || [],\n        cache: app.cache\n      });\n    } else {\n      // View Router\n      extend(false, router, {\n        app: app,\n        view: view,\n        viewId: view.id,\n        id: view.params.routerId,\n        params: view.params,\n        routes: view.routes,\n        history: view.history,\n        scrollHistory: view.scrollHistory,\n        cache: app.cache,\n        dynamicNavbar: app.theme === 'ios' && view.params.iosDynamicNavbar,\n        initialPages: [],\n        initialNavbars: []\n      });\n    } // Install Modules\n\n\n    router.useModules(); // AllowPageChage\n\n    router.allowPageChange = true; // Current Route\n\n    var currentRoute = {};\n    var previousRoute = {};\n    Object.defineProperty(router, 'currentRoute', {\n      enumerable: true,\n      configurable: true,\n      set: function set(newRoute) {\n        if (newRoute === void 0) {\n          newRoute = {};\n        }\n\n        previousRoute = extend({}, currentRoute);\n        currentRoute = newRoute;\n        if (!currentRoute) return;\n        router.url = currentRoute.url;\n        router.emit('routeChange', newRoute, previousRoute, router);\n      },\n      get: function get() {\n        return currentRoute;\n      }\n    });\n    Object.defineProperty(router, 'previousRoute', {\n      enumerable: true,\n      configurable: true,\n      get: function get() {\n        return previousRoute;\n      },\n      set: function set(newRoute) {\n        previousRoute = newRoute;\n      }\n    });\n    return router || _assertThisInitialized(_this);\n  }\n\n  var _proto = Router.prototype;\n\n  _proto.mount = function mount() {\n    var router = this;\n    var view = router.view;\n    var document = getDocument();\n    extend(false, router, {\n      tempDom: document.createElement('div'),\n      $el: view.$el,\n      el: view.el,\n      $navbarsEl: view.$navbarsEl,\n      navbarsEl: view.navbarsEl\n    });\n    router.emit('local::mount routerMount', router);\n  };\n\n  _proto.animatableNavElements = function animatableNavElements($newNavbarEl, $oldNavbarEl, toLarge, fromLarge, direction) {\n    var router = this;\n    var dynamicNavbar = router.dynamicNavbar;\n    var animateIcon = router.params.iosAnimateNavbarBackIcon;\n    var newNavEls;\n    var oldNavEls;\n\n    function animatableNavEl($el, $navbarInner) {\n      var isSliding = $el.hasClass('sliding') || $navbarInner.hasClass('sliding');\n      var isSubnavbar = $el.hasClass('subnavbar');\n      var needsOpacityTransition = isSliding ? !isSubnavbar : true;\n      var $iconEl = $el.find('.back .icon');\n      var isIconLabel;\n\n      if (isSliding && animateIcon && $el.hasClass('left') && $iconEl.length > 0 && $iconEl.next('span').length) {\n        $el = $iconEl.next('span'); // eslint-disable-line\n\n        isIconLabel = true;\n      }\n\n      return {\n        $el: $el,\n        isIconLabel: isIconLabel,\n        leftOffset: $el[0].f7NavbarLeftOffset,\n        rightOffset: $el[0].f7NavbarRightOffset,\n        isSliding: isSliding,\n        isSubnavbar: isSubnavbar,\n        needsOpacityTransition: needsOpacityTransition\n      };\n    }\n\n    if (dynamicNavbar) {\n      newNavEls = [];\n      oldNavEls = [];\n      $newNavbarEl.children('.navbar-inner').children('.left, .right, .title, .subnavbar').each(function (navEl) {\n        var $navEl = $(navEl);\n        if ($navEl.hasClass('left') && fromLarge && direction === 'forward') return;\n        if ($navEl.hasClass('title') && toLarge) return;\n        newNavEls.push(animatableNavEl($navEl, $newNavbarEl.children('.navbar-inner')));\n      });\n\n      if (!($oldNavbarEl.hasClass('navbar-master') && router.params.masterDetailBreakpoint > 0 && router.app.width >= router.params.masterDetailBreakpoint)) {\n        $oldNavbarEl.children('.navbar-inner').children('.left, .right, .title, .subnavbar').each(function (navEl) {\n          var $navEl = $(navEl);\n          if ($navEl.hasClass('left') && toLarge && !fromLarge && direction === 'forward') return;\n          if ($navEl.hasClass('left') && toLarge && direction === 'backward') return;\n\n          if ($navEl.hasClass('title') && fromLarge) {\n            return;\n          }\n\n          oldNavEls.push(animatableNavEl($navEl, $oldNavbarEl.children('.navbar-inner')));\n        });\n      }\n\n      [oldNavEls, newNavEls].forEach(function (navEls) {\n        navEls.forEach(function (navEl) {\n          var n = navEl;\n          var isSliding = navEl.isSliding,\n              $el = navEl.$el;\n          var otherEls = navEls === oldNavEls ? newNavEls : oldNavEls;\n          if (!(isSliding && $el.hasClass('title') && otherEls)) return;\n          otherEls.forEach(function (otherNavEl) {\n            if (otherNavEl.isIconLabel) {\n              var iconTextEl = otherNavEl.$el[0];\n              n.leftOffset += iconTextEl ? iconTextEl.offsetLeft || 0 : 0;\n            }\n          });\n        });\n      });\n    }\n\n    return {\n      newNavEls: newNavEls,\n      oldNavEls: oldNavEls\n    };\n  };\n\n  _proto.animate = function animate($oldPageEl, $newPageEl, $oldNavbarEl, $newNavbarEl, direction, transition, callback) {\n    var router = this;\n\n    if (router.params.animateCustom) {\n      router.params.animateCustom.apply(router, [$oldPageEl, $newPageEl, $oldNavbarEl, $newNavbarEl, direction, callback]);\n      return;\n    }\n\n    var dynamicNavbar = router.dynamicNavbar;\n    var ios = router.app.theme === 'ios';\n\n    if (transition) {\n      var routerCustomTransitionClass = \"router-transition-custom router-transition-\" + transition + \"-\" + direction; // Animate\n\n      var onCustomTransitionDone = function onCustomTransitionDone() {\n        router.$el.removeClass(routerCustomTransitionClass);\n\n        if (dynamicNavbar && router.$navbarsEl.length) {\n          if ($newNavbarEl) {\n            router.$navbarsEl.prepend($newNavbarEl);\n          }\n\n          if ($oldNavbarEl) {\n            router.$navbarsEl.prepend($oldNavbarEl);\n          }\n        }\n\n        if (callback) callback();\n      };\n\n      (direction === 'forward' ? $newPageEl : $oldPageEl).animationEnd(onCustomTransitionDone);\n\n      if (dynamicNavbar) {\n        if ($newNavbarEl && $newPageEl) {\n          router.setNavbarPosition($newNavbarEl, '');\n          $newNavbarEl.removeClass('navbar-next navbar-previous navbar-current');\n          $newPageEl.prepend($newNavbarEl);\n        }\n\n        if ($oldNavbarEl && $oldPageEl) {\n          router.setNavbarPosition($oldNavbarEl, '');\n          $oldNavbarEl.removeClass('navbar-next navbar-previous navbar-current');\n          $oldPageEl.prepend($oldNavbarEl);\n        }\n      }\n\n      router.$el.addClass(routerCustomTransitionClass);\n      return;\n    } // Router Animation class\n\n\n    var routerTransitionClass = \"router-transition-\" + direction + \" router-transition\";\n    var newNavEls;\n    var oldNavEls;\n    var fromLarge;\n    var toLarge;\n    var toDifferent;\n    var oldIsLarge;\n    var newIsLarge;\n\n    if (ios && dynamicNavbar) {\n      var betweenMasterAndDetail = router.params.masterDetailBreakpoint > 0 && router.app.width >= router.params.masterDetailBreakpoint && ($oldNavbarEl.hasClass('navbar-master') && $newNavbarEl.hasClass('navbar-master-detail') || $oldNavbarEl.hasClass('navbar-master-detail') && $newNavbarEl.hasClass('navbar-master'));\n\n      if (!betweenMasterAndDetail) {\n        oldIsLarge = $oldNavbarEl && $oldNavbarEl.hasClass('navbar-large');\n        newIsLarge = $newNavbarEl && $newNavbarEl.hasClass('navbar-large');\n        fromLarge = oldIsLarge && !$oldNavbarEl.hasClass('navbar-large-collapsed');\n        toLarge = newIsLarge && !$newNavbarEl.hasClass('navbar-large-collapsed');\n        toDifferent = fromLarge && !toLarge || toLarge && !fromLarge;\n      }\n\n      var navEls = router.animatableNavElements($newNavbarEl, $oldNavbarEl, toLarge, fromLarge, direction);\n      newNavEls = navEls.newNavEls;\n      oldNavEls = navEls.oldNavEls;\n    }\n\n    function animateNavbars(progress) {\n      if (!(ios && dynamicNavbar)) return;\n\n      if (progress === 1) {\n        if (toLarge) {\n          $newNavbarEl.addClass('router-navbar-transition-to-large');\n          $oldNavbarEl.addClass('router-navbar-transition-to-large');\n        }\n\n        if (fromLarge) {\n          $newNavbarEl.addClass('router-navbar-transition-from-large');\n          $oldNavbarEl.addClass('router-navbar-transition-from-large');\n        }\n      }\n\n      newNavEls.forEach(function (navEl) {\n        var $el = navEl.$el;\n        var offset = direction === 'forward' ? navEl.rightOffset : navEl.leftOffset;\n\n        if (navEl.isSliding) {\n          if (navEl.isSubnavbar && newIsLarge) {\n            // prettier-ignore\n            $el[0].style.setProperty('transform', \"translate3d(\" + offset * (1 - progress) + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\", 'important');\n          } else {\n            $el.transform(\"translate3d(\" + offset * (1 - progress) + \"px,0,0)\");\n          }\n        }\n      });\n      oldNavEls.forEach(function (navEl) {\n        var $el = navEl.$el;\n        var offset = direction === 'forward' ? navEl.leftOffset : navEl.rightOffset;\n\n        if (navEl.isSliding) {\n          if (navEl.isSubnavbar && oldIsLarge) {\n            $el.transform(\"translate3d(\" + offset * progress + \"px, calc(-1 * var(--f7-navbar-large-collapse-progress) * var(--f7-navbar-large-title-height)), 0)\");\n          } else {\n            $el.transform(\"translate3d(\" + offset * progress + \"px,0,0)\");\n          }\n        }\n      });\n    } // AnimationEnd Callback\n\n\n    function onDone() {\n      if (router.dynamicNavbar) {\n        if ($newNavbarEl) {\n          $newNavbarEl.removeClass('router-navbar-transition-to-large router-navbar-transition-from-large');\n          $newNavbarEl.addClass('navbar-no-title-large-transition');\n          nextFrame(function () {\n            $newNavbarEl.removeClass('navbar-no-title-large-transition');\n          });\n        }\n\n        if ($oldNavbarEl) {\n          $oldNavbarEl.removeClass('router-navbar-transition-to-large router-navbar-transition-from-large');\n        }\n\n        if ($newNavbarEl.hasClass('sliding') || $newNavbarEl.children('.navbar-inner.sliding').length) {\n          $newNavbarEl.find('.title, .left, .right, .left .icon, .subnavbar').transform('');\n        } else {\n          $newNavbarEl.find('.sliding').transform('');\n        }\n\n        if ($oldNavbarEl.hasClass('sliding') || $oldNavbarEl.children('.navbar-inner.sliding').length) {\n          $oldNavbarEl.find('.title, .left, .right, .left .icon, .subnavbar').transform('');\n        } else {\n          $oldNavbarEl.find('.sliding').transform('');\n        }\n      }\n\n      router.$el.removeClass(routerTransitionClass);\n      if (callback) callback();\n    }\n\n    (direction === 'forward' ? $newPageEl : $oldPageEl).animationEnd(function () {\n      onDone();\n    }); // Animate\n\n    if (dynamicNavbar) {\n      // Prepare Navbars\n      animateNavbars(0);\n      nextFrame(function () {\n        // Add class, start animation\n        router.$el.addClass(routerTransitionClass);\n\n        if (toDifferent) {\n          // eslint-disable-next-line\n          router.el._clientLeft = router.el.clientLeft;\n        }\n\n        animateNavbars(1);\n      });\n    } else {\n      // Add class, start animation\n      router.$el.addClass(routerTransitionClass);\n    }\n  };\n\n  _proto.removeModal = function removeModal(modalEl) {\n    var router = this;\n    router.removeEl(modalEl);\n  } // eslint-disable-next-line\n  ;\n\n  _proto.removeTabContent = function removeTabContent(tabEl) {\n    var $tabEl = $(tabEl);\n    $tabEl.html('');\n  };\n\n  _proto.removeNavbar = function removeNavbar(el) {\n    var router = this;\n    router.removeEl(el);\n  };\n\n  _proto.removePage = function removePage(el) {\n    var $el = $(el);\n    var f7Page = $el && $el[0] && $el[0].f7Page;\n    var router = this;\n\n    if (f7Page && f7Page.route && f7Page.route.route && f7Page.route.route.keepAlive) {\n      $el.remove();\n      return;\n    }\n\n    router.removeEl(el);\n  };\n\n  _proto.removeEl = function removeEl(el) {\n    if (!el) return;\n    var router = this;\n    var $el = $(el);\n    if ($el.length === 0) return;\n    $el.find('.tab').each(function (tabEl) {\n      $(tabEl).children().each(function (tabChild) {\n        if (tabChild.f7Component) {\n          $(tabChild).trigger('tab:beforeremove');\n          tabChild.f7Component.destroy();\n        }\n      });\n    });\n\n    if ($el[0].f7Component && $el[0].f7Component.destroy) {\n      $el[0].f7Component.destroy();\n    }\n\n    if (!router.params.removeElements) {\n      return;\n    }\n\n    if (router.params.removeElementsWithTimeout) {\n      setTimeout(function () {\n        $el.remove();\n      }, router.params.removeElementsTimeout);\n    } else {\n      $el.remove();\n    }\n  };\n\n  _proto.getPageEl = function getPageEl(content) {\n    var router = this;\n\n    if (typeof content === 'string') {\n      router.tempDom.innerHTML = content;\n    } else {\n      if ($(content).hasClass('page')) {\n        return content;\n      }\n\n      router.tempDom.innerHTML = '';\n      $(router.tempDom).append(content);\n    }\n\n    return router.findElement('.page', router.tempDom);\n  };\n\n  _proto.findElement = function findElement(stringSelector, container, notStacked) {\n    var router = this;\n    var view = router.view;\n    var app = router.app; // Modals Selector\n\n    var modalsSelector = '.popup, .dialog, .popover, .actions-modal, .sheet-modal, .login-screen, .page';\n    var $container = $(container);\n    var selector = stringSelector;\n    if (notStacked) selector += ':not(.stacked)';\n    var found = $container.find(selector).filter(function (el) {\n      return $(el).parents(modalsSelector).length === 0;\n    });\n\n    if (found.length > 1) {\n      if (typeof view.selector === 'string') {\n        // Search in related view\n        found = $container.find(view.selector + \" \" + selector);\n      }\n\n      if (found.length > 1) {\n        // Search in main view\n        found = $container.find(\".\" + app.params.viewMainClass + \" \" + selector);\n      }\n    }\n\n    if (found.length === 1) return found; // Try to find not stacked\n\n    if (!notStacked) found = router.findElement(selector, $container, true);\n    if (found && found.length === 1) return found;\n    if (found && found.length > 1) return $(found[0]);\n    return undefined;\n  };\n\n  _proto.flattenRoutes = function flattenRoutes(routes) {\n    if (routes === void 0) {\n      routes = this.routes;\n    }\n\n    var router = this;\n    var flattenedRoutes = [];\n    routes.forEach(function (route) {\n      var hasTabRoutes = false;\n\n      if ('tabs' in route && route.tabs) {\n        var mergedPathsRoutes = route.tabs.map(function (tabRoute) {\n          var tRoute = extend({}, route, {\n            path: (route.path + \"/\" + tabRoute.path).replace('///', '/').replace('//', '/'),\n            parentPath: route.path,\n            tab: tabRoute\n          });\n          delete tRoute.tabs;\n          delete tRoute.routes;\n          return tRoute;\n        });\n        hasTabRoutes = true;\n        flattenedRoutes = flattenedRoutes.concat(router.flattenRoutes(mergedPathsRoutes));\n      }\n\n      if ('detailRoutes' in route) {\n        var _mergedPathsRoutes = route.detailRoutes.map(function (detailRoute) {\n          var dRoute = extend({}, detailRoute);\n          dRoute.masterRoute = route;\n          dRoute.masterRoutePath = route.path;\n          return dRoute;\n        });\n\n        flattenedRoutes = flattenedRoutes.concat(route, router.flattenRoutes(_mergedPathsRoutes));\n      }\n\n      if ('routes' in route) {\n        var _mergedPathsRoutes2 = route.routes.map(function (childRoute) {\n          var cRoute = extend({}, childRoute);\n          cRoute.path = (route.path + \"/\" + cRoute.path).replace('///', '/').replace('//', '/');\n          return cRoute;\n        });\n\n        if (hasTabRoutes) {\n          flattenedRoutes = flattenedRoutes.concat(router.flattenRoutes(_mergedPathsRoutes2));\n        } else {\n          flattenedRoutes = flattenedRoutes.concat(route, router.flattenRoutes(_mergedPathsRoutes2));\n        }\n      }\n\n      if (!('routes' in route) && !('tabs' in route && route.tabs) && !('detailRoutes' in route)) {\n        flattenedRoutes.push(route);\n      }\n    });\n    return flattenedRoutes;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.parseRouteUrl = function parseRouteUrl(url) {\n    if (!url) return {};\n    var query = parseUrlQuery(url);\n    var hash = url.split('#')[1];\n    var params = {};\n    var path = url.split('#')[0].split('?')[0];\n    return {\n      query: query,\n      hash: hash,\n      params: params,\n      url: url,\n      path: path\n    };\n  };\n\n  _proto.generateUrl = function generateUrl(parameters) {\n    if (parameters === void 0) {\n      parameters = {};\n    }\n\n    if (typeof parameters === 'string') {\n      return parameters;\n    }\n\n    var _parameters = parameters,\n        name = _parameters.name,\n        path = _parameters.path,\n        params = _parameters.params,\n        query = _parameters.query;\n\n    if (!name && !path) {\n      throw new Error('Framework7: \"name\" or \"path\" parameter is required');\n    }\n\n    var router = this;\n    var route = name ? router.findRouteByKey('name', name) : router.findRouteByKey('path', path);\n\n    if (!route) {\n      if (name) {\n        throw new Error(\"Framework7: route with name \\\"\" + name + \"\\\" not found\");\n      } else {\n        throw new Error(\"Framework7: route with path \\\"\" + path + \"\\\" not found\");\n      }\n    }\n\n    var url = router.constructRouteUrl(route, {\n      params: params,\n      query: query\n    });\n\n    if (!url) {\n      throw new Error(\"Framework7: can't construct URL for route with name \\\"\" + name + \"\\\"\");\n    }\n\n    return url;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.constructRouteUrl = function constructRouteUrl(route, _temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        params = _ref.params,\n        query = _ref.query;\n\n    var path = route.path;\n    var toUrl = compile(path);\n    var url;\n\n    try {\n      url = toUrl(params || {});\n    } catch (error) {\n      throw new Error(\"Framework7: error constructing route URL from passed params:\\nRoute: \" + path + \"\\n\" + error.toString());\n    }\n\n    if (query) {\n      if (typeof query === 'string') url += \"?\" + query;else url += \"?\" + serializeObject(query);\n    }\n\n    return url;\n  };\n\n  _proto.findTabRoute = function findTabRoute(tabEl) {\n    var router = this;\n    var $tabEl = $(tabEl);\n    var parentPath = router.currentRoute.route.parentPath;\n    var tabId = $tabEl.attr('id');\n    var flattenedRoutes = router.flattenRoutes(router.routes);\n    var foundTabRoute;\n    flattenedRoutes.forEach(function (route) {\n      if (route.parentPath === parentPath && route.tab && route.tab.id === tabId) {\n        foundTabRoute = route;\n      }\n    });\n    return foundTabRoute;\n  };\n\n  _proto.findRouteByKey = function findRouteByKey(key, value) {\n    var router = this;\n    var routes = router.routes;\n    var flattenedRoutes = router.flattenRoutes(routes);\n    var matchingRoute;\n    flattenedRoutes.forEach(function (route) {\n      if (matchingRoute) return;\n\n      if (route[key] === value) {\n        matchingRoute = route;\n      }\n    });\n    return matchingRoute;\n  };\n\n  _proto.findMatchingRoute = function findMatchingRoute(url) {\n    if (!url) return undefined;\n    var router = this;\n    var routes = router.routes;\n    var flattenedRoutes = router.flattenRoutes(routes);\n\n    var _router$parseRouteUrl = router.parseRouteUrl(url),\n        path = _router$parseRouteUrl.path,\n        query = _router$parseRouteUrl.query,\n        hash = _router$parseRouteUrl.hash,\n        params = _router$parseRouteUrl.params;\n\n    var matchingRoute;\n    flattenedRoutes.forEach(function (route) {\n      if (matchingRoute) return;\n      var keys = [];\n      var pathsToMatch = [route.path];\n\n      if (route.alias) {\n        if (typeof route.alias === 'string') pathsToMatch.push(route.alias);else if (Array.isArray(route.alias)) {\n          route.alias.forEach(function (aliasPath) {\n            pathsToMatch.push(aliasPath);\n          });\n        }\n      }\n\n      var matched;\n      pathsToMatch.forEach(function (pathToMatch) {\n        if (matched) return;\n        matched = pathToRegexp(pathToMatch, keys).exec(path);\n      });\n\n      if (matched) {\n        keys.forEach(function (keyObj, index) {\n          if (typeof keyObj.name === 'number') return;\n          var paramValue = matched[index + 1];\n\n          if (typeof paramValue === 'undefined' || paramValue === null) {\n            params[keyObj.name] = paramValue;\n          } else {\n            params[keyObj.name] = decodeURIComponent(paramValue);\n          }\n        });\n        var parentPath;\n\n        if (route.parentPath) {\n          parentPath = path.split('/').slice(0, route.parentPath.split('/').length - 1).join('/');\n        }\n\n        matchingRoute = {\n          query: query,\n          hash: hash,\n          params: params,\n          url: url,\n          path: path,\n          parentPath: parentPath,\n          route: route,\n          name: route.name\n        };\n      }\n    });\n    return matchingRoute;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.replaceRequestUrlParams = function replaceRequestUrlParams(url, options) {\n    if (url === void 0) {\n      url = '';\n    }\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var compiledUrl = url;\n\n    if (typeof compiledUrl === 'string' && compiledUrl.indexOf('{{') >= 0 && options && options.route && options.route.params && Object.keys(options.route.params).length) {\n      Object.keys(options.route.params).forEach(function (paramName) {\n        var regExp = new RegExp(\"{{\" + paramName + \"}}\", 'g');\n        compiledUrl = compiledUrl.replace(regExp, options.route.params[paramName] || '');\n      });\n    }\n\n    return compiledUrl;\n  };\n\n  _proto.removeFromXhrCache = function removeFromXhrCache(url) {\n    var router = this;\n    var xhrCache = router.cache.xhr;\n    var index = false;\n\n    for (var i = 0; i < xhrCache.length; i += 1) {\n      if (xhrCache[i].url === url) index = i;\n    }\n\n    if (index !== false) xhrCache.splice(index, 1);\n  };\n\n  _proto.xhrRequest = function xhrRequest(requestUrl, options) {\n    var router = this;\n    var params = router.params;\n    var ignoreCache = options.ignoreCache;\n    var url = requestUrl;\n    var hasQuery = url.indexOf('?') >= 0;\n\n    if (params.passRouteQueryToRequest && options && options.route && options.route.query && Object.keys(options.route.query).length) {\n      url += \"\" + (hasQuery ? '&' : '?') + serializeObject(options.route.query);\n      hasQuery = true;\n    }\n\n    if (params.passRouteParamsToRequest && options && options.route && options.route.params && Object.keys(options.route.params).length) {\n      url += \"\" + (hasQuery ? '&' : '?') + serializeObject(options.route.params);\n      hasQuery = true;\n    }\n\n    if (url.indexOf('{{') >= 0) {\n      url = router.replaceRequestUrlParams(url, options);\n    } // should we ignore get params or not\n\n\n    if (params.xhrCacheIgnoreGetParameters && url.indexOf('?') >= 0) {\n      url = url.split('?')[0];\n    }\n\n    return new Promise(function (resolve, reject) {\n      if (params.xhrCache && !ignoreCache && url.indexOf('nocache') < 0 && params.xhrCacheIgnore.indexOf(url) < 0) {\n        for (var i = 0; i < router.cache.xhr.length; i += 1) {\n          var cachedUrl = router.cache.xhr[i];\n\n          if (cachedUrl.url === url) {\n            // Check expiration\n            if (now() - cachedUrl.time < params.xhrCacheDuration) {\n              // Load from cache\n              resolve(cachedUrl.content);\n              return;\n            }\n          }\n        }\n      }\n\n      router.xhrAbortController = router.app.request.abortController();\n      router.app.request({\n        abortController: router.xhrAbortController,\n        url: url,\n        method: 'GET',\n        beforeSend: function beforeSend(xhr) {\n          router.emit('routerAjaxStart', xhr, options);\n        },\n        complete: function complete(xhr, status) {\n          router.emit('routerAjaxComplete', xhr);\n\n          if (status !== 'error' && status !== 'timeout' && xhr.status >= 200 && xhr.status < 300 || xhr.status === 0) {\n            if (params.xhrCache && xhr.responseText !== '') {\n              router.removeFromXhrCache(url);\n              router.cache.xhr.push({\n                url: url,\n                time: now(),\n                content: xhr.responseText\n              });\n            }\n\n            router.emit('routerAjaxSuccess', xhr, options);\n            resolve(xhr.responseText);\n          } else {\n            router.emit('routerAjaxError', xhr, options);\n            reject(xhr);\n          }\n        },\n        error: function error(xhr) {\n          router.emit('routerAjaxError', xhr, options);\n          reject(xhr);\n        }\n      });\n    });\n  };\n\n  _proto.setNavbarPosition = function setNavbarPosition($el, position, ariaHidden) {\n    var router = this;\n    $el.removeClass('navbar-previous navbar-current navbar-next');\n\n    if (position) {\n      $el.addClass(\"navbar-\" + position);\n    }\n\n    if (ariaHidden === false) {\n      $el.removeAttr('aria-hidden');\n    } else if (ariaHidden === true) {\n      $el.attr('aria-hidden', 'true');\n    }\n\n    $el.trigger('navbar:position', {\n      position: position\n    });\n    router.emit('navbarPosition', $el[0], position);\n  };\n\n  _proto.setPagePosition = function setPagePosition($el, position, ariaHidden) {\n    var router = this;\n    $el.removeClass('page-previous page-current page-next');\n    $el.addClass(\"page-\" + position);\n\n    if (ariaHidden === false) {\n      $el.removeAttr('aria-hidden');\n    } else if (ariaHidden === true) {\n      $el.attr('aria-hidden', 'true');\n    }\n\n    $el.trigger('page:position', {\n      position: position\n    });\n    router.emit('pagePosition', $el[0], position);\n  } // Remove theme elements\n  ;\n\n  _proto.removeThemeElements = function removeThemeElements(el) {\n    var router = this;\n    var theme = router.app.theme;\n    var toRemove;\n\n    if (theme === 'ios') {\n      toRemove = '.md-only, .aurora-only, .if-md, .if-aurora, .if-not-ios, .not-ios';\n    } else if (theme === 'md') {\n      toRemove = '.ios-only, .aurora-only, .if-ios, .if-aurora, .if-not-md, .not-md';\n    } else if (theme === 'aurora') {\n      toRemove = '.ios-only, .md-only, .if-ios, .if-md, .if-not-aurora, .not-aurora';\n    }\n\n    $(el).find(toRemove).remove();\n  };\n\n  _proto.getPageData = function getPageData(pageEl, navbarEl, from, to, route, pageFromEl) {\n    if (route === void 0) {\n      route = {};\n    }\n\n    var router = this;\n    var $pageEl = $(pageEl).eq(0);\n    var $navbarEl = $(navbarEl).eq(0);\n    var currentPage = $pageEl[0].f7Page || {};\n    var direction;\n    var pageFrom;\n    if (from === 'next' && to === 'current' || from === 'current' && to === 'previous') direction = 'forward';\n    if (from === 'current' && to === 'next' || from === 'previous' && to === 'current') direction = 'backward';\n\n    if (currentPage && !currentPage.fromPage) {\n      var $pageFromEl = $(pageFromEl);\n\n      if ($pageFromEl.length) {\n        pageFrom = $pageFromEl[0].f7Page;\n      }\n    }\n\n    pageFrom = currentPage.pageFrom || pageFrom;\n\n    if (pageFrom && pageFrom.pageFrom) {\n      pageFrom.pageFrom = null;\n    }\n\n    var page = {\n      app: router.app,\n      view: router.view,\n      router: router,\n      $el: $pageEl,\n      el: $pageEl[0],\n      $pageEl: $pageEl,\n      pageEl: $pageEl[0],\n      $navbarEl: $navbarEl,\n      navbarEl: $navbarEl[0],\n      name: $pageEl.attr('data-name'),\n      position: from,\n      from: from,\n      to: to,\n      direction: direction,\n      route: currentPage.route ? currentPage.route : route,\n      pageFrom: pageFrom\n    };\n    $pageEl[0].f7Page = page;\n    return page;\n  } // Callbacks\n  ;\n\n  _proto.pageCallback = function pageCallback(callback, pageEl, navbarEl, from, to, options, pageFromEl) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!pageEl) return;\n    var router = this;\n    var $pageEl = $(pageEl);\n    if (!$pageEl.length) return;\n    var $navbarEl = $(navbarEl);\n    var _options = options,\n        route = _options.route;\n    var restoreScrollTopOnBack = router.params.restoreScrollTopOnBack && !(router.params.masterDetailBreakpoint > 0 && $pageEl.hasClass('page-master') && router.app.width >= router.params.masterDetailBreakpoint);\n    var keepAlive = $pageEl[0].f7Page && $pageEl[0].f7Page.route && $pageEl[0].f7Page.route.route && $pageEl[0].f7Page.route.route.keepAlive;\n\n    if (callback === 'beforeRemove' && keepAlive) {\n      callback = 'beforeUnmount'; // eslint-disable-line\n    }\n\n    var camelName = \"page\" + (callback[0].toUpperCase() + callback.slice(1, callback.length));\n    var colonName = \"page:\" + callback.toLowerCase();\n    var page = {};\n\n    if (callback === 'beforeRemove' && $pageEl[0].f7Page) {\n      page = extend($pageEl[0].f7Page, {\n        from: from,\n        to: to,\n        position: from\n      });\n    } else {\n      page = router.getPageData($pageEl[0], $navbarEl[0], from, to, route, pageFromEl);\n    }\n\n    page.swipeBack = !!options.swipeBack;\n\n    var _ref2 = options.route ? options.route.route : {},\n        _ref2$on = _ref2.on,\n        on = _ref2$on === void 0 ? {} : _ref2$on,\n        _ref2$once = _ref2.once,\n        once = _ref2$once === void 0 ? {} : _ref2$once;\n\n    if (options.on) {\n      extend(on, options.on);\n    }\n\n    if (options.once) {\n      extend(once, options.once);\n    }\n\n    function attachEvents() {\n      if ($pageEl[0].f7RouteEventsAttached) return;\n      $pageEl[0].f7RouteEventsAttached = true;\n\n      if (on && Object.keys(on).length > 0) {\n        $pageEl[0].f7RouteEventsOn = on;\n        Object.keys(on).forEach(function (eventName) {\n          on[eventName] = on[eventName].bind(router);\n          $pageEl.on(eventNameToColonCase(eventName), on[eventName]);\n        });\n      }\n\n      if (once && Object.keys(once).length > 0) {\n        $pageEl[0].f7RouteEventsOnce = once;\n        Object.keys(once).forEach(function (eventName) {\n          once[eventName] = once[eventName].bind(router);\n          $pageEl.once(eventNameToColonCase(eventName), once[eventName]);\n        });\n      }\n    }\n\n    function detachEvents() {\n      if (!$pageEl[0].f7RouteEventsAttached) return;\n\n      if ($pageEl[0].f7RouteEventsOn) {\n        Object.keys($pageEl[0].f7RouteEventsOn).forEach(function (eventName) {\n          $pageEl.off(eventNameToColonCase(eventName), $pageEl[0].f7RouteEventsOn[eventName]);\n        });\n      }\n\n      if ($pageEl[0].f7RouteEventsOnce) {\n        Object.keys($pageEl[0].f7RouteEventsOnce).forEach(function (eventName) {\n          $pageEl.off(eventNameToColonCase(eventName), $pageEl[0].f7RouteEventsOnce[eventName]);\n        });\n      }\n\n      $pageEl[0].f7RouteEventsAttached = null;\n      $pageEl[0].f7RouteEventsOn = null;\n      $pageEl[0].f7RouteEventsOnce = null;\n      delete $pageEl[0].f7RouteEventsAttached;\n      delete $pageEl[0].f7RouteEventsOn;\n      delete $pageEl[0].f7RouteEventsOnce;\n    }\n\n    if (callback === 'mounted') {\n      attachEvents();\n    }\n\n    if (callback === 'init') {\n      if (restoreScrollTopOnBack && (from === 'previous' || !from) && to === 'current' && router.scrollHistory[page.route.url] && !$pageEl.hasClass('no-restore-scroll')) {\n        var $pageContent = $pageEl.find('.page-content');\n\n        if ($pageContent.length > 0) {\n          // eslint-disable-next-line\n          $pageContent = $pageContent.filter(function (pageContentEl) {\n            return $(pageContentEl).parents('.tab:not(.tab-active)').length === 0 && !$(pageContentEl).is('.tab:not(.tab-active)');\n          });\n        }\n\n        $pageContent.scrollTop(router.scrollHistory[page.route.url]);\n      }\n\n      attachEvents();\n\n      if ($pageEl[0].f7PageInitialized) {\n        $pageEl.trigger('page:reinit', page);\n        router.emit('pageReinit', page);\n        return;\n      }\n\n      $pageEl[0].f7PageInitialized = true;\n    }\n\n    if (restoreScrollTopOnBack && callback === 'beforeOut' && from === 'current' && to === 'previous') {\n      // Save scroll position\n      var _$pageContent = $pageEl.find('.page-content');\n\n      if (_$pageContent.length > 0) {\n        // eslint-disable-next-line\n        _$pageContent = _$pageContent.filter(function (pageContentEl) {\n          return $(pageContentEl).parents('.tab:not(.tab-active)').length === 0 && !$(pageContentEl).is('.tab:not(.tab-active)');\n        });\n      }\n\n      router.scrollHistory[page.route.url] = _$pageContent.scrollTop();\n    }\n\n    if (restoreScrollTopOnBack && callback === 'beforeOut' && from === 'current' && to === 'next') {\n      // Delete scroll position\n      delete router.scrollHistory[page.route.url];\n    }\n\n    $pageEl.trigger(colonName, page);\n    router.emit(camelName, page);\n\n    if (callback === 'beforeRemove' || callback === 'beforeUnmount') {\n      detachEvents();\n\n      if (!keepAlive) {\n        if ($pageEl[0].f7Page && $pageEl[0].f7Page.navbarEl) {\n          delete $pageEl[0].f7Page.navbarEl.f7Page;\n        }\n\n        $pageEl[0].f7Page = null;\n      }\n    }\n  };\n\n  _proto.saveHistory = function saveHistory() {\n    var router = this;\n    var window = getWindow();\n    router.view.history = router.history;\n\n    if (router.params.browserHistory && router.params.browserHistoryStoreHistory && window.localStorage) {\n      window.localStorage[\"f7router-\" + router.view.id + \"-history\"] = JSON.stringify(router.history);\n    }\n  };\n\n  _proto.restoreHistory = function restoreHistory() {\n    var router = this;\n    var window = getWindow();\n\n    if (router.params.browserHistory && router.params.browserHistoryStoreHistory && window.localStorage && window.localStorage[\"f7router-\" + router.view.id + \"-history\"]) {\n      router.history = JSON.parse(window.localStorage[\"f7router-\" + router.view.id + \"-history\"]);\n      router.view.history = router.history;\n    }\n  };\n\n  _proto.clearHistory = function clearHistory() {\n    var router = this;\n    router.history = [];\n    if (router.view) router.view.history = [];\n    router.saveHistory();\n  };\n\n  _proto.updateCurrentUrl = function updateCurrentUrl(newUrl) {\n    var router = this;\n    appRouterCheck(router, 'updateCurrentUrl'); // Update history\n\n    if (router.history.length) {\n      router.history[router.history.length - 1] = newUrl;\n    } else {\n      router.history.push(newUrl);\n    } // Update current route params\n\n\n    var _router$parseRouteUrl2 = router.parseRouteUrl(newUrl),\n        query = _router$parseRouteUrl2.query,\n        hash = _router$parseRouteUrl2.hash,\n        params = _router$parseRouteUrl2.params,\n        url = _router$parseRouteUrl2.url,\n        path = _router$parseRouteUrl2.path;\n\n    if (router.currentRoute) {\n      extend(router.currentRoute, {\n        query: query,\n        hash: hash,\n        params: params,\n        url: url,\n        path: path\n      });\n    }\n\n    if (router.params.browserHistory) {\n      var browserHistoryRoot = router.params.browserHistoryRoot || '';\n      History.replace(router.view.id, {\n        url: newUrl\n      }, browserHistoryRoot + router.params.browserHistorySeparator + newUrl);\n    } // Save History\n\n\n    router.saveHistory();\n    router.emit('routeUrlUpdate', router.currentRoute, router);\n  };\n\n  _proto.getInitialUrl = function getInitialUrl() {\n    var router = this;\n\n    if (router.initialUrl) {\n      return {\n        initialUrl: router.initialUrl,\n        historyRestored: router.historyRestored\n      };\n    }\n\n    var app = router.app,\n        view = router.view;\n    var document = getDocument();\n    var window = getWindow();\n    var location = app.params.url && typeof app.params.url === 'string' && typeof URL !== 'undefined' ? new URL(app.params.url) : document.location;\n    var initialUrl = router.params.url;\n    var documentUrl = location.href.split(location.origin)[1];\n    var historyRestored;\n    var _router$params = router.params,\n        browserHistory = _router$params.browserHistory,\n        browserHistoryOnLoad = _router$params.browserHistoryOnLoad,\n        browserHistorySeparator = _router$params.browserHistorySeparator;\n    var browserHistoryRoot = router.params.browserHistoryRoot;\n\n    if ((window.cordova || window.Capacitor && window.Capacitor.isNative) && browserHistory && !browserHistorySeparator && !browserHistoryRoot && location.pathname.indexOf('index.html')) {\n      // eslint-disable-next-line\n      console.warn('Framework7: wrong or not complete browserHistory configuration, trying to guess browserHistoryRoot');\n      browserHistoryRoot = location.pathname.split('index.html')[0];\n    }\n\n    if (!browserHistory || !browserHistoryOnLoad) {\n      if (!initialUrl) {\n        initialUrl = documentUrl;\n      }\n\n      if (location.search && initialUrl.indexOf('?') < 0) {\n        initialUrl += location.search;\n      }\n\n      if (location.hash && initialUrl.indexOf('#') < 0) {\n        initialUrl += location.hash;\n      }\n    } else {\n      if (browserHistoryRoot && documentUrl.indexOf(browserHistoryRoot) >= 0) {\n        documentUrl = documentUrl.split(browserHistoryRoot)[1];\n        if (documentUrl === '') documentUrl = '/';\n      }\n\n      if (browserHistorySeparator.length > 0 && documentUrl.indexOf(browserHistorySeparator) >= 0) {\n        initialUrl = documentUrl.split(browserHistorySeparator)[1];\n      } else {\n        initialUrl = documentUrl;\n      }\n\n      router.restoreHistory();\n\n      if (router.history.indexOf(initialUrl) >= 0) {\n        router.history = router.history.slice(0, router.history.indexOf(initialUrl) + 1);\n      } else if (router.params.url === initialUrl) {\n        router.history = [initialUrl];\n      } else if (History.state && History.state[view.id] && History.state[view.id].url === router.history[router.history.length - 1]) {\n        initialUrl = router.history[router.history.length - 1];\n      } else {\n        router.history = [documentUrl.split(browserHistorySeparator)[0] || '/', initialUrl];\n      }\n\n      if (router.history.length > 1) {\n        historyRestored = true;\n      } else {\n        router.history = [];\n      }\n\n      router.saveHistory();\n    }\n\n    router.initialUrl = initialUrl;\n    router.historyRestored = historyRestored;\n    return {\n      initialUrl: initialUrl,\n      historyRestored: historyRestored\n    };\n  };\n\n  _proto.init = function init() {\n    var router = this;\n    var app = router.app,\n        view = router.view;\n    var document = getDocument();\n    router.mount();\n\n    var _router$getInitialUrl = router.getInitialUrl(),\n        initialUrl = _router$getInitialUrl.initialUrl,\n        historyRestored = _router$getInitialUrl.historyRestored; // Init Swipeback\n\n\n    if (view && router.params.iosSwipeBack && app.theme === 'ios' || view && router.params.mdSwipeBack && app.theme === 'md' || view && router.params.auroraSwipeBack && app.theme === 'aurora') {\n      SwipeBack(router);\n    }\n\n    var _router$params2 = router.params,\n        browserHistory = _router$params2.browserHistory,\n        browserHistoryOnLoad = _router$params2.browserHistoryOnLoad,\n        browserHistoryAnimateOnLoad = _router$params2.browserHistoryAnimateOnLoad,\n        browserHistoryInitialMatch = _router$params2.browserHistoryInitialMatch;\n    var currentRoute;\n\n    if (router.history.length > 1) {\n      // Will load page\n      var initUrl = browserHistoryInitialMatch ? initialUrl : router.history[0];\n      currentRoute = router.findMatchingRoute(initUrl);\n\n      if (!currentRoute) {\n        currentRoute = extend(router.parseRouteUrl(initUrl), {\n          route: {\n            url: initUrl,\n            path: initUrl.split('?')[0]\n          }\n        });\n      }\n    } else {\n      // Don't load page\n      currentRoute = router.findMatchingRoute(initialUrl);\n\n      if (!currentRoute) {\n        currentRoute = extend(router.parseRouteUrl(initialUrl), {\n          route: {\n            url: initialUrl,\n            path: initialUrl.split('?')[0]\n          }\n        });\n      }\n    }\n\n    if (router.params.stackPages) {\n      router.$el.children('.page').each(function (pageEl) {\n        var $pageEl = $(pageEl);\n        router.initialPages.push($pageEl[0]);\n\n        if (router.dynamicNavbar && $pageEl.children('.navbar').length > 0) {\n          router.initialNavbars.push($pageEl.children('.navbar')[0]);\n        }\n      });\n    }\n\n    if (router.$el.children('.page:not(.stacked)').length === 0 && initialUrl && router.params.loadInitialPage) {\n      // No pages presented in DOM, reload new page\n      router.navigate(initialUrl, {\n        initial: true,\n        reloadCurrent: true,\n        browserHistory: false,\n        animate: false,\n        once: {\n          modalOpen: function modalOpen() {\n            if (!historyRestored) return;\n            var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n            if (preloadPreviousPage && router.history.length > 1) {\n              router.back({\n                preload: true\n              });\n            }\n          },\n          pageAfterIn: function pageAfterIn() {\n            if (!historyRestored) return;\n            var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n            if (preloadPreviousPage && router.history.length > 1) {\n              router.back({\n                preload: true\n              });\n            }\n          }\n        }\n      });\n    } else if (router.$el.children('.page:not(.stacked)').length) {\n      // Init current DOM page\n      var hasTabRoute;\n      router.currentRoute = currentRoute;\n      router.$el.children('.page:not(.stacked)').each(function (pageEl) {\n        var $pageEl = $(pageEl);\n        var $navbarEl;\n        router.setPagePosition($pageEl, 'current');\n\n        if (router.dynamicNavbar) {\n          $navbarEl = $pageEl.children('.navbar');\n\n          if ($navbarEl.length > 0) {\n            if (!router.$navbarsEl.parents(document).length) {\n              router.$el.prepend(router.$navbarsEl);\n            }\n\n            router.setNavbarPosition($navbarEl, 'current');\n            router.$navbarsEl.append($navbarEl);\n\n            if ($navbarEl.children('.title-large').length) {\n              $navbarEl.addClass('navbar-large');\n            }\n\n            $pageEl.children('.navbar').remove();\n          } else {\n            router.$navbarsEl.addClass('navbar-hidden');\n\n            if ($navbarEl.children('.title-large').length) {\n              router.$navbarsEl.addClass('navbar-hidden navbar-large-hidden');\n            }\n          }\n        }\n\n        if (router.currentRoute && router.currentRoute.route && (router.currentRoute.route.master === true || typeof router.currentRoute.route.master === 'function' && router.currentRoute.route.master(app, router)) && router.params.masterDetailBreakpoint > 0) {\n          $pageEl.addClass('page-master');\n          $pageEl.trigger('page:role', {\n            role: 'master'\n          });\n\n          if ($navbarEl && $navbarEl.length) {\n            $navbarEl.addClass('navbar-master');\n          }\n\n          view.checkMasterDetailBreakpoint();\n        }\n\n        var initOptions = {\n          route: router.currentRoute\n        };\n\n        if (router.currentRoute && router.currentRoute.route && router.currentRoute.route.options) {\n          extend(initOptions, router.currentRoute.route.options);\n        }\n\n        router.currentPageEl = $pageEl[0];\n\n        if (router.dynamicNavbar && $navbarEl.length) {\n          router.currentNavbarEl = $navbarEl[0];\n        }\n\n        router.removeThemeElements($pageEl);\n\n        if (router.dynamicNavbar && $navbarEl.length) {\n          router.removeThemeElements($navbarEl);\n        }\n\n        if (initOptions.route.route.tab) {\n          hasTabRoute = true;\n          router.tabLoad(initOptions.route.route.tab, extend({}, initOptions));\n        }\n\n        router.pageCallback('init', $pageEl, $navbarEl, 'current', undefined, initOptions);\n        router.pageCallback('beforeIn', $pageEl, $navbarEl, 'current', undefined, initOptions);\n        router.pageCallback('afterIn', $pageEl, $navbarEl, 'current', undefined, initOptions);\n      });\n\n      if (historyRestored) {\n        if (browserHistoryInitialMatch) {\n          var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n          if (preloadPreviousPage && router.history.length > 1) {\n            router.back({\n              preload: true\n            });\n          }\n        } else {\n          router.navigate(initialUrl, {\n            initial: true,\n            browserHistory: false,\n            history: false,\n            animate: browserHistoryAnimateOnLoad,\n            once: {\n              pageAfterIn: function pageAfterIn() {\n                var preloadPreviousPage = router.params.preloadPreviousPage || router.params[app.theme + \"SwipeBack\"];\n\n                if (preloadPreviousPage && router.history.length > 2) {\n                  router.back({\n                    preload: true\n                  });\n                }\n              }\n            }\n          });\n        }\n      }\n\n      if (!historyRestored && !hasTabRoute) {\n        router.history.push(initialUrl);\n        router.saveHistory();\n      }\n    }\n\n    if (initialUrl && browserHistory && browserHistoryOnLoad && (!History.state || !History.state[view.id])) {\n      History.initViewState(view.id, {\n        url: initialUrl\n      });\n    }\n\n    router.emit('local::init routerInit', router);\n  };\n\n  _proto.destroy = function destroy() {\n    var router = this;\n    router.emit('local::destroy routerDestroy', router); // Delete props & methods\n\n    Object.keys(router).forEach(function (routerProp) {\n      router[routerProp] = null;\n      delete router[routerProp];\n    });\n    router = null;\n  };\n\n  return Router;\n}(Framework7Class); // Load\n\n\nRouter.prototype.navigate = navigate;\nRouter.prototype.refreshPage = refreshPage; // Tab\n\nRouter.prototype.tabLoad = tabLoad;\nRouter.prototype.tabRemove = tabRemove; // Modal\n\nRouter.prototype.modalLoad = modalLoad;\nRouter.prototype.modalRemove = modalRemove; // Back\n\nRouter.prototype.back = back; // Clear history\n\nRouter.prototype.clearPreviousHistory = clearPreviousHistory;\nexport default Router;"]},"metadata":{},"sourceType":"module"}