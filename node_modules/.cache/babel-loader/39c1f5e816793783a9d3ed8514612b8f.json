{"ast":null,"code":"function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nimport { getWindow, getDocument } from 'ssr-window';\nimport $ from '../../shared/dom7';\nimport { extend, deleteProps } from '../../shared/utils';\nimport Framework7Class from '../../shared/class';\nimport { getDevice } from '../../shared/get-device';\nvar textEditorButtonsMap = {\n  // f7-icon, material-icon, command\n  bold: ['bold', 'format_bold', 'bold'],\n  italic: ['italic', 'format_italic', 'italic'],\n  underline: ['underline', 'format_underlined', 'underline'],\n  strikeThrough: ['strikethrough', 'strikethrough_s', 'strikeThrough'],\n  orderedList: ['list_number', 'format_list_numbered', 'insertOrderedList'],\n  unorderedList: ['list_bullet', 'format_list_bulleted', 'insertUnorderedList'],\n  link: ['link', 'link', 'createLink'],\n  image: ['photo', 'image', 'insertImage'],\n  paragraph: ['paragraph', '<i class=\"icon\">Â¶</i>', 'formatBlock.P'],\n  h1: ['<i class=\"icon\">H<sub>1</sub></i>', '<i class=\"icon\">H<sub>1</sub></i>', 'formatBlock.H1'],\n  h2: ['<i class=\"icon\">H<sub>2</sub></i>', '<i class=\"icon\">H<sub>2</sub></i>', 'formatBlock.H2'],\n  h3: ['<i class=\"icon\">H<sub>3</sub></i>', '<i class=\"icon\">H<sub>3</sub></i>', 'formatBlock.H3'],\n  alignLeft: ['text_alignleft', 'format_align_left', 'justifyLeft'],\n  alignCenter: ['text_aligncenter', 'format_align_center', 'justifyCenter'],\n  alignRight: ['text_alignright', 'format_align_right', 'justifyRight'],\n  alignJustify: ['text_justify', 'format_align_justify', 'justifyFull'],\n  subscript: ['textformat_subscript', '<i class=\"icon\">A<sub>1</sub></i>', 'subscript'],\n  superscript: ['textformat_superscript', '<i class=\"icon\">A<sup>1</sup></i>', 'superscript'],\n  indent: ['increase_indent', 'format_indent_increase', 'indent'],\n  outdent: ['decrease_indent', 'format_indent_decrease', 'outdent']\n};\n\nvar TextEditor = /*#__PURE__*/function (_Framework7Class) {\n  _inheritsLoose(TextEditor, _Framework7Class);\n\n  function TextEditor(app, params) {\n    var _this;\n\n    _this = _Framework7Class.call(this, params, [app]) || this;\n\n    var self = _assertThisInitialized(_this);\n\n    var document = getDocument();\n    var device = getDevice();\n    var defaults = extend({}, app.params.textEditor); // Extend defaults with modules params\n\n    self.useModulesParams(defaults);\n    self.params = extend(defaults, params);\n    var el = self.params.el;\n    if (!el) return self || _assertThisInitialized(_this);\n    var $el = $(el);\n    if ($el.length === 0) return self || _assertThisInitialized(_this);\n    if ($el[0].f7TextEditor) return $el[0].f7TextEditor || _assertThisInitialized(_this);\n    var $contentEl = $el.children('.text-editor-content');\n\n    if (!$contentEl.length) {\n      $el.append('<div class=\"text-editor-content\" contenteditable></div>');\n      $contentEl = $el.children('.text-editor-content');\n    }\n\n    extend(self, {\n      app: app,\n      $el: $el,\n      el: $el[0],\n      $contentEl: $contentEl,\n      contentEl: $contentEl[0]\n    });\n\n    if ('value' in params) {\n      self.value = self.params.value;\n    }\n\n    if (self.params.mode === 'keyboard-toolbar') {\n      if (!(device.cordova || device.capacitor) && !device.android) {\n        self.params.mode = 'popover';\n      }\n    }\n\n    if (typeof self.params.buttons === 'string') {\n      try {\n        self.params.buttons = JSON.parse(self.params.buttons);\n      } catch (err) {\n        throw new Error('Framework7: TextEditor: wrong \"buttons\" parameter format');\n      }\n    }\n\n    $el[0].f7TextEditor = self; // Bind\n\n    self.onButtonClick = self.onButtonClick.bind(self);\n    self.onFocus = self.onFocus.bind(self);\n    self.onBlur = self.onBlur.bind(self);\n    self.onInput = self.onInput.bind(self);\n    self.onPaste = self.onPaste.bind(self);\n    self.onSelectionChange = self.onSelectionChange.bind(self);\n    self.closeKeyboardToolbar = self.closeKeyboardToolbar.bind(self); // Handle Events\n\n    self.attachEvents = function attachEvents() {\n      if (self.params.mode === 'toolbar') {\n        self.$el.find('.text-editor-toolbar').on('click', 'button', self.onButtonClick);\n      }\n\n      if (self.params.mode === 'keyboard-toolbar') {\n        self.$keyboardToolbarEl.on('click', 'button', self.onButtonClick);\n        self.$el.parents('.page').on('page:beforeout', self.closeKeyboardToolbar);\n      }\n\n      if (self.params.mode === 'popover' && self.popover) {\n        self.popover.$el.on('click', 'button', self.onButtonClick);\n      }\n\n      self.$contentEl.on('paste', self.onPaste);\n      self.$contentEl.on('focus', self.onFocus);\n      self.$contentEl.on('blur', self.onBlur);\n      self.$contentEl.on('input', self.onInput, true);\n      $(document).on('selectionchange', self.onSelectionChange);\n    };\n\n    self.detachEvents = function detachEvents() {\n      if (self.params.mode === 'toolbar') {\n        self.$el.find('.text-editor-toolbar').off('click', 'button', self.onButtonClick);\n      }\n\n      if (self.params.mode === 'keyboard-toolbar') {\n        self.$keyboardToolbarEl.off('click', 'button', self.onButtonClick);\n        self.$el.parents('.page').off('page:beforeout', self.closeKeyboardToolbar);\n      }\n\n      if (self.params.mode === 'popover' && self.popover) {\n        self.popover.$el.off('click', 'button', self.onButtonClick);\n      }\n\n      self.$contentEl.off('paste', self.onPaste);\n      self.$contentEl.off('focus', self.onFocus);\n      self.$contentEl.off('blur', self.onBlur);\n      self.$contentEl.off('input', self.onInput, true);\n      $(document).off('selectionchange', self.onSelectionChange);\n    }; // Install Modules\n\n\n    self.useModules(); // Init\n\n    self.init();\n    return self || _assertThisInitialized(_this);\n  }\n\n  var _proto = TextEditor.prototype;\n\n  _proto.setValue = function setValue(newValue) {\n    var self = this;\n    var currentValue = self.value;\n    if (currentValue === newValue) return self;\n    self.value = newValue;\n    self.$contentEl.html(newValue);\n    self.$el.trigger('texteditor:change', self.value);\n    self.emit('local::change textEditorChange', self, self.value);\n    return self;\n  };\n\n  _proto.getValue = function getValue() {\n    var self = this;\n    return self.value;\n  };\n\n  _proto.clearValue = function clearValue() {\n    var self = this;\n    self.setValue('');\n\n    if (self.params.placeholder && !self.$contentEl.html()) {\n      self.insertPlaceholder();\n    }\n\n    return self;\n  };\n\n  _proto.createLink = function createLink() {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n    var currentSelection = window.getSelection();\n    var selectedNodes = [];\n    var $selectedLinks;\n\n    if (currentSelection && currentSelection.anchorNode && $(currentSelection.anchorNode).parents(self.$el).length) {\n      var anchorNode = currentSelection.anchorNode;\n\n      while (anchorNode) {\n        selectedNodes.push(anchorNode);\n\n        if (!anchorNode.nextSibling || anchorNode === currentSelection.focusNode) {\n          anchorNode = null;\n        }\n\n        if (anchorNode) {\n          anchorNode = anchorNode.nextSibling;\n        }\n      }\n\n      var selectedNodesLinks = [];\n      var $selectedNodes = $(selectedNodes);\n\n      for (var i = 0; i < $selectedNodes.length; i += 1) {\n        var childNodes = $selectedNodes[i].children;\n\n        if (childNodes) {\n          for (var j = 0; j < childNodes.length; j += 1) {\n            if ($(childNodes[j]).is('a')) {\n              selectedNodesLinks.push(childNodes[j]);\n            }\n          }\n        }\n      }\n\n      $selectedLinks = $selectedNodes.closest('a').add($(selectedNodesLinks));\n    }\n\n    if ($selectedLinks && $selectedLinks.length) {\n      $selectedLinks.each(function (linkNode) {\n        var selection = window.getSelection();\n        var range = document.createRange();\n        range.selectNodeContents(linkNode);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        document.execCommand('unlink', false);\n        selection.removeAllRanges();\n      });\n      return self;\n    }\n\n    var currentRange = self.getSelectionRange();\n    if (!currentRange) return self;\n    var dialog = self.app.dialog.prompt(self.params.linkUrlText, '', function (link) {\n      if (link && link.trim().length) {\n        self.setSelectionRange(currentRange);\n        document.execCommand('createLink', false, link.trim());\n      }\n    });\n    dialog.$el.find('input').focus();\n    return self;\n  };\n\n  _proto.insertImage = function insertImage() {\n    var self = this;\n    var document = getDocument();\n    var currentRange = self.getSelectionRange();\n    if (!currentRange) return self;\n    var dialog = self.app.dialog.prompt(self.params.imageUrlText, '', function (imageUrl) {\n      if (imageUrl && imageUrl.trim().length) {\n        self.setSelectionRange(currentRange);\n        document.execCommand('insertImage', false, imageUrl.trim());\n      }\n    });\n    dialog.$el.find('input').focus();\n    return self;\n  };\n\n  _proto.removePlaceholder = function removePlaceholder() {\n    var self = this;\n    self.$contentEl.find('.text-editor-placeholder').remove();\n  };\n\n  _proto.insertPlaceholder = function insertPlaceholder() {\n    var self = this;\n    self.$contentEl.append(\"<div class=\\\"text-editor-placeholder\\\">\" + self.params.placeholder + \"</div>\");\n  };\n\n  _proto.onSelectionChange = function onSelectionChange() {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n    if (self.params.mode === 'toolbar') return;\n    var selection = window.getSelection();\n    var selectionIsInContent = $(selection.anchorNode).parents(self.contentEl).length || selection.anchorNode === self.contentEl;\n\n    if (self.params.mode === 'keyboard-toolbar') {\n      if (!selectionIsInContent) {\n        self.closeKeyboardToolbar();\n      } else {\n        self.openKeyboardToolbar();\n      }\n\n      return;\n    }\n\n    if (self.params.mode === 'popover') {\n      var selectionIsInPopover = $(selection.anchorNode).parents(self.popover.el).length || selection.anchorNode === self.popover.el;\n\n      if (!selectionIsInContent && !selectionIsInPopover) {\n        self.closePopover();\n        return;\n      }\n\n      if (!selection.isCollapsed && selection.rangeCount) {\n        var range = selection.getRangeAt(0);\n        var rect = range.getBoundingClientRect();\n        var rootEl = self.app.$el[0] || document.body;\n        self.openPopover(rect.x + (window.scrollX || 0) - rootEl.offsetLeft, rect.y + (window.scrollY || 0) - rootEl.offsetTop, rect.width, rect.height);\n      } else if (selection.isCollapsed) {\n        self.closePopover();\n      }\n    }\n  };\n\n  _proto.onPaste = function onPaste(e) {\n    var self = this;\n    var document = getDocument();\n\n    if (self.params.clearFormattingOnPaste && e.clipboardData && e.clipboardData.getData) {\n      var text = e.clipboardData.getData('text/plain');\n      e.preventDefault();\n      document.execCommand('insertText', false, text);\n    }\n  };\n\n  _proto.onInput = function onInput() {\n    var self = this;\n    var value = self.$contentEl.html();\n    self.value = value;\n    self.$el.trigger('texteditor:input');\n    self.emit('local:input textEditorInput', self, self.value);\n    self.$el.trigger('texteditor:change', self.value);\n    self.emit('local::change textEditorChange', self, self.value);\n  };\n\n  _proto.onFocus = function onFocus() {\n    var self = this;\n    self.removePlaceholder();\n    self.$contentEl.focus();\n    self.$el.trigger('texteditor:focus');\n    self.emit('local::focus textEditorFocus', self);\n  };\n\n  _proto.onBlur = function onBlur() {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n\n    if (self.params.placeholder && self.$contentEl.html() === '') {\n      self.insertPlaceholder();\n    }\n\n    if (self.params.mode === 'popover') {\n      var selection = window.getSelection();\n      var selectionIsInContent = $(selection.anchorNode).parents(self.contentEl).length || selection.anchorNode === self.contentEl;\n      var inPopover = document.activeElement && self.popover && $(document.activeElement).closest(self.popover.$el).length;\n\n      if (!inPopover && !selectionIsInContent) {\n        self.closePopover();\n      }\n    }\n\n    if (self.params.mode === 'keyboard-toolbar') {\n      var _selection = window.getSelection();\n\n      var _selectionIsInContent = $(_selection.anchorNode).parents(self.contentEl).length || _selection.anchorNode === self.contentEl;\n\n      if (!_selectionIsInContent) {\n        self.closeKeyboardToolbar();\n      }\n    }\n\n    self.$el.trigger('texteditor:blur');\n    self.emit('local::blur textEditorBlur', self);\n  };\n\n  _proto.onButtonClick = function onButtonClick(e) {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n    var selection = window.getSelection();\n    var selectionIsInContent = $(selection.anchorNode).parents(self.contentEl).length || selection.anchorNode === self.contentEl;\n    if (!selectionIsInContent) return;\n    var $buttonEl = $(e.target).closest('button');\n\n    if ($buttonEl.parents('form').length) {\n      e.preventDefault();\n    }\n\n    var button = $buttonEl.attr('data-button');\n    var buttonData = self.params.customButtons && self.params.customButtons[button];\n    if (!button || !(textEditorButtonsMap[button] || buttonData)) return;\n    $buttonEl.trigger('texteditor:buttonclick', button);\n    self.emit('local::buttonClick textEditorButtonClick', self, button);\n\n    if (buttonData) {\n      if (buttonData.onClick) buttonData.onClick(self, $buttonEl[0]);\n      return;\n    }\n\n    var command = textEditorButtonsMap[button][2];\n\n    if (command === 'createLink') {\n      self.createLink();\n      return;\n    }\n\n    if (command === 'insertImage') {\n      self.insertImage();\n      return;\n    }\n\n    if (command.indexOf('formatBlock') === 0) {\n      var tagName = command.split('.')[1];\n      var $anchorNode = $(selection.anchorNode);\n\n      if ($anchorNode.parents(tagName.toLowerCase()).length || $anchorNode.is(tagName)) {\n        document.execCommand('formatBlock', false, 'div');\n      } else {\n        document.execCommand('formatBlock', false, tagName);\n      }\n\n      return;\n    }\n\n    document.execCommand(command, false);\n  } // eslint-disable-next-line\n  ;\n\n  _proto.getSelectionRange = function getSelectionRange() {\n    var window = getWindow();\n    var document = getDocument();\n\n    if (window.getSelection) {\n      var sel = window.getSelection();\n\n      if (sel.getRangeAt && sel.rangeCount) {\n        return sel.getRangeAt(0);\n      }\n    } else if (document.selection && document.selection.createRange) {\n      return document.selection.createRange();\n    }\n\n    return null;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.setSelectionRange = function setSelectionRange(range) {\n    var window = getWindow();\n    var document = getDocument();\n\n    if (range) {\n      if (window.getSelection) {\n        var sel = window.getSelection();\n        sel.removeAllRanges();\n        sel.addRange(range);\n      } else if (document.selection && range.select) {\n        range.select();\n      }\n    }\n  };\n\n  _proto.renderButtons = function renderButtons() {\n    var self = this;\n    var html = '';\n\n    function renderButton(button) {\n      var iconClass = self.app.theme === 'md' ? 'material-icons' : 'f7-icons';\n\n      if (self.params.customButtons && self.params.customButtons[button]) {\n        var buttonData = self.params.customButtons[button];\n        return \"<button type=\\\"button\\\" class=\\\"text-editor-button\\\" data-button=\\\"\" + button + \"\\\">\" + (buttonData.content || '') + \"</button>\";\n      }\n\n      if (!textEditorButtonsMap[button]) return '';\n      var iconContent = textEditorButtonsMap[button][self.app.theme === 'md' ? 1 : 0];\n      return (\"<button type=\\\"button\\\" class=\\\"text-editor-button\\\" data-button=\\\"\" + button + \"\\\">\" + (iconContent.indexOf('<') >= 0 ? iconContent : \"<i class=\\\"\" + iconClass + \"\\\">\" + iconContent + \"</i>\") + \"</button>\").trim();\n    }\n\n    self.params.buttons.forEach(function (button, buttonIndex) {\n      if (Array.isArray(button)) {\n        button.forEach(function (b) {\n          html += renderButton(b);\n        });\n\n        if (buttonIndex < self.params.buttons.length - 1 && self.params.dividers) {\n          html += '<div class=\"text-editor-button-divider\"></div>';\n        }\n      } else {\n        html += renderButton(button);\n      }\n    });\n    return html;\n  };\n\n  _proto.createToolbar = function createToolbar() {\n    var self = this;\n    self.$el.prepend(\"<div class=\\\"text-editor-toolbar\\\">\" + self.renderButtons() + \"</div>\");\n  };\n\n  _proto.createKeyboardToolbar = function createKeyboardToolbar() {\n    var self = this;\n    self.$keyboardToolbarEl = $(\"<div class=\\\"toolbar toolbar-bottom text-editor-keyboard-toolbar\\\"><div class=\\\"toolbar-inner\\\">\" + self.renderButtons() + \"</div></div>\");\n  };\n\n  _proto.createPopover = function createPopover() {\n    var self = this;\n    self.popover = self.app.popover.create({\n      content: \"\\n        <div class=\\\"popover theme-dark text-editor-popover\\\">\\n          <div class=\\\"popover-inner\\\">\" + self.renderButtons() + \"</div>\\n        </div>\\n      \",\n      closeByOutsideClick: false,\n      backdrop: false\n    });\n  };\n\n  _proto.openKeyboardToolbar = function openKeyboardToolbar() {\n    var self = this;\n    if (self.$keyboardToolbarEl.parent(self.app.$el).length) return;\n    self.$el.trigger('texteditor:keyboardopen');\n    self.emit('local::keyboardOpen textEditorKeyboardOpen', self);\n    self.app.$el.append(self.$keyboardToolbarEl);\n  };\n\n  _proto.closeKeyboardToolbar = function closeKeyboardToolbar() {\n    var self = this;\n    self.$keyboardToolbarEl.remove();\n    self.$el.trigger('texteditor:keyboardclose');\n    self.emit('local::keyboardClose textEditorKeyboardClose', self);\n  };\n\n  _proto.openPopover = function openPopover(targetX, targetY, targetWidth, targetHeight) {\n    var self = this;\n    if (!self.popover) return;\n    Object.assign(self.popover.params, {\n      targetX: targetX,\n      targetY: targetY,\n      targetWidth: targetWidth,\n      targetHeight: targetHeight\n    });\n    clearTimeout(self.popoverTimeout);\n    self.popoverTimeout = setTimeout(function () {\n      if (!self.popover) return;\n\n      if (self.popover.opened) {\n        self.popover.resize();\n      } else {\n        self.$el.trigger('texteditor:popoveropen');\n        self.emit('local::popoverOpen textEditorPopoverOpen', self);\n        self.popover.open();\n      }\n    }, 400);\n  };\n\n  _proto.closePopover = function closePopover() {\n    var self = this;\n    clearTimeout(self.popoverTimeout);\n    if (!self.popover || !self.popover.opened) return;\n    self.popoverTimeout = setTimeout(function () {\n      if (!self.popover) return;\n      self.$el.trigger('texteditor:popoverclose');\n      self.emit('local::popoverClose textEditorPopoverClose', self);\n      self.popover.close();\n    }, 400);\n  };\n\n  _proto.init = function init() {\n    var self = this;\n\n    if (self.value) {\n      self.$contentEl.html(self.value);\n    } else {\n      self.value = self.$contentEl.html();\n    }\n\n    if (self.params.placeholder && self.value === '') {\n      self.insertPlaceholder();\n    }\n\n    if (self.params.mode === 'toolbar') {\n      self.createToolbar();\n    } else if (self.params.mode === 'popover') {\n      self.createPopover();\n    } else if (self.params.mode === 'keyboard-toolbar') {\n      self.createKeyboardToolbar();\n    }\n\n    self.attachEvents();\n    self.$el.trigger('texteditor:init');\n    self.emit('local::init textEditorInit', self);\n    return self;\n  };\n\n  _proto.destroy = function destroy() {\n    var self = this;\n    self.$el.trigger('texteditor:beforedestroy');\n    self.emit('local::beforeDestroy textEditorBeforeDestroy', self);\n    self.detachEvents();\n\n    if (self.params.mode === 'keyboard-toolbar' && self.$keyboardToolbarEl) {\n      self.$keyboardToolbarEl.remove();\n    }\n\n    if (self.popover) {\n      self.popover.close(false);\n      self.popover.destroy();\n    }\n\n    delete self.$el[0].f7TextEditor;\n    deleteProps(self);\n    self = null;\n  };\n\n  return TextEditor;\n}(Framework7Class);\n\nexport default TextEditor;","map":{"version":3,"sources":["E:/Programming/React/rashiApp/node_modules/framework7/esm/components/text-editor/text-editor-class.js"],"names":["_assertThisInitialized","self","ReferenceError","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","__proto__","getWindow","getDocument","$","extend","deleteProps","Framework7Class","getDevice","textEditorButtonsMap","bold","italic","underline","strikeThrough","orderedList","unorderedList","link","image","paragraph","h1","h2","h3","alignLeft","alignCenter","alignRight","alignJustify","subscript","superscript","indent","outdent","TextEditor","_Framework7Class","app","params","_this","call","document","device","defaults","textEditor","useModulesParams","el","$el","length","f7TextEditor","$contentEl","children","append","contentEl","value","mode","cordova","capacitor","android","buttons","JSON","parse","err","Error","onButtonClick","bind","onFocus","onBlur","onInput","onPaste","onSelectionChange","closeKeyboardToolbar","attachEvents","find","on","$keyboardToolbarEl","parents","popover","detachEvents","off","useModules","init","_proto","setValue","newValue","currentValue","html","trigger","emit","getValue","clearValue","placeholder","insertPlaceholder","createLink","window","currentSelection","getSelection","selectedNodes","$selectedLinks","anchorNode","push","nextSibling","focusNode","selectedNodesLinks","$selectedNodes","i","childNodes","j","is","closest","add","each","linkNode","selection","range","createRange","selectNodeContents","removeAllRanges","addRange","execCommand","currentRange","getSelectionRange","dialog","prompt","linkUrlText","trim","setSelectionRange","focus","insertImage","imageUrlText","imageUrl","removePlaceholder","remove","selectionIsInContent","openKeyboardToolbar","selectionIsInPopover","closePopover","isCollapsed","rangeCount","getRangeAt","rect","getBoundingClientRect","rootEl","body","openPopover","x","scrollX","offsetLeft","y","scrollY","offsetTop","width","height","e","clearFormattingOnPaste","clipboardData","getData","text","preventDefault","inPopover","activeElement","_selection","_selectionIsInContent","$buttonEl","target","button","attr","buttonData","customButtons","onClick","command","indexOf","tagName","split","$anchorNode","toLowerCase","sel","select","renderButtons","renderButton","iconClass","theme","content","iconContent","forEach","buttonIndex","Array","isArray","b","dividers","createToolbar","prepend","createKeyboardToolbar","createPopover","closeByOutsideClick","backdrop","parent","targetX","targetY","targetWidth","targetHeight","assign","clearTimeout","popoverTimeout","setTimeout","opened","resize","open","close","destroy"],"mappings":"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","sourcesContent":["function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nimport { getWindow, getDocument } from 'ssr-window';\nimport $ from '../../shared/dom7';\nimport { extend, deleteProps } from '../../shared/utils';\nimport Framework7Class from '../../shared/class';\nimport { getDevice } from '../../shared/get-device';\nvar textEditorButtonsMap = {\n  // f7-icon, material-icon, command\n  bold: ['bold', 'format_bold', 'bold'],\n  italic: ['italic', 'format_italic', 'italic'],\n  underline: ['underline', 'format_underlined', 'underline'],\n  strikeThrough: ['strikethrough', 'strikethrough_s', 'strikeThrough'],\n  orderedList: ['list_number', 'format_list_numbered', 'insertOrderedList'],\n  unorderedList: ['list_bullet', 'format_list_bulleted', 'insertUnorderedList'],\n  link: ['link', 'link', 'createLink'],\n  image: ['photo', 'image', 'insertImage'],\n  paragraph: ['paragraph', '<i class=\"icon\">Â¶</i>', 'formatBlock.P'],\n  h1: ['<i class=\"icon\">H<sub>1</sub></i>', '<i class=\"icon\">H<sub>1</sub></i>', 'formatBlock.H1'],\n  h2: ['<i class=\"icon\">H<sub>2</sub></i>', '<i class=\"icon\">H<sub>2</sub></i>', 'formatBlock.H2'],\n  h3: ['<i class=\"icon\">H<sub>3</sub></i>', '<i class=\"icon\">H<sub>3</sub></i>', 'formatBlock.H3'],\n  alignLeft: ['text_alignleft', 'format_align_left', 'justifyLeft'],\n  alignCenter: ['text_aligncenter', 'format_align_center', 'justifyCenter'],\n  alignRight: ['text_alignright', 'format_align_right', 'justifyRight'],\n  alignJustify: ['text_justify', 'format_align_justify', 'justifyFull'],\n  subscript: ['textformat_subscript', '<i class=\"icon\">A<sub>1</sub></i>', 'subscript'],\n  superscript: ['textformat_superscript', '<i class=\"icon\">A<sup>1</sup></i>', 'superscript'],\n  indent: ['increase_indent', 'format_indent_increase', 'indent'],\n  outdent: ['decrease_indent', 'format_indent_decrease', 'outdent']\n};\n\nvar TextEditor = /*#__PURE__*/function (_Framework7Class) {\n  _inheritsLoose(TextEditor, _Framework7Class);\n\n  function TextEditor(app, params) {\n    var _this;\n\n    _this = _Framework7Class.call(this, params, [app]) || this;\n\n    var self = _assertThisInitialized(_this);\n\n    var document = getDocument();\n    var device = getDevice();\n    var defaults = extend({}, app.params.textEditor); // Extend defaults with modules params\n\n    self.useModulesParams(defaults);\n    self.params = extend(defaults, params);\n    var el = self.params.el;\n    if (!el) return self || _assertThisInitialized(_this);\n    var $el = $(el);\n    if ($el.length === 0) return self || _assertThisInitialized(_this);\n    if ($el[0].f7TextEditor) return $el[0].f7TextEditor || _assertThisInitialized(_this);\n    var $contentEl = $el.children('.text-editor-content');\n\n    if (!$contentEl.length) {\n      $el.append('<div class=\"text-editor-content\" contenteditable></div>');\n      $contentEl = $el.children('.text-editor-content');\n    }\n\n    extend(self, {\n      app: app,\n      $el: $el,\n      el: $el[0],\n      $contentEl: $contentEl,\n      contentEl: $contentEl[0]\n    });\n\n    if ('value' in params) {\n      self.value = self.params.value;\n    }\n\n    if (self.params.mode === 'keyboard-toolbar') {\n      if (!(device.cordova || device.capacitor) && !device.android) {\n        self.params.mode = 'popover';\n      }\n    }\n\n    if (typeof self.params.buttons === 'string') {\n      try {\n        self.params.buttons = JSON.parse(self.params.buttons);\n      } catch (err) {\n        throw new Error('Framework7: TextEditor: wrong \"buttons\" parameter format');\n      }\n    }\n\n    $el[0].f7TextEditor = self; // Bind\n\n    self.onButtonClick = self.onButtonClick.bind(self);\n    self.onFocus = self.onFocus.bind(self);\n    self.onBlur = self.onBlur.bind(self);\n    self.onInput = self.onInput.bind(self);\n    self.onPaste = self.onPaste.bind(self);\n    self.onSelectionChange = self.onSelectionChange.bind(self);\n    self.closeKeyboardToolbar = self.closeKeyboardToolbar.bind(self); // Handle Events\n\n    self.attachEvents = function attachEvents() {\n      if (self.params.mode === 'toolbar') {\n        self.$el.find('.text-editor-toolbar').on('click', 'button', self.onButtonClick);\n      }\n\n      if (self.params.mode === 'keyboard-toolbar') {\n        self.$keyboardToolbarEl.on('click', 'button', self.onButtonClick);\n        self.$el.parents('.page').on('page:beforeout', self.closeKeyboardToolbar);\n      }\n\n      if (self.params.mode === 'popover' && self.popover) {\n        self.popover.$el.on('click', 'button', self.onButtonClick);\n      }\n\n      self.$contentEl.on('paste', self.onPaste);\n      self.$contentEl.on('focus', self.onFocus);\n      self.$contentEl.on('blur', self.onBlur);\n      self.$contentEl.on('input', self.onInput, true);\n      $(document).on('selectionchange', self.onSelectionChange);\n    };\n\n    self.detachEvents = function detachEvents() {\n      if (self.params.mode === 'toolbar') {\n        self.$el.find('.text-editor-toolbar').off('click', 'button', self.onButtonClick);\n      }\n\n      if (self.params.mode === 'keyboard-toolbar') {\n        self.$keyboardToolbarEl.off('click', 'button', self.onButtonClick);\n        self.$el.parents('.page').off('page:beforeout', self.closeKeyboardToolbar);\n      }\n\n      if (self.params.mode === 'popover' && self.popover) {\n        self.popover.$el.off('click', 'button', self.onButtonClick);\n      }\n\n      self.$contentEl.off('paste', self.onPaste);\n      self.$contentEl.off('focus', self.onFocus);\n      self.$contentEl.off('blur', self.onBlur);\n      self.$contentEl.off('input', self.onInput, true);\n      $(document).off('selectionchange', self.onSelectionChange);\n    }; // Install Modules\n\n\n    self.useModules(); // Init\n\n    self.init();\n    return self || _assertThisInitialized(_this);\n  }\n\n  var _proto = TextEditor.prototype;\n\n  _proto.setValue = function setValue(newValue) {\n    var self = this;\n    var currentValue = self.value;\n    if (currentValue === newValue) return self;\n    self.value = newValue;\n    self.$contentEl.html(newValue);\n    self.$el.trigger('texteditor:change', self.value);\n    self.emit('local::change textEditorChange', self, self.value);\n    return self;\n  };\n\n  _proto.getValue = function getValue() {\n    var self = this;\n    return self.value;\n  };\n\n  _proto.clearValue = function clearValue() {\n    var self = this;\n    self.setValue('');\n\n    if (self.params.placeholder && !self.$contentEl.html()) {\n      self.insertPlaceholder();\n    }\n\n    return self;\n  };\n\n  _proto.createLink = function createLink() {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n    var currentSelection = window.getSelection();\n    var selectedNodes = [];\n    var $selectedLinks;\n\n    if (currentSelection && currentSelection.anchorNode && $(currentSelection.anchorNode).parents(self.$el).length) {\n      var anchorNode = currentSelection.anchorNode;\n\n      while (anchorNode) {\n        selectedNodes.push(anchorNode);\n\n        if (!anchorNode.nextSibling || anchorNode === currentSelection.focusNode) {\n          anchorNode = null;\n        }\n\n        if (anchorNode) {\n          anchorNode = anchorNode.nextSibling;\n        }\n      }\n\n      var selectedNodesLinks = [];\n      var $selectedNodes = $(selectedNodes);\n\n      for (var i = 0; i < $selectedNodes.length; i += 1) {\n        var childNodes = $selectedNodes[i].children;\n\n        if (childNodes) {\n          for (var j = 0; j < childNodes.length; j += 1) {\n            if ($(childNodes[j]).is('a')) {\n              selectedNodesLinks.push(childNodes[j]);\n            }\n          }\n        }\n      }\n\n      $selectedLinks = $selectedNodes.closest('a').add($(selectedNodesLinks));\n    }\n\n    if ($selectedLinks && $selectedLinks.length) {\n      $selectedLinks.each(function (linkNode) {\n        var selection = window.getSelection();\n        var range = document.createRange();\n        range.selectNodeContents(linkNode);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        document.execCommand('unlink', false);\n        selection.removeAllRanges();\n      });\n      return self;\n    }\n\n    var currentRange = self.getSelectionRange();\n    if (!currentRange) return self;\n    var dialog = self.app.dialog.prompt(self.params.linkUrlText, '', function (link) {\n      if (link && link.trim().length) {\n        self.setSelectionRange(currentRange);\n        document.execCommand('createLink', false, link.trim());\n      }\n    });\n    dialog.$el.find('input').focus();\n    return self;\n  };\n\n  _proto.insertImage = function insertImage() {\n    var self = this;\n    var document = getDocument();\n    var currentRange = self.getSelectionRange();\n    if (!currentRange) return self;\n    var dialog = self.app.dialog.prompt(self.params.imageUrlText, '', function (imageUrl) {\n      if (imageUrl && imageUrl.trim().length) {\n        self.setSelectionRange(currentRange);\n        document.execCommand('insertImage', false, imageUrl.trim());\n      }\n    });\n    dialog.$el.find('input').focus();\n    return self;\n  };\n\n  _proto.removePlaceholder = function removePlaceholder() {\n    var self = this;\n    self.$contentEl.find('.text-editor-placeholder').remove();\n  };\n\n  _proto.insertPlaceholder = function insertPlaceholder() {\n    var self = this;\n    self.$contentEl.append(\"<div class=\\\"text-editor-placeholder\\\">\" + self.params.placeholder + \"</div>\");\n  };\n\n  _proto.onSelectionChange = function onSelectionChange() {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n    if (self.params.mode === 'toolbar') return;\n    var selection = window.getSelection();\n    var selectionIsInContent = $(selection.anchorNode).parents(self.contentEl).length || selection.anchorNode === self.contentEl;\n\n    if (self.params.mode === 'keyboard-toolbar') {\n      if (!selectionIsInContent) {\n        self.closeKeyboardToolbar();\n      } else {\n        self.openKeyboardToolbar();\n      }\n\n      return;\n    }\n\n    if (self.params.mode === 'popover') {\n      var selectionIsInPopover = $(selection.anchorNode).parents(self.popover.el).length || selection.anchorNode === self.popover.el;\n\n      if (!selectionIsInContent && !selectionIsInPopover) {\n        self.closePopover();\n        return;\n      }\n\n      if (!selection.isCollapsed && selection.rangeCount) {\n        var range = selection.getRangeAt(0);\n        var rect = range.getBoundingClientRect();\n        var rootEl = self.app.$el[0] || document.body;\n        self.openPopover(rect.x + (window.scrollX || 0) - rootEl.offsetLeft, rect.y + (window.scrollY || 0) - rootEl.offsetTop, rect.width, rect.height);\n      } else if (selection.isCollapsed) {\n        self.closePopover();\n      }\n    }\n  };\n\n  _proto.onPaste = function onPaste(e) {\n    var self = this;\n    var document = getDocument();\n\n    if (self.params.clearFormattingOnPaste && e.clipboardData && e.clipboardData.getData) {\n      var text = e.clipboardData.getData('text/plain');\n      e.preventDefault();\n      document.execCommand('insertText', false, text);\n    }\n  };\n\n  _proto.onInput = function onInput() {\n    var self = this;\n    var value = self.$contentEl.html();\n    self.value = value;\n    self.$el.trigger('texteditor:input');\n    self.emit('local:input textEditorInput', self, self.value);\n    self.$el.trigger('texteditor:change', self.value);\n    self.emit('local::change textEditorChange', self, self.value);\n  };\n\n  _proto.onFocus = function onFocus() {\n    var self = this;\n    self.removePlaceholder();\n    self.$contentEl.focus();\n    self.$el.trigger('texteditor:focus');\n    self.emit('local::focus textEditorFocus', self);\n  };\n\n  _proto.onBlur = function onBlur() {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n\n    if (self.params.placeholder && self.$contentEl.html() === '') {\n      self.insertPlaceholder();\n    }\n\n    if (self.params.mode === 'popover') {\n      var selection = window.getSelection();\n      var selectionIsInContent = $(selection.anchorNode).parents(self.contentEl).length || selection.anchorNode === self.contentEl;\n      var inPopover = document.activeElement && self.popover && $(document.activeElement).closest(self.popover.$el).length;\n\n      if (!inPopover && !selectionIsInContent) {\n        self.closePopover();\n      }\n    }\n\n    if (self.params.mode === 'keyboard-toolbar') {\n      var _selection = window.getSelection();\n\n      var _selectionIsInContent = $(_selection.anchorNode).parents(self.contentEl).length || _selection.anchorNode === self.contentEl;\n\n      if (!_selectionIsInContent) {\n        self.closeKeyboardToolbar();\n      }\n    }\n\n    self.$el.trigger('texteditor:blur');\n    self.emit('local::blur textEditorBlur', self);\n  };\n\n  _proto.onButtonClick = function onButtonClick(e) {\n    var self = this;\n    var window = getWindow();\n    var document = getDocument();\n    var selection = window.getSelection();\n    var selectionIsInContent = $(selection.anchorNode).parents(self.contentEl).length || selection.anchorNode === self.contentEl;\n    if (!selectionIsInContent) return;\n    var $buttonEl = $(e.target).closest('button');\n\n    if ($buttonEl.parents('form').length) {\n      e.preventDefault();\n    }\n\n    var button = $buttonEl.attr('data-button');\n    var buttonData = self.params.customButtons && self.params.customButtons[button];\n    if (!button || !(textEditorButtonsMap[button] || buttonData)) return;\n    $buttonEl.trigger('texteditor:buttonclick', button);\n    self.emit('local::buttonClick textEditorButtonClick', self, button);\n\n    if (buttonData) {\n      if (buttonData.onClick) buttonData.onClick(self, $buttonEl[0]);\n      return;\n    }\n\n    var command = textEditorButtonsMap[button][2];\n\n    if (command === 'createLink') {\n      self.createLink();\n      return;\n    }\n\n    if (command === 'insertImage') {\n      self.insertImage();\n      return;\n    }\n\n    if (command.indexOf('formatBlock') === 0) {\n      var tagName = command.split('.')[1];\n      var $anchorNode = $(selection.anchorNode);\n\n      if ($anchorNode.parents(tagName.toLowerCase()).length || $anchorNode.is(tagName)) {\n        document.execCommand('formatBlock', false, 'div');\n      } else {\n        document.execCommand('formatBlock', false, tagName);\n      }\n\n      return;\n    }\n\n    document.execCommand(command, false);\n  } // eslint-disable-next-line\n  ;\n\n  _proto.getSelectionRange = function getSelectionRange() {\n    var window = getWindow();\n    var document = getDocument();\n\n    if (window.getSelection) {\n      var sel = window.getSelection();\n\n      if (sel.getRangeAt && sel.rangeCount) {\n        return sel.getRangeAt(0);\n      }\n    } else if (document.selection && document.selection.createRange) {\n      return document.selection.createRange();\n    }\n\n    return null;\n  } // eslint-disable-next-line\n  ;\n\n  _proto.setSelectionRange = function setSelectionRange(range) {\n    var window = getWindow();\n    var document = getDocument();\n\n    if (range) {\n      if (window.getSelection) {\n        var sel = window.getSelection();\n        sel.removeAllRanges();\n        sel.addRange(range);\n      } else if (document.selection && range.select) {\n        range.select();\n      }\n    }\n  };\n\n  _proto.renderButtons = function renderButtons() {\n    var self = this;\n    var html = '';\n\n    function renderButton(button) {\n      var iconClass = self.app.theme === 'md' ? 'material-icons' : 'f7-icons';\n\n      if (self.params.customButtons && self.params.customButtons[button]) {\n        var buttonData = self.params.customButtons[button];\n        return \"<button type=\\\"button\\\" class=\\\"text-editor-button\\\" data-button=\\\"\" + button + \"\\\">\" + (buttonData.content || '') + \"</button>\";\n      }\n\n      if (!textEditorButtonsMap[button]) return '';\n      var iconContent = textEditorButtonsMap[button][self.app.theme === 'md' ? 1 : 0];\n      return (\"<button type=\\\"button\\\" class=\\\"text-editor-button\\\" data-button=\\\"\" + button + \"\\\">\" + (iconContent.indexOf('<') >= 0 ? iconContent : \"<i class=\\\"\" + iconClass + \"\\\">\" + iconContent + \"</i>\") + \"</button>\").trim();\n    }\n\n    self.params.buttons.forEach(function (button, buttonIndex) {\n      if (Array.isArray(button)) {\n        button.forEach(function (b) {\n          html += renderButton(b);\n        });\n\n        if (buttonIndex < self.params.buttons.length - 1 && self.params.dividers) {\n          html += '<div class=\"text-editor-button-divider\"></div>';\n        }\n      } else {\n        html += renderButton(button);\n      }\n    });\n    return html;\n  };\n\n  _proto.createToolbar = function createToolbar() {\n    var self = this;\n    self.$el.prepend(\"<div class=\\\"text-editor-toolbar\\\">\" + self.renderButtons() + \"</div>\");\n  };\n\n  _proto.createKeyboardToolbar = function createKeyboardToolbar() {\n    var self = this;\n    self.$keyboardToolbarEl = $(\"<div class=\\\"toolbar toolbar-bottom text-editor-keyboard-toolbar\\\"><div class=\\\"toolbar-inner\\\">\" + self.renderButtons() + \"</div></div>\");\n  };\n\n  _proto.createPopover = function createPopover() {\n    var self = this;\n    self.popover = self.app.popover.create({\n      content: \"\\n        <div class=\\\"popover theme-dark text-editor-popover\\\">\\n          <div class=\\\"popover-inner\\\">\" + self.renderButtons() + \"</div>\\n        </div>\\n      \",\n      closeByOutsideClick: false,\n      backdrop: false\n    });\n  };\n\n  _proto.openKeyboardToolbar = function openKeyboardToolbar() {\n    var self = this;\n    if (self.$keyboardToolbarEl.parent(self.app.$el).length) return;\n    self.$el.trigger('texteditor:keyboardopen');\n    self.emit('local::keyboardOpen textEditorKeyboardOpen', self);\n    self.app.$el.append(self.$keyboardToolbarEl);\n  };\n\n  _proto.closeKeyboardToolbar = function closeKeyboardToolbar() {\n    var self = this;\n    self.$keyboardToolbarEl.remove();\n    self.$el.trigger('texteditor:keyboardclose');\n    self.emit('local::keyboardClose textEditorKeyboardClose', self);\n  };\n\n  _proto.openPopover = function openPopover(targetX, targetY, targetWidth, targetHeight) {\n    var self = this;\n    if (!self.popover) return;\n    Object.assign(self.popover.params, {\n      targetX: targetX,\n      targetY: targetY,\n      targetWidth: targetWidth,\n      targetHeight: targetHeight\n    });\n    clearTimeout(self.popoverTimeout);\n    self.popoverTimeout = setTimeout(function () {\n      if (!self.popover) return;\n\n      if (self.popover.opened) {\n        self.popover.resize();\n      } else {\n        self.$el.trigger('texteditor:popoveropen');\n        self.emit('local::popoverOpen textEditorPopoverOpen', self);\n        self.popover.open();\n      }\n    }, 400);\n  };\n\n  _proto.closePopover = function closePopover() {\n    var self = this;\n    clearTimeout(self.popoverTimeout);\n    if (!self.popover || !self.popover.opened) return;\n    self.popoverTimeout = setTimeout(function () {\n      if (!self.popover) return;\n      self.$el.trigger('texteditor:popoverclose');\n      self.emit('local::popoverClose textEditorPopoverClose', self);\n      self.popover.close();\n    }, 400);\n  };\n\n  _proto.init = function init() {\n    var self = this;\n\n    if (self.value) {\n      self.$contentEl.html(self.value);\n    } else {\n      self.value = self.$contentEl.html();\n    }\n\n    if (self.params.placeholder && self.value === '') {\n      self.insertPlaceholder();\n    }\n\n    if (self.params.mode === 'toolbar') {\n      self.createToolbar();\n    } else if (self.params.mode === 'popover') {\n      self.createPopover();\n    } else if (self.params.mode === 'keyboard-toolbar') {\n      self.createKeyboardToolbar();\n    }\n\n    self.attachEvents();\n    self.$el.trigger('texteditor:init');\n    self.emit('local::init textEditorInit', self);\n    return self;\n  };\n\n  _proto.destroy = function destroy() {\n    var self = this;\n    self.$el.trigger('texteditor:beforedestroy');\n    self.emit('local::beforeDestroy textEditorBeforeDestroy', self);\n    self.detachEvents();\n\n    if (self.params.mode === 'keyboard-toolbar' && self.$keyboardToolbarEl) {\n      self.$keyboardToolbarEl.remove();\n    }\n\n    if (self.popover) {\n      self.popover.close(false);\n      self.popover.destroy();\n    }\n\n    delete self.$el[0].f7TextEditor;\n    deleteProps(self);\n    self = null;\n  };\n\n  return TextEditor;\n}(Framework7Class);\n\nexport default TextEditor;"]},"metadata":{},"sourceType":"module"}